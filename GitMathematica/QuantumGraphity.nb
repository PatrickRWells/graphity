(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    377240,       8476]
NotebookOptionsPosition[    366365,       8334]
NotebookOutlinePosition[    366723,       8350]
CellTagsIndexPosition[    366680,       8347]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Searching for minimal energy graphs", "Section",
 CellChangeTimes->{{3.682435386438525*^9, 3.682435401121613*^9}},
 FontSize->36,ExpressionUUID->"159c10df-fc85-46f8-83bc-1bfca6b22089"],

Cell[CellGroupData[{

Cell["Functions", "Subsection",
 CellChangeTimes->{{3.68252497387551*^9, 3.682524980331407*^9}, {
  3.682525022371294*^9, 
  3.6825250242492447`*^9}},ExpressionUUID->"e5dde970-3b8a-43e7-a5e3-\
ebbce7dc28c9"],

Cell[CellGroupData[{

Cell["Making graphs", "Subsubsection",
 CellChangeTimes->{{3.685285151490796*^9, 
  3.685285158197275*^9}},ExpressionUUID->"01c5076b-40f1-4693-be79-\
b41bfc2631c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Sqmat", "[", "mat_", "]"}], ":=", 
   RowBox[{"mat", ".", "mat"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.685491671982793*^9, 
  3.685491675181698*^9}},ExpressionUUID->"05028e29-817b-4e97-8b4b-\
e44bea895668"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeKn", "[", "n_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"A", ",", " ", "i", ",", " ", "j"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"A", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"1", ",", "n"}], "]"}], ",", "n"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "n"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", "0"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "A"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.68243544360299*^9, 3.682435446793396*^9}, {
  3.682435559821796*^9, 3.6824355824208403`*^9}, {3.682435684130189*^9, 
  3.682435715457053*^9}, {3.682435798391444*^9, 3.682435876014435*^9}, {
  3.685392135089774*^9, 3.685392137384199*^9}, {3.728941004258491*^9, 
  3.7289410049770327`*^9}},ExpressionUUID->"2ec8307b-080a-4096-8dc7-\
d0412061072e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IsKn", "[", "Amat_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"result", ",", "tvec", ",", "V", ",", "degs"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"V", "=", 
      RowBox[{"Length", "[", "Amat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"degs", " ", "=", " ", 
      RowBox[{"Valencyvec", "[", "Amat", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"tvec", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"degs", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
           RowBox[{"V", "-", "1"}]}], ",", "1", ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "V"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", "True"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Total", "[", "tvec", "]"}], "\[NotEqual]", "V"}], ",", 
       RowBox[{"result", "=", "False"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "result"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6853141240680513`*^9, 3.68531416377094*^9}, {
   3.685314207510694*^9, 3.685314240009994*^9}, {3.6853142799982557`*^9, 
   3.6853142887580967`*^9}, {3.6853143205152073`*^9, 3.685314330586392*^9}, {
   3.685314368403949*^9, 3.6853145567610083`*^9}, {3.685392010628385*^9, 
   3.685392011904025*^9}, {3.685465119757702*^9, 3.685465131586863*^9}, {
   3.685465344449657*^9, 3.685465355368181*^9}, {3.685465622393272*^9, 
   3.685465630136338*^9}, {3.728941036111331*^9, 3.728941036469707*^9}, 
   3.728942788224844*^9},ExpressionUUID->"81406234-7eba-4c14-a8e9-\
20af7ba49549"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PermMats", "[", "n_", "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{"#", "//", 
      RowBox[{"Normal", " ", "&"}]}], ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i_", ",", "i_"}], "}"}], "->", " ", "1"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", 
       RowBox[{"Permutations", "[", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{"#", "&"}], ",", "n"}], "]"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.68280603107647*^9, {3.7289410642988997`*^9, 
   3.728941064553267*^9}},ExpressionUUID->"0889bbe7-dcff-48d9-a2fd-\
7956980bccaf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Removeij", "[", 
    RowBox[{"i_", ",", "j_", ",", "mat_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "tempmat", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tempmat", "=", "mat"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tempmat", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "0"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tempmat", "[", 
        RowBox[{"[", 
         RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", "0"}], ";", 
      "\[IndentingNewLine]", "tempmat"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6824368113767767`*^9, 3.6824369596835337`*^9}, 
   3.682806035858667*^9, 
   3.728941113360261*^9},ExpressionUUID->"5d08dbc8-50a8-4cef-8539-\
c1a9b954d143"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExpandGraph", "[", 
    RowBox[{"g_", ",", "row_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"newg", ",", "i", ",", "n", ",", "lastrow", ",", "temprow"}], 
      "}"}], ",", 
     RowBox[{"(*", 
      RowBox[{
      "Expands", " ", "a", " ", "graph", " ", "by", " ", "one", " ", "vertex",
        " ", "where", " ", "its", " ", "connections", " ", "to", " ", "the", 
       " ", "existing", " ", "vertices", " ", "are", " ", "given", " ", "by", 
       " ", "the", " ", "row", " ", "vector"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newg", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "g", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "\[NotEqual]", 
         RowBox[{"Length", "[", "row", "]"}]}], ",", 
        RowBox[{
        "Print", "[", 
         "\"\<Error in ExpandGraph[g,row]: new row must be of equal length as \
graph\>\"", "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"lastrow", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"row", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"newg", ",", "lastrow"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "n"}], ",", 
        RowBox[{"i", "\[GreaterEqual]", "1"}], ",", 
        RowBox[{"i", "--"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"temprow", "=", 
          RowBox[{"g", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"temprow", ",", 
           RowBox[{"row", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"PrependTo", "[", 
          RowBox[{"newg", ",", "temprow"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "newg"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.673798038500613*^9, 3.6737980415301943`*^9}, {
   3.673798128332032*^9, 3.673798164538946*^9}, {3.673799329433423*^9, 
   3.673799333647537*^9}, {3.673799367647327*^9, 3.67379937208746*^9}, {
   3.67379940327386*^9, 3.673799407280485*^9}, {3.673799508663248*^9, 
   3.6737995254524193`*^9}, {3.673799584218231*^9, 3.673799656263515*^9}, {
   3.673799696249216*^9, 3.673799706070409*^9}, 3.682806038916484*^9, {
   3.696098430119547*^9, 3.696098761468141*^9}, 3.696098848123295*^9, {
   3.6960989038860064`*^9, 3.696098918421834*^9}, {3.696099381525607*^9, 
   3.696099419353161*^9}, {3.696099497934615*^9, 3.696099499444974*^9}, {
   3.696608399776732*^9, 3.696608463714161*^9}, {3.696609860081732*^9, 
   3.696609860561496*^9}, {3.728941145815462*^9, 
   3.728941147422411*^9}},ExpressionUUID->"53c03b6e-a56f-457b-984a-\
83f27e05b991"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ExpandGraph", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.696608468400485*^9, 3.696608499276963*^9}, {
   3.696644092764078*^9, 3.696644096266176*^9}, 
   3.7289411504372396`*^9},ExpressionUUID->"f63240b3-1cc0-4366-b67c-\
3e8a63a77830"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RowVectors", "[", 
   RowBox[{"n_", ",", "numOnes_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"list", ",", "i", ",", "row"}], "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "creates", " ", "a", " ", "list", " ", "of", " ", "all", " ", "row", 
       " ", "vector", " ", "of", " ", "ones", " ", "and", " ", "zeros", " ", 
       "of", " ", "size", " ", "n"}], ",", " ", 
      RowBox[{
      "with", " ", "numOnes", " ", "of", " ", "the", " ", "entries", " ", 
       "set", " ", "to", " ", "1"}], ",", " ", 
      RowBox[{"the", " ", "rest", " ", "to", " ", "0."}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "0"}], ",", 
       RowBox[{"i", "<", 
        RowBox[{"2", "^", "n"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"row", "=", 
         RowBox[{"IntegerDigits", "[", 
          RowBox[{"i", ",", "2", ",", "n"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", "row", "]"}], "\[Equal]", "numOnes"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"list", ",", "row"}], "]"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "list"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.696097312382412*^9, 3.696097455216498*^9}, {
   3.6960974982957087`*^9, 3.6960976487304697`*^9}, 
   3.7289411965611753`*^9},ExpressionUUID->"880ad033-edd3-460c-bcb5-\
2ebe45be0345"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RowVectors", "[", "n_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"list", ",", "i", ",", "row"}], "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{
     "creates", " ", "a", " ", "list", " ", "of", " ", "all", " ", "row", " ",
       "vector", " ", "of", " ", "ones", " ", "and", " ", "zeros", " ", "of", 
      " ", "size", " ", "n"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "0"}], ",", 
       RowBox[{"i", "<", 
        RowBox[{"2", "^", "n"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"row", "=", 
         RowBox[{"IntegerDigits", "[", 
          RowBox[{"i", ",", "2", ",", "n"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"list", ",", "row"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "list"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.696099700374001*^9, 3.696099746466961*^9}, 
   3.728941197470297*^9},ExpressionUUID->"ba44c2b5-a698-40b2-9785-\
3b4b32470178"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"RowVectors", "[", 
   RowBox[{"2", ",", "1"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6966089104710293`*^9, 3.696608944246369*^9}, {
   3.6966440687553587`*^9, 3.696644072827079*^9}, 
   3.728941198596653*^9},ExpressionUUID->"33515d46-10d3-42e5-a5a3-\
df4df12e799e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpandGraph", "[", 
   RowBox[{"Amat_", ",", " ", "enum_Integer"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"graphs", ",", "size", ",", "rows", ",", "i", ",", "oneg"}], 
     "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "Takes", " ", "a", " ", "graph", " ", "with", " ", "adjacencymatrix", 
       " ", "amat"}], ",", " ", 
      RowBox[{
      "increments", " ", "the", " ", "vertex", " ", "number", " ", "by", " ", 
       "1"}], ",", " ", 
      RowBox[{
      "and", " ", "outputs", " ", "all", " ", "the", " ", "graphs", " ", 
       "where", " ", "the", " ", "new", " ", "vertex", " ", "has", " ", 
       "degree", " ", "enum"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"graphs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"size", "=", 
      RowBox[{"Length", "[", "Amat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rows", "=", 
      RowBox[{"RowVectors", "[", 
       RowBox[{"size", ",", "enum"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "rows", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"oneg", "=", 
         RowBox[{"ExpandGraph", "[", 
          RowBox[{"Amat", ",", 
           RowBox[{"rows", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"graphs", ",", "oneg"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "graphs"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.696096724820551*^9, 3.6960968990442867`*^9}, {
   3.696097684543524*^9, 3.696097794000277*^9}, {3.696097861732395*^9, 
   3.696098021776876*^9}, {3.696098098458552*^9, 3.6960980995461607`*^9}, {
   3.696098144448516*^9, 3.696098157234765*^9}, {3.696099089209046*^9, 
   3.696099099390464*^9}, {3.696099203087933*^9, 3.6960992139185143`*^9}, {
   3.696099254958734*^9, 3.6960993198471107`*^9}, {3.696099461273315*^9, 
   3.696099470855942*^9}, {3.696608642052785*^9, 3.696608655850258*^9}, {
   3.696608964464498*^9, 3.696608994903533*^9}, {3.696609078947546*^9, 
   3.696609088185902*^9}, {3.696609360045106*^9, 3.696609376410385*^9}, {
   3.6966098449471617`*^9, 3.696609845801798*^9}, {3.696609881353207*^9, 
   3.696609889464703*^9}, {3.7289411514808397`*^9, 3.728941152842805*^9}, 
   3.728941199386075*^9},ExpressionUUID->"135ec32e-71ff-4435-bcf6-\
d448c16665af"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"ExpandGraph", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", "2"}], "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.696608790810635*^9, 3.696608799137951*^9}, {
   3.6966098979931726`*^9, 3.6966098985590763`*^9}, {3.696644054291698*^9, 
   3.696644057571307*^9}, 
   3.728941153978771*^9},ExpressionUUID->"c1e99c53-e5c3-4711-a85d-\
e5bcfb6555ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpandGraph", "[", "Amat_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"graphs", ",", "size", ",", "rows", ",", "i", ",", "oneg"}], 
     "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Takes", " ", "adjacencymatrix", " ", "amat"}], ",", " ", 
      RowBox[{
      "increments", " ", "the", " ", "vertex", " ", "number", " ", "by", " ", 
       "1"}], ",", " ", 
      RowBox[{
      "and", " ", "outputs", " ", "all", " ", "the", " ", "graphs", " ", 
       "where", " ", "the", " ", "new", " ", "vertex", " ", "has", " ", "all",
        " ", "possible", " ", "degrees"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"graphs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"size", "=", 
      RowBox[{"Length", "[", "Amat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rows", " ", "=", " ", 
      RowBox[{"RowVectors", "[", "size", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "rows", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"oneg", "=", 
         RowBox[{"ExpandGraph", "[", 
          RowBox[{"Amat", ",", 
           RowBox[{"rows", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"graphs", ",", "oneg"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "graphs"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.696099594934832*^9, 3.6960996166609373`*^9}, {
   3.6960996588530607`*^9, 3.6960996640113688`*^9}, {3.696099859539555*^9, 
   3.696099862026829*^9}, {3.696608671187809*^9, 3.69660867267373*^9}, {
   3.728941156042859*^9, 3.728941157869876*^9}, 
   3.728941200092257*^9},ExpressionUUID->"17beb5c4-fa57-4a4f-b8f6-\
4413bd1cc12b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ExpandGraph", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6960998816718397`*^9, 3.696099911542201*^9}, {
   3.69610029090387*^9, 3.6961002946617813`*^9}, {3.696608687605494*^9, 
   3.6966086888769617`*^9}, {3.696609939914029*^9, 3.696609963737735*^9}, 
   3.696610007968498*^9, {3.6966440449961977`*^9, 3.696644048595805*^9}, 
   3.728941158957361*^9},ExpressionUUID->"cdc55d18-df1d-497b-9e4a-\
2debd215eb6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpandEnsemble", "[", 
   RowBox[{"ensemble_", ",", "enum_Integer"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"graphs", ",", "ensembleSize", ",", "i", ",", "expansion"}], 
     "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Given", " ", "a", " ", "list", " ", "of", " ", "graphs", " ", 
       RowBox[{"(", "ensemble", ")"}]}], ",", " ", 
      RowBox[{
      "expand", " ", "each", " ", "graph", " ", "by", " ", "a", " ", "vertex",
        " ", "with", " ", "enum", " ", "degrees"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"graphs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ensembleSize", "=", 
      RowBox[{"Length", "[", "ensemble", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", "ensembleSize"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"expansion", "=", 
         RowBox[{"ExpandGraph", "[", 
          RowBox[{
           RowBox[{"ensemble", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "enum"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"graphs", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"graphs", ",", "expansion"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "graphs"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.696096254681205*^9, 3.696096271648142*^9}, {
   3.696096687356769*^9, 3.696096687524078*^9}, {3.696099525028264*^9, 
   3.696099535194816*^9}, {3.6960999587962723`*^9, 3.6961000245024242`*^9}, {
   3.6961000680792513`*^9, 3.696100106023847*^9}, {3.6961002093108673`*^9, 
   3.696100280353342*^9}, {3.696609976696744*^9, 3.696609984031948*^9}, 
   3.728941161557098*^9, 
   3.728941237506422*^9},ExpressionUUID->"595a32ae-69a0-404d-89e9-\
c7046980cbcd"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ExpandEnsemble", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", "2"}], "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.6966100157045803`*^9, 3.696610069332768*^9}, {
   3.6966101037483273`*^9, 3.696610110532096*^9}, {3.696610175002954*^9, 
   3.696610196697895*^9}, {3.696644035437539*^9, 3.696644038964204*^9}, 
   3.728941238348208*^9},ExpressionUUID->"0424bcc1-695f-45b3-a1a6-\
480556b0f4f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpandEnsemble", "[", "ensemble_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"graphs", ",", "ensembleSize", ",", "i", ",", "expansion"}], 
     "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Given", " ", "a", " ", "list", " ", "of", " ", "graphs", " ", 
       RowBox[{"(", "ensemble", ")"}]}], ",", " ", 
      RowBox[{
      "expand", " ", "each", " ", "graph", " ", "by", " ", "a", " ", "vertex",
        " ", "with", " ", "enum", " ", "ranging", " ", "over", " ", "all", 
       " ", "allowed", " ", "degrees"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"graphs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ensembleSize", "=", 
      RowBox[{"Length", "[", "ensemble", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", "ensembleSize"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"expansion", "=", 
         RowBox[{"ExpandGraph", "[", 
          RowBox[{"ensemble", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"graphs", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"graphs", ",", "expansion"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "graphs"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.696610208810964*^9, 3.696610223832446*^9}, {
   3.696610256376855*^9, 3.696610256656142*^9}, 3.728941162442382*^9, 
   3.728941239110766*^9},ExpressionUUID->"03749a6e-d8c5-4e5c-9367-\
979940729bd3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SelectUnique2", "[", "ensemble_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "reviseIndices", ",", "NonIsoGindices", ",", "size", ",", "i", ",", 
      "bigi"}], "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"given", " ", "a", " ", "list", " ", "of", " ", "graphs"}], ",",
       " ", 
      RowBox[{
       RowBox[{
       "returns", " ", "another", " ", "list", " ", "with", " ", "only", " ", 
        "non"}], "-", 
       RowBox[{
       "isomorphic", " ", "graphs", " ", "of", " ", "the", " ", "original", 
        " ", "list"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"size", "=", 
      RowBox[{"Length", "[", "ensemble", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"NonIsoGindices", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reviseIndices", "[", 
       RowBox[{"indices_", ",", " ", "leave_Integer"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newindices", ",", 
          RowBox[{"dropcount", "=", "0"}], ",", "leftindices"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newindices", "=", 
          RowBox[{"indices", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", 
             RowBox[{
              RowBox[{"Length", "[", "indices", "]"}], "-", "leave"}]}], 
            "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"leftindices", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"leave", ">", "0"}], ",", 
           RowBox[{"leftindices", "=", 
            RowBox[{"indices", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "leave"}], ";;", 
               RowBox[{"Length", "[", "indices", "]"}]}], "]"}], "]"}]}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"IsomorphicGraphQ", "[", 
              RowBox[{
               RowBox[{"AdjacencyGraph", "[", 
                RowBox[{"ensemble", "[", 
                 RowBox[{"[", 
                  RowBox[{"newindices", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "-", "dropcount"}], "]"}], "]"}], "]"}], 
                 "]"}], "]"}], ",", 
               RowBox[{"AdjacencyGraph", "[", 
                RowBox[{"ensemble", "[", 
                 RowBox[{"[", 
                  RowBox[{"newindices", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1", "-", "dropcount"}], "]"}], "]"}], 
                  "]"}], "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"newindices", "=", 
               RowBox[{"Drop", "[", 
                RowBox[{"newindices", ",", 
                 RowBox[{"{", 
                  RowBox[{"i", "+", "1", "-", "dropcount"}], "}"}]}], "]"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"dropcount", "++"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"newindices", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"i", "-", "dropcount"}], ",", 
                  RowBox[{"i", "+", "1", "-", "dropcount"}]}], "}"}], "]"}], 
               "]"}], "=", 
              RowBox[{"newindices", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"i", "+", "1", "-", "dropcount"}], ",", 
                  RowBox[{"i", "-", "dropcount"}]}], "}"}], "]"}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{
              RowBox[{"Length", "[", "indices", "]"}], "-", "leave", "-", 
              "1"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{"newindices", ",", "leftindices"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"bigi", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"bigi", "<", 
        RowBox[{"Length", "[", "NonIsoGindices", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"bigi", ",", "1000"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Selecting unique at \>\"", ",", "bigi"}], "]"}]}], 
          "]"}], ";"}], "*)"}], 
       RowBox[{
        RowBox[{"NonIsoGindices", "=", 
         RowBox[{"reviseIndices", "[", 
          RowBox[{"NonIsoGindices", ",", "bigi"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bigi", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ensemble", "[", 
      RowBox[{"[", "NonIsoGindices", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.696100714065362*^9, 3.696100957019045*^9}, {
   3.696101994878159*^9, 3.6961020041496363`*^9}, {3.696114590332798*^9, 
   3.696114595635147*^9}, {3.696610376721068*^9, 3.696610468830058*^9}, {
   3.696610500462378*^9, 3.6966105281591053`*^9}, {3.696610573719062*^9, 
   3.696610580309951*^9}, {3.6966107538142023`*^9, 3.6966107561558104`*^9}, {
   3.696610977856432*^9, 3.696611170972158*^9}, {3.696611204458891*^9, 
   3.696611268883739*^9}, {3.6966114166463842`*^9, 3.696611420342166*^9}, {
   3.6966114632918663`*^9, 3.6966115018136044`*^9}, {3.696611555551654*^9, 
   3.696611624372958*^9}, {3.696611675845323*^9, 3.696611683372918*^9}, {
   3.696612281298538*^9, 3.696612524489078*^9}, {3.696612556593515*^9, 
   3.696612575966868*^9}, {3.696612708737067*^9, 3.69661271206369*^9}, {
   3.6966127515239983`*^9, 3.696612752787032*^9}, {3.696612805108047*^9, 
   3.69661286168861*^9}, {3.696612953383506*^9, 3.6966130043380613`*^9}, {
   3.696613301764387*^9, 3.696613472307369*^9}, {3.69661380982992*^9, 
   3.6966138636703253`*^9}, {3.696614091933132*^9, 3.696614096979439*^9}, {
   3.6966141746954937`*^9, 3.696614193904337*^9}, {3.696614231582417*^9, 
   3.696614258827858*^9}, {3.696614334472159*^9, 3.696614390263988*^9}, {
   3.696614437762163*^9, 3.696614585941099*^9}, {3.6966146538591433`*^9, 
   3.696614684073966*^9}, {3.696614719446788*^9, 3.696614725013521*^9}, {
   3.696614758923853*^9, 3.69661477461067*^9}, {3.696614912157118*^9, 
   3.696614914596643*^9}, {3.6966149679218473`*^9, 3.6966149737764263`*^9}, {
   3.6966150980493*^9, 3.6966151022554283`*^9}, {3.696615272306061*^9, 
   3.6966152866804047`*^9}, {3.696615331861186*^9, 3.696615336651987*^9}, {
   3.69661540838272*^9, 3.6966154372611723`*^9}, {3.696620939912944*^9, 
   3.696620940542811*^9}, {3.6966214430137987`*^9, 3.696621443619083*^9}, {
   3.696621477210163*^9, 3.696621511412691*^9}, {3.6966215483767443`*^9, 
   3.69662155817581*^9}, {3.696621630711931*^9, 3.696621631230331*^9}, {
   3.6966217354635887`*^9, 3.6966217367966423`*^9}, {3.69662177075176*^9, 
   3.696621771840115*^9}, {3.696622118270196*^9, 3.696622166460249*^9}, {
   3.696622605845043*^9, 3.696622606114047*^9}, {3.696622636915783*^9, 
   3.696622637626347*^9}, {3.696622710633963*^9, 3.696622711217596*^9}, {
   3.696623151422224*^9, 3.6966231927731237`*^9}, 3.6966232404094152`*^9, 
   3.696623270884709*^9, {3.6966233038850822`*^9, 3.696623309707708*^9}, {
   3.696623390355673*^9, 3.696623438005499*^9}, 3.696623693756248*^9, {
   3.696625416166287*^9, 3.696625433747093*^9}, {3.696625900332038*^9, 
   3.6966259368422813`*^9}, {3.696625967151807*^9, 3.696626114784718*^9}, {
   3.696626257074695*^9, 3.696626270577484*^9}, {3.696626304413566*^9, 
   3.6966263490050297`*^9}, {3.696626433004654*^9, 3.6966265365211*^9}, {
   3.6966267952561398`*^9, 3.6966268170224733`*^9}, {3.69662688835682*^9, 
   3.6966268924194927`*^9}, {3.696627000057822*^9, 3.696627038163973*^9}, {
   3.696627105557323*^9, 3.696627106802775*^9}, {3.6966272299204493`*^9, 
   3.6966272647755423`*^9}, {3.69662745808716*^9, 3.696627458671258*^9}, {
   3.696627561592966*^9, 3.69662759066494*^9}, {3.6966281103889837`*^9, 
   3.696628164948378*^9}, {3.69662820150517*^9, 3.696628203343645*^9}, {
   3.696628294127819*^9, 3.6966283080634127`*^9}, {3.696628369910925*^9, 
   3.696628431685104*^9}, {3.696628581057159*^9, 3.6966286344735413`*^9}, {
   3.696628717283764*^9, 3.6966287174254017`*^9}, {3.696628763365725*^9, 
   3.696628834411623*^9}, {3.6966289497346087`*^9, 3.6966290061258163`*^9}, {
   3.696629084282804*^9, 3.6966290847619658`*^9}, {3.696629160755555*^9, 
   3.6966292244318132`*^9}, {3.696629270126436*^9, 3.696629374511674*^9}, {
   3.696629436024928*^9, 3.6966294585190077`*^9}, {3.696629599435657*^9, 
   3.696629605706586*^9}, {3.696629640267462*^9, 3.696629679079907*^9}, {
   3.6966297188254957`*^9, 3.6966297691220217`*^9}, {3.696629825391139*^9, 
   3.696629836494462*^9}, {3.696630022470827*^9, 3.69663004957971*^9}, {
   3.696630228308621*^9, 3.6966303096660767`*^9}, {3.696630384032568*^9, 
   3.69663040455009*^9}, {3.6966304830525293`*^9, 3.6966304948591337`*^9}, {
   3.6966306499557953`*^9, 3.696630791515171*^9}, 3.696630928769567*^9, {
   3.696631158006093*^9, 3.696631158629746*^9}, {3.6966412502834063`*^9, 
   3.696641300487358*^9}, {3.696641342641069*^9, 3.696641447456977*^9}, {
   3.69664148579748*^9, 3.696641574611693*^9}, {3.696641617506913*^9, 
   3.6966416309386683`*^9}, {3.696641677401083*^9, 3.696641890385509*^9}, {
   3.696641990257312*^9, 3.696642031119589*^9}, {3.696642124727481*^9, 
   3.696642155604295*^9}, {3.696642216110977*^9, 3.696642218587175*^9}, {
   3.6966422563802757`*^9, 3.6966422713237457`*^9}, {3.696642354822797*^9, 
   3.69664237093431*^9}, {3.696642440585868*^9, 3.69664246134341*^9}, {
   3.6966425361662683`*^9, 3.696642577523086*^9}, {3.696642654192861*^9, 
   3.6966427059553967`*^9}, {3.696642793154036*^9, 3.6966428838889513`*^9}, {
   3.696642970769792*^9, 3.696642977200831*^9}, {3.696643007962248*^9, 
   3.69664300928988*^9}, {3.696643051406506*^9, 3.6966431077793007`*^9}, {
   3.696643138946052*^9, 3.696643142744588*^9}, {3.696643199542493*^9, 
   3.696643240920971*^9}, 
   3.728941262373396*^9},ExpressionUUID->"2907c46e-34cd-4fc8-a066-\
5445c0549fb3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SelectUnique", "[", 
   RowBox[{"ensemble_", ",", " ", "i0_", ",", "if_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"graphs", ",", "size", ",", "i"}], "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"given", " ", "a", " ", "list", " ", "of", " ", "graphs"}], ",",
       " ", 
      RowBox[{
       RowBox[{
       "returns", " ", "another", " ", "list", " ", "with", " ", "only", " ", 
        "non"}], "-", 
       RowBox[{
       "isomorphic", " ", "graphs", " ", "selected", " ", "from", " ", "the", 
        " ", "subset", " ", "of", " ", "the", " ", "original", " ", "list", 
        " ", "between", " ", "i0", " ", "and", " ", 
        RowBox[{"if", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"size", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"ensemble", "[", 
        RowBox[{"[", 
         RowBox[{"i0", ";;", "if"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"graphs", "=", 
      RowBox[{"ensemble", "[", 
       RowBox[{"[", 
        RowBox[{"i0", ";;", "i0"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Size = \>\"", ",", " ", "size"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"i", "<", "size"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "i", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"i", ",", "500"}], "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Selecting unique at \>\"", ",", "i"}], "]"}]}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"IsIsomorphic", "[", 
            RowBox[{
             RowBox[{"ensemble", "[", 
              RowBox[{"[", 
               RowBox[{"i0", "+", "i"}], "]"}], "]"}], ",", "graphs"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"graphs", ",", 
            RowBox[{"ensemble", "[", 
             RowBox[{"[", 
              RowBox[{"i0", "+", "i"}], "]"}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"i", "++"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "graphs"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.696100714065362*^9, 3.696100957019045*^9}, {
   3.696101994878159*^9, 3.6961020041496363`*^9}, {3.696114590332798*^9, 
   3.696114595635147*^9}, {3.6992836033677807`*^9, 3.6992836258126698`*^9}, {
   3.6992838815245953`*^9, 3.699283885140751*^9}, {3.717590617670651*^9, 
   3.7175906630664883`*^9}, {3.717708420659214*^9, 3.717708421456909*^9}, {
   3.71770934294053*^9, 3.717709380474615*^9}, {3.717709428227179*^9, 
   3.717709441010775*^9}, {3.717709541960127*^9, 3.7177095492725077`*^9}, {
   3.717709663589167*^9, 3.717709689560279*^9}, {3.7177097691741247`*^9, 
   3.717709781053615*^9}, {3.717715839894771*^9, 3.717715840400939*^9}, {
   3.718726642294969*^9, 3.718726645381906*^9}, {3.718731399800804*^9, 
   3.718731455963027*^9}, {3.718731510017213*^9, 3.718731515551712*^9}, {
   3.71873158674061*^9, 3.7187316092372713`*^9}, {3.7187316459148417`*^9, 
   3.718731657408143*^9}, {3.718731904754128*^9, 3.718731905424039*^9}, {
   3.719138239405077*^9, 3.719138239954088*^9}, 
   3.728941294022931*^9},ExpressionUUID->"581d7c3a-4b29-436b-988c-\
9e71a25e0245"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SelectUnique", "[", "ensemble_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"graphs", ",", "size", ",", "i"}], "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"given", " ", "a", " ", "list", " ", "of", " ", "graphs"}], ",",
       " ", 
      RowBox[{
       RowBox[{
       "returns", " ", "another", " ", "list", " ", "with", " ", "only", " ", 
        "non"}], "-", 
       RowBox[{
       "isomorphic", " ", "graphs", " ", "of", " ", "the", " ", "original", 
        " ", "list"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"graphs", "=", 
      RowBox[{"ensemble", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"size", "=", 
      RowBox[{"Length", "[", "ensemble", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"i", "=", "2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Size = \>\"", ",", " ", "size"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"i", "\[LessEqual]", "size"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "i", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"i", ",", "500"}], "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Selecting unique at \>\"", ",", "i"}], "]"}]}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"IsIsomorphic", "[", 
            RowBox[{
             RowBox[{"ensemble", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "graphs"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"graphs", ",", 
            RowBox[{"ensemble", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]",
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"i", "++"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "graphs"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.696100714065362*^9, 3.696100957019045*^9}, {
   3.696101994878159*^9, 3.6961020041496363`*^9}, {3.696114590332798*^9, 
   3.696114595635147*^9}, {3.6992836033677807`*^9, 3.6992836258126698`*^9}, {
   3.6992838815245953`*^9, 3.699283885140751*^9}, {3.717590617670651*^9, 
   3.7175906630664883`*^9}, {3.717708420659214*^9, 3.717708421456909*^9}, {
   3.71770934294053*^9, 3.717709380474615*^9}, {3.717709428227179*^9, 
   3.717709441010775*^9}, {3.717709541960127*^9, 3.7177095492725077`*^9}, {
   3.717709663589167*^9, 3.717709689560279*^9}, {3.7177097691741247`*^9, 
   3.717709781053615*^9}, {3.717715839894771*^9, 3.717715840400939*^9}, {
   3.718726642294969*^9, 3.718726645381906*^9}, 
   3.728941294826909*^9},ExpressionUUID->"51e89640-6b4c-4b18-86e8-\
db9945b4bf3e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MergeUnique", "[", 
   RowBox[{"ensemble1_", ",", "ensemble2_", ",", " ", "i0_", ",", "if_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"graphs", ",", "size", ",", "i"}], "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "given", " ", "a", " ", "list", " ", "of", " ", "graphs", " ", 
       "ensemble1"}], ",", " ", 
      RowBox[{
      "this", " ", "functions", " ", "selects", " ", "out", " ", "all", " ", 
       "graphs", " ", "from", " ", "ensemble2", " ", "between", " ", "i0", 
       " ", "and", " ", "if"}], ",", " ", 
      RowBox[{
      "that", " ", "are", " ", "not", " ", "isomorphic", " ", "to", " ", 
       "any", " ", "graphs", " ", "in", " ", "ensemble1"}], ",", " ", 
      RowBox[{
       RowBox[{
       "and", " ", "returns", " ", "the", " ", "union", " ", "of", " ", 
        "ensemble1", " ", "and", " ", "the", " ", "non"}], "-", 
       RowBox[{"isomorphic", " ", "subsets", " ", "from", " ", 
        RowBox[{"ensemble2", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"size", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"ensemble2", "[", 
        RowBox[{"[", 
         RowBox[{"i0", ";;", "if"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"graphs", "=", "ensemble1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Size = \>\"", ",", " ", "size"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"i", "<", "size"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "i", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"i", ",", "500"}], "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Selecting unique at \>\"", ",", "i"}], "]"}]}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"IsIsomorphic", "[", 
            RowBox[{
             RowBox[{"ensemble2", "[", 
              RowBox[{"[", 
               RowBox[{"i0", "+", "i"}], "]"}], "]"}], ",", "graphs"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"graphs", ",", 
            RowBox[{"ensemble2", "[", 
             RowBox[{"[", 
              RowBox[{"i0", "+", "i"}], "]"}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"i", "++"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "graphs"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.696100714065362*^9, 3.696100957019045*^9}, {
   3.696101994878159*^9, 3.6961020041496363`*^9}, {3.696114590332798*^9, 
   3.696114595635147*^9}, {3.6992836033677807`*^9, 3.6992836258126698`*^9}, {
   3.6992838815245953`*^9, 3.699283885140751*^9}, {3.717590617670651*^9, 
   3.7175906630664883`*^9}, {3.717708420659214*^9, 3.717708421456909*^9}, {
   3.71770934294053*^9, 3.717709380474615*^9}, {3.717709428227179*^9, 
   3.717709441010775*^9}, {3.717709541960127*^9, 3.7177095492725077`*^9}, {
   3.717709663589167*^9, 3.717709689560279*^9}, {3.7177097691741247`*^9, 
   3.717709781053615*^9}, {3.717715839894771*^9, 3.717715840400939*^9}, {
   3.718726642294969*^9, 3.718726645381906*^9}, {3.718731399800804*^9, 
   3.718731455963027*^9}, {3.718731510017213*^9, 3.718731515551712*^9}, {
   3.71873158674061*^9, 3.7187316092372713`*^9}, {3.7187316459148417`*^9, 
   3.718731657408143*^9}, {3.718731904754128*^9, 3.718731905424039*^9}, {
   3.7189967531432047`*^9, 3.718996935761628*^9}, 3.718996973932044*^9, 
   3.728941332905898*^9},ExpressionUUID->"09fefbc8-a350-4ea4-9ce0-\
c2bad07e1023"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MergeUnique", "[", 
   RowBox[{"ensemble1_", ",", "ensemble2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"graphs", ",", "size", ",", "i"}], "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "given", " ", "a", " ", "list", " ", "of", " ", "graphs", " ", 
       "ensemble1"}], ",", " ", 
      RowBox[{
      "this", " ", "functions", " ", "selects", " ", "out", " ", "all", " ", 
       "graphs", " ", "from", " ", "ensemble2", " ", "that", " ", "are", " ", 
       "not", " ", "isomorphic", " ", "to", " ", "any", " ", "graphs", " ", 
       "in", " ", "ensemble1"}], ",", " ", 
      RowBox[{
       RowBox[{
       "and", " ", "returns", " ", "the", " ", "union", " ", "of", " ", 
        "ensemble1", " ", "and", " ", "the", " ", "non"}], "-", 
       RowBox[{"isomorphic", " ", "subsets", " ", "from", " ", 
        RowBox[{"ensemble2", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"size", "=", 
      RowBox[{"Length", "[", "ensemble2", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"graphs", "=", "ensemble1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Size = \>\"", ",", " ", "size"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"i", "<", "size"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "i", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"i", ",", "500"}], "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Selecting unique at \>\"", ",", "i"}], "]"}]}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"IsIsomorphic", "[", 
            RowBox[{
             RowBox[{"ensemble2", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "graphs"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"graphs", ",", 
            RowBox[{"ensemble2", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]",
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"i", "++"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "graphs"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.696100714065362*^9, 3.696100957019045*^9}, {
   3.696101994878159*^9, 3.6961020041496363`*^9}, {3.696114590332798*^9, 
   3.696114595635147*^9}, {3.6992836033677807`*^9, 3.6992836258126698`*^9}, {
   3.6992838815245953`*^9, 3.699283885140751*^9}, {3.717590617670651*^9, 
   3.7175906630664883`*^9}, {3.717708420659214*^9, 3.717708421456909*^9}, {
   3.71770934294053*^9, 3.717709380474615*^9}, {3.717709428227179*^9, 
   3.717709441010775*^9}, {3.717709541960127*^9, 3.7177095492725077`*^9}, {
   3.717709663589167*^9, 3.717709689560279*^9}, {3.7177097691741247`*^9, 
   3.717709781053615*^9}, {3.717715839894771*^9, 3.717715840400939*^9}, {
   3.718726642294969*^9, 3.718726645381906*^9}, {3.718731399800804*^9, 
   3.718731455963027*^9}, {3.718731510017213*^9, 3.718731515551712*^9}, {
   3.71873158674061*^9, 3.7187316092372713`*^9}, {3.7187316459148417`*^9, 
   3.718731657408143*^9}, {3.718731904754128*^9, 3.718731905424039*^9}, {
   3.7189967531432047`*^9, 3.718996935761628*^9}, 3.718996973932044*^9, {
   3.718997014042467*^9, 3.718997070801435*^9}, 
   3.728941333428434*^9},ExpressionUUID->"7989d326-37c7-43c0-ac49-\
63226e78aa14"],

Cell[BoxData[
 RowBox[{
  RowBox[{"UniqExpandEnsemble", "[", 
   RowBox[{"ensemble_", ",", "enum_Integer"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"graphs", ",", "ensembleSize", ",", "i", ",", "uniqexpansion"}], 
     "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Given", " ", "a", " ", "list", " ", "of", " ", "graphs", " ", 
       RowBox[{"(", "ensemble", ")"}]}], ",", " ", 
      RowBox[{
       RowBox[{
       "expand", " ", "each", " ", "graph", " ", "by", " ", "a", " ", 
        "vertex", " ", "with", " ", "enum", " ", 
        RowBox[{"degrees", ".", " ", "It"}], " ", "selects", " ", "only", " ",
         "the", " ", "non"}], "-", 
       RowBox[{
       "isomorphic", " ", "expansions", " ", "to", " ", "a", " ", "given", 
        " ", "graph", " ", "from", " ", "the", " ", "original", " ", 
        RowBox[{"ensemble", ".", " ", "Note"}]}]}], ",", " ", 
      RowBox[{
       RowBox[{
       "the", " ", "original", " ", "list", " ", "may", " ", "or", " ", "may",
         " ", "not", " ", "be", " ", "a", " ", "list", " ", "of", " ", 
        "non"}], "-", 
       RowBox[{"isomorphic", " ", 
        RowBox[{"graphs", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"graphs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ensembleSize", "=", 
      RowBox[{"Length", "[", "ensemble", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", "ensembleSize"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"i", ",", 
             RowBox[{"ensembleSize", "/", "1000"}]}], "]"}], "\[Equal]", 
           "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Making graph \>\"", ",", "i"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"uniqexpansion", "=", 
         RowBox[{"SelectUnique", "[", 
          RowBox[{"ExpandGraph", "[", 
           RowBox[{
            RowBox[{"ensemble", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "enum"}], "]"}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"graphs", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"graphs", ",", "uniqexpansion"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "graphs"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6961003570265102`*^9, 3.6961005847733593`*^9}, {
   3.6961006275289516`*^9, 3.696100660417267*^9}, {3.696101075066818*^9, 
   3.696101094552567*^9}, {3.69610112663588*^9, 3.696101182743472*^9}, {
   3.696101397055152*^9, 3.696101433660405*^9}, {3.696101906974287*^9, 
   3.696101915702386*^9}, {3.6961019468561373`*^9, 3.69610198073318*^9}, {
   3.6966102709381943`*^9, 3.696610278569579*^9}, 3.728941164944316*^9, 
   3.728941296010036*^9, 
   3.728941359775626*^9},ExpressionUUID->"b50de41a-470b-479a-b34e-\
ecdd884a9db1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"UniqExpandEnsemble", "[", "ensemble_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"graphs", ",", "ensembleSize", ",", "i", ",", "uniqexpansion"}], 
     "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Given", " ", "a", " ", "list", " ", "of", " ", "graphs", " ", 
       RowBox[{"(", "ensemble", ")"}]}], ",", " ", 
      RowBox[{
       RowBox[{
       "expand", " ", "each", " ", "graph", " ", "by", " ", "a", " ", 
        "vertex", " ", "with", " ", "all", " ", "possible", " ", "degrees", 
        " ", "for", " ", "the", " ", "new", " ", 
        RowBox[{"vertex", ".", " ", "It"}], " ", "selects", " ", "only", " ", 
        "the", " ", "non"}], "-", 
       RowBox[{
       "isomorphic", " ", "expansions", " ", "to", " ", "a", " ", "given", 
        " ", "graph", " ", "from", " ", "the", " ", "original", " ", 
        RowBox[{"ensemble", ".", " ", "Note"}]}]}], ",", " ", 
      RowBox[{
       RowBox[{
       "the", " ", "original", " ", "list", " ", "may", " ", "or", " ", "may",
         " ", "not", " ", "be", " ", "a", " ", "list", " ", "of", " ", 
        "non"}], "-", 
       RowBox[{"isomorphic", " ", 
        RowBox[{"graphs", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"graphs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ensembleSize", "=", 
      RowBox[{"Length", "[", "ensemble", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", "ensembleSize"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"i", ",", 
             RowBox[{"ensembleSize", "/", "1000"}]}], "]"}], "\[Equal]", 
           "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Making graph \>\"", ",", "i"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"uniqexpansion", "=", 
         RowBox[{"SelectUnique", "[", 
          RowBox[{"ExpandGraph", "[", 
           RowBox[{"ensemble", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"graphs", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"graphs", ",", "uniqexpansion"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "graphs"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6961013034388933`*^9, 3.696101323868928*^9}, {
   3.696101441871418*^9, 3.696101486878467*^9}, {3.696101970870419*^9, 
   3.696101976918692*^9}, {3.6966433852167177`*^9, 3.696643387374817*^9}, 
   3.72894116578119*^9, 3.72894129703377*^9, 
   3.728941360199738*^9},ExpressionUUID->"136f5e9f-18c1-483d-8f2e-\
17f2f4e0f251"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetAllAijs", "[", "ensemble_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "size", "}"}], ",", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "given", " ", "a", " ", "list", " ", "of", " ", "adjacency", " ", 
        "matrices", " ", "ensemble"}], ",", " ", 
       RowBox[{
       "it", " ", "extracts", " ", "the", " ", "vector", " ", "of", " ", 
        "ones", " ", "and", " ", "zeros", " ", "of", " ", "the", " ", "upper",
         " ", "diagonal", " ", "that", " ", "is", " ", "the", " ", "unique", 
        " ", "integer", " ", "base", " ", "2", " ", "corresponding", " ", 
        "to", " ", "the", " ", "graph", " ", "for", " ", "the", " ", "whole", 
        " ", "list"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"size", "=", 
       RowBox[{"Length", "[", "ensemble", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"GetAijs", "[", 
         RowBox[{"ensemble", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "size"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.696618106466263*^9, 3.696618146947145*^9}, {
  3.696618331396628*^9, 3.69661849431285*^9}, {3.696618528300974*^9, 
  3.696618648857379*^9}, {3.696618707517037*^9, 3.69661870758757*^9}, {
  3.696643841653387*^9, 3.696643842396182*^9}, {3.718740989643854*^9, 
  3.718740994313939*^9}, {3.718741027388773*^9, 3.718741078307837*^9}, {
  3.728941394968575*^9, 
  3.728941418203*^9}},ExpressionUUID->"a255089e-3fd5-431a-96cc-bada65230788"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetAijs", "[", "Amat_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"aijs", ",", "n", ",", "k", ",", "L"}], "}"}], ",", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "given", " ", "an", " ", "adjacency", " ", "matrix", " ", "Amat"}], 
       ",", " ", 
       RowBox[{
       "it", " ", "extracts", " ", "the", " ", "vector", " ", "of", " ", 
        "ones", " ", "and", " ", "zeros", " ", "of", " ", "the", " ", "upper",
         " ", "diagonal", " ", "that", " ", "is", " ", "the", " ", "unique", 
        " ", "integer", " ", "base", " ", "2", " ", "corresponding", " ", 
        "to", " ", "the", " ", "graph"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "Amat", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"L", "=", 
       RowBox[{
        RowBox[{"1", "/", "8"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", "n"}], "-", "1"}], ")"}], "^", "2"}], "-", 
          "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"aijs", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "L"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"k", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"j", "-", "2"}], ")"}], "/", "2"}]}], "+", "i"}]}], 
           ";", 
           RowBox[{
            RowBox[{"aijs", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "=", 
            RowBox[{"Amat", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2", ",", "n"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "aijs"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.696618106466263*^9, 3.696618146947145*^9}, {
   3.696618331396628*^9, 3.69661849431285*^9}, {3.696618528300974*^9, 
   3.696618648857379*^9}, {3.696618707517037*^9, 3.69661870758757*^9}, {
   3.696643841653387*^9, 3.696643842396182*^9}, 3.728941412460869*^9, {
   3.728941458074198*^9, 
   3.728941492400446*^9}},ExpressionUUID->"3b9ddefc-e042-48bf-8d08-\
22e3cef829a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetGint", "[", "Amat_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "given", " ", "an", " ", "adjacency", " ", "matrix", " ", "Amat"}], 
       ",", " ", 
       RowBox[{
       "it", " ", "extracts", " ", "the", " ", "unique", " ", "integer", " ", 
        "base", " ", "10", " ", "corresponding", " ", "to", " ", "the", " ", 
        "graph"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"FromDigits", "[", 
      RowBox[{
       RowBox[{"GetAijs", "[", "Amat", "]"}], ",", "2"}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.696618751185058*^9, 3.6966187997268972`*^9}, {
   3.696618875425675*^9, 3.696618897856497*^9}, {3.6966189499139643`*^9, 
   3.696618957106893*^9}, {3.6966190564820213`*^9, 3.696619080079475*^9}, 
   3.728941413703169*^9, {3.7289423814592867`*^9, 
   3.728942381673852*^9}},ExpressionUUID->"7f5a87a1-cb11-4c34-a5f9-\
587597330ac0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetAllGint", "[", "ensemble_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "size", "}"}], ",", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "given", " ", "a", " ", "list", " ", "of", " ", "adjacency", " ", 
        "matrix", " ", "ensemble"}], ",", " ", 
       RowBox[{
       "it", " ", "produces", " ", "a", " ", "list", " ", "of", " ", "the", 
        " ", "unique", " ", "integers", " ", "base", " ", "10", " ", 
        "corresponding", " ", "to", " ", "each", " ", "graph"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"size", "=", 
       RowBox[{"Length", "[", "ensemble", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"GetGint", "[", 
         RowBox[{"ensemble", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "size"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.696619139484848*^9, 3.6966192399454536`*^9}, {
  3.69661928258429*^9, 3.696619287656605*^9}, {3.69661940641485*^9, 
  3.6966194074942427`*^9}, {3.6966195852460938`*^9, 3.69661958788507*^9}, {
  3.696643609902382*^9, 3.696643610302058*^9}, {3.728942397665041*^9, 
  3.728942415204729*^9}},ExpressionUUID->"477b1ec7-015d-44f7-926c-\
a031f351157b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"MakeAmat", ",", "MakeAmat2", ",", "MakeAmatOld"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeAmatOld", "[", "aijs_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "size", ",", "n", ",", "Amat", ",", "row", ",", "i", ",", "j", ",", 
       "k"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"size", "=", 
       RowBox[{"Length", "[", "aijs", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{
        RowBox[{"1", "/", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"1", "+", 
            RowBox[{"8", "*", "size"}]}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Amat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<", "n"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", 
             RowBox[{"i", "+", "1"}]}], ",", 
            RowBox[{"j", "\[LessEqual]", "n"}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"k", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"i", "/", "2"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", "n"}], "-", "i", "-", "1"}], ")"}]}], "-", "n",
                "+", "j"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Amat", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
              RowBox[{"aijs", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Amat", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", 
              RowBox[{"aijs", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "2"}], ",", 
        RowBox[{"j", "<=", "n"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<", "j"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"k", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"j", "-", "2"}], ")"}], "/", "2"}]}], "+", "i"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Amat", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{"aijs", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Amat", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", 
            RowBox[{"aijs", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]",
          "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "Amat"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeAmatOld", "[", 
     RowBox[{"aijs_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Amat", ",", "size", ",", "row", ",", "i", ",", "j", ",", "k"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"size", "=", 
        RowBox[{"Length", "[", "aijs", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"n", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}], "/", "2"}]}], "\[NotEqual]", 
          "size"}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<Error, matrix size doesn't match!\>\"", "]"}], 
          ";", "Abort"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Amat", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "<", "n"}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", 
              RowBox[{"i", "+", "1"}]}], ",", 
             RowBox[{"j", "\[LessEqual]", "n"}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"k", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"i", "/", "2"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "n"}], "-", "i", "-", "1"}], ")"}]}], "-", 
                "n", "+", "j"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Amat", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
               RowBox[{"aijs", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{"Amat", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", 
               RowBox[{"aijs", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
         ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "2"}], ",", 
         RowBox[{"j", "<=", "n"}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "<", "j"}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"k", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"j", "-", "1"}], ")"}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"j", "-", "2"}], ")"}], "/", "2"}]}], "+", "i"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Amat", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
             RowBox[{"aijs", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Amat", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", 
             RowBox[{"aijs", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "Amat"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeAmat", "[", "aijs_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"size", ",", "n", ",", "k", ",", "Amat"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Given", " ", "a", " ", "list", " ", "with", " ", 
         RowBox[{"one", "'"}], "s", " ", "and", " ", "zeros"}], ",", " ", 
        RowBox[{
        "it", " ", "makes", " ", "an", " ", "adjacency", " ", "matrix", " ", 
         "with", " ", "the", " ", "elements", " ", "of", " ", "the", " ", 
         "list", " ", "as", " ", "the", " ", "matrix", " ", 
         RowBox[{"elements", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"size", "=", 
        RowBox[{"Length", "[", "aijs", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"1", "+", 
             RowBox[{"8", "*", "size"}]}], "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k", "[", "i_", "]"}], ":=", 
        RowBox[{
         RowBox[{"i", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "/", "2"}]}], "+", "1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Amat", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"PadRight", "[", 
           RowBox[{
            RowBox[{"aijs", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"k", "[", 
                RowBox[{"i", "-", "1"}], "]"}], ";;", 
               RowBox[{
                RowBox[{"k", "[", "i", "]"}], "-", "1"}]}], "]"}], "]"}], ",",
             "n"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Amat", "=", 
        RowBox[{"Amat", "+", 
         RowBox[{"Transpose", "[", "Amat", "]"}]}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeAmat", "[", 
    RowBox[{"aijs_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"size", ",", "k", ",", "Amat"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"size", "=", 
       RowBox[{"Length", "[", "aijs", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"n", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "1"}], ")"}], "/", "2"}]}], "\[NotEqual]", 
         "size"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<Error, matrix size doesn't match!\>\"", "]"}], 
         ";", "Abort"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"k", "[", "i_", "]"}], ":=", 
       RowBox[{
        RowBox[{"i", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], "/", "2"}]}], "+", "1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Amat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"PadRight", "[", 
          RowBox[{
           RowBox[{"aijs", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"k", "[", 
               RowBox[{"i", "-", "1"}], "]"}], ";;", 
              RowBox[{
               RowBox[{"k", "[", "i", "]"}], "-", "1"}]}], "]"}], "]"}], ",", 
           "n"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Amat", "=", 
       RowBox[{"Amat", "+", 
        RowBox[{"Transpose", "[", "Amat", "]"}]}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6737930691018047`*^9, 3.6737930711170683`*^9}, {
   3.673793557301476*^9, 3.6737936629667397`*^9}, {3.67379370522817*^9, 
   3.673793753617107*^9}, {3.673793813728775*^9, 3.67379382612724*^9}, {
   3.673793932059511*^9, 3.6737939803066187`*^9}, {3.673794032390088*^9, 
   3.673794200200341*^9}, {3.673794512545679*^9, 3.673794545955565*^9}, {
   3.673794936816712*^9, 3.673794943766982*^9}, {3.673794998980321*^9, 
   3.673795072455146*^9}, {3.673795109389339*^9, 3.673795119197029*^9}, {
   3.673795564644084*^9, 3.673795710173267*^9}, {3.6737970613905687`*^9, 
   3.67379711964321*^9}, {3.673798227199841*^9, 3.67379825619466*^9}, {
   3.673798326182272*^9, 3.6737983262764072`*^9}, {3.673798361591385*^9, 
   3.673798391315539*^9}, {3.673798466630859*^9, 3.673798520044888*^9}, {
   3.673798566154788*^9, 3.673798585186013*^9}, {3.673798627983507*^9, 
   3.673798628694808*^9}, {3.67379866919697*^9, 3.673798690339922*^9}, {
   3.673798743738845*^9, 3.673798852068388*^9}, {3.673798899367612*^9, 
   3.673799035130705*^9}, {3.673799067491617*^9, 3.673799159608234*^9}, {
   3.673799200002037*^9, 3.67379924803681*^9}, {3.673799817992969*^9, 
   3.6737998920373507`*^9}, {3.6738000667946587`*^9, 3.673800070153407*^9}, {
   3.673800122386076*^9, 3.673800134968852*^9}, {3.6738002215157623`*^9, 
   3.673800254971884*^9}, {3.673800407968158*^9, 3.673800453729841*^9}, {
   3.673800490272004*^9, 3.673800502054043*^9}, {3.673800687620473*^9, 
   3.673800794705819*^9}, {3.673800853116632*^9, 3.673801074167954*^9}, {
   3.673801144230782*^9, 3.673801230773696*^9}, {3.673801262229576*^9, 
   3.673801313170384*^9}, {3.673801353587007*^9, 3.673801403908897*^9}, {
   3.682439084589398*^9, 3.68243909982723*^9}, {3.682439161845489*^9, 
   3.682439202332428*^9}, {3.6824392492094*^9, 3.682439308265355*^9}, {
   3.682439441900053*^9, 3.6824394437467003`*^9}, {3.6824395193659687`*^9, 
   3.682439519780765*^9}, {3.6824395923884497`*^9, 3.682439605498328*^9}, {
   3.6824396364832077`*^9, 3.682439707031955*^9}, {3.682514913855783*^9, 
   3.6825149192055473`*^9}, {3.68251509646451*^9, 3.682515177145624*^9}, {
   3.6825152681857357`*^9, 3.68251530025756*^9}, {3.682515441856983*^9, 
   3.682515456303664*^9}, {3.682515532439074*^9, 3.6825155462131033`*^9}, {
   3.68251558982541*^9, 3.682515727827675*^9}, {3.682516017794766*^9, 
   3.68251612248368*^9}, {3.682516197310622*^9, 3.682516262610095*^9}, {
   3.682516320247707*^9, 3.6825163567966013`*^9}, {3.6825163917494926`*^9, 
   3.682516516841708*^9}, {3.6825165835775146`*^9, 3.682516589554735*^9}, {
   3.6825170569683723`*^9, 3.682517128597061*^9}, {3.6825172274142227`*^9, 
   3.682517250605702*^9}, {3.68251728576445*^9, 3.6825173733387127`*^9}, {
   3.682521688204713*^9, 3.682521755433125*^9}, {3.6825218356757107`*^9, 
   3.6825218679351463`*^9}, {3.682521938399847*^9, 3.682521944504798*^9}, {
   3.682521989060225*^9, 3.682521989322513*^9}, {3.682522043774708*^9, 
   3.682522056740423*^9}, {3.682522121577297*^9, 3.6825221280476837`*^9}, {
   3.6825222182804823`*^9, 3.6825222212641163`*^9}, 3.682522627399447*^9, {
   3.682805965080406*^9, 3.68280597580657*^9}, {3.682806049902293*^9, 
   3.682806074450037*^9}, {3.682977179389229*^9, 3.682977179755637*^9}, {
   3.68298969852522*^9, 3.682989717297154*^9}, {3.6829897491971807`*^9, 
   3.68298978678089*^9}, 3.68298983012753*^9, {3.682990035708351*^9, 
   3.6829900369132147`*^9}, {3.682990133174498*^9, 3.682990157997628*^9}, {
   3.6829901968482733`*^9, 3.6829902199824*^9}, {3.682990625043777*^9, 
   3.682990670018373*^9}, {3.6830441619139223`*^9, 3.683044175381611*^9}, {
   3.683044313793654*^9, 3.683044449712401*^9}, {3.683044534695712*^9, 
   3.68304454964524*^9}, {3.683045985059779*^9, 3.683046007179996*^9}, {
   3.683046124067223*^9, 3.6830461247380543`*^9}, {3.683046223517256*^9, 
   3.683046246189431*^9}, {3.685392037278137*^9, 3.685392084550419*^9}, {
   3.728942421182507*^9, 3.728942433717573*^9}, {3.730300560336728*^9, 
   3.730300561883554*^9}, 3.73030071722508*^9, {3.730300965004532*^9, 
   3.730300968201823*^9}, {3.730301013791568*^9, 3.730301055610311*^9}, {
   3.730301165568386*^9, 3.73030116717598*^9}, {3.730301205587736*^9, 
   3.7303012507874327`*^9}, {3.73030134072151*^9, 3.730301342912806*^9}, {
   3.730301476419518*^9, 3.730301671373025*^9}, {3.730301719194016*^9, 
   3.730301721412888*^9}, {3.73030178784912*^9, 3.7303018313384523`*^9}, {
   3.730301883088251*^9, 3.730301883390396*^9}, {3.7303019257909403`*^9, 
   3.730301929899144*^9}, {3.730301962303903*^9, 3.730301965664784*^9}, {
   3.7303020020908546`*^9, 3.7303020285847397`*^9}, {3.730302086324411*^9, 
   3.730302091041767*^9}, {3.730302123489855*^9, 3.7303021545354843`*^9}, {
   3.730302782938764*^9, 3.730302783016651*^9}, {3.730304080481349*^9, 
   3.73030412026968*^9}, {3.73030417129895*^9, 3.730304213397435*^9}, {
   3.7303042565116863`*^9, 3.7303042863465023`*^9}, {3.730304320824452*^9, 
   3.730304342030381*^9}, {3.7303043898739033`*^9, 3.730304403454852*^9}, {
   3.730304455109251*^9, 3.730304455661216*^9}, {3.730304517705723*^9, 
   3.730304548360579*^9}, {3.730304623992243*^9, 3.730304665482716*^9}, {
   3.730304724964362*^9, 3.730304738929194*^9}, {3.7303048230280523`*^9, 
   3.730304823367543*^9}, {3.730305217603861*^9, 3.730305217712973*^9}, {
   3.7303052569389143`*^9, 3.730305318827793*^9}, {3.73030550700321*^9, 
   3.730305608522785*^9}, {3.730305641717581*^9, 3.7303056518903913`*^9}, {
   3.7303056856079884`*^9, 3.730305778861676*^9}, {3.730305848903529*^9, 
   3.730305909097953*^9}, {3.7303145385381107`*^9, 3.730314538989616*^9}, {
   3.730327597905352*^9, 
   3.730327658655181*^9}},ExpressionUUID->"51d82818-d262-43f0-8d54-\
66ec597bf17f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"MakeAmatOld", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}], 
     "]"}], "//", 
    RowBox[{"MatrixForm", "\[IndentingNewLine]", 
     RowBox[{"MakeAmat", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}],
       "]"}]}]}], "//", "MatrixForm"}], "*)"}]], "Input",
 CellChangeTimes->{{3.730327668080348*^9, 
  3.7303276719710503`*^9}},ExpressionUUID->"e4c1557f-2c5f-45ea-a66e-\
a7e37c118c15"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeRegAij", "[", 
    RowBox[{"h_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Amat", ",", "row", ",", "k"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"h", ",", "2"}], "]"}], "\[Equal]", 
         RowBox[{"Mod", "[", 
          RowBox[{"n", ",", "2"}], "]"}], "\[Equal]", "1"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Error, both vertex degree and number of nodes are odd\>\"", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"M", " ", "=", " ", 
         RowBox[{
          RowBox[{"1", "/", "2"}], " ", "n", " ", "h"}]}], ",", " ", 
        RowBox[{
         RowBox[{"where", " ", "M"}], " ", "=", " ", 
         RowBox[{"total", " ", "number", " ", "of", " ", "edges"}]}], ",", 
        " ", 
        RowBox[{"has", " ", "to", " ", "be", " ", 
         RowBox[{"satisfied", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Amat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"row", "=", "1"}], ",", 
        RowBox[{"row", "<=", "n"}], ",", 
        RowBox[{"row", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "0"}], ",", 
          RowBox[{"k", "<", 
           RowBox[{"Floor", "[", 
            RowBox[{"h", "/", "2"}], "]"}]}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Amat", "[", 
             RowBox[{"[", 
              RowBox[{"row", ",", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"row", "+", "k"}], ",", "n"}], "]"}], "+", "1"}]}], 
              "]"}], "]"}], "=", "1"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Amat", "[", 
             RowBox[{"[", 
              RowBox[{"row", ",", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"row", "-", "2", "-", "k"}], ",", "n"}], "]"}], "+",
                 "1"}]}], "]"}], "]"}], "=", "1"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"h", ",", "2"}], "]"}], "\[Equal]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"row", "=", "1"}], ",", 
          RowBox[{"row", "\[LessEqual]", 
           RowBox[{"n", "/", "2"}]}], ",", 
          RowBox[{"row", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Amat", "[", 
             RowBox[{"[", 
              RowBox[{"row", ",", 
               RowBox[{"row", "+", 
                RowBox[{"n", "/", "2"}]}]}], "]"}], "]"}], "=", "1"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Amat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"row", "+", 
                RowBox[{"n", "/", "2"}]}], ",", "row"}], "]"}], "]"}], "=", 
            "1"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "Amat"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.685309791817308*^9, 3.685309813488446*^9}, {
   3.6853920935859613`*^9, 3.6853921007722607`*^9}, 
   3.728942470269373*^9},ExpressionUUID->"3ec46f38-2590-448f-8e82-\
dae74470a182"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeRegAijs", "[", 
    RowBox[{"permmat_", ",", "h_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Mat", ",", "row", ",", "k"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"h", ",", "2"}], "]"}], "\[Equal]", 
         RowBox[{"Mod", "[", 
          RowBox[{"n", ",", "2"}], "]"}], "\[Equal]", "1"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Error, both vertex degree and number of nodes are odd\>\"", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"M", " ", "=", " ", 
         RowBox[{
          RowBox[{"1", "/", "2"}], " ", "n", " ", "h"}]}], ",", " ", 
        RowBox[{
         RowBox[{"where", " ", "M"}], " ", "=", " ", 
         RowBox[{"total", " ", "number", " ", "of", " ", "edges"}]}], ",", 
        " ", 
        RowBox[{"has", " ", "to", " ", "be", " ", 
         RowBox[{"satisfied", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Mat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"row", "=", "1"}], ",", 
        RowBox[{"row", "<=", "n"}], ",", 
        RowBox[{"row", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "0"}], ",", 
          RowBox[{"k", "<", 
           RowBox[{"Floor", "[", 
            RowBox[{"h", "/", "2"}], "]"}]}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Mat", "[", 
             RowBox[{"[", 
              RowBox[{"row", ",", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"row", "+", "k"}], ",", "n"}], "]"}], "+", "1"}]}], 
              "]"}], "]"}], "=", "1"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Mat", "[", 
             RowBox[{"[", 
              RowBox[{"row", ",", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"row", "-", "2", "-", "k"}], ",", "n"}], "]"}], "+",
                 "1"}]}], "]"}], "]"}], "=", "1"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"h", ",", "2"}], "]"}], "\[Equal]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"row", "=", "1"}], ",", 
          RowBox[{"row", "\[LessEqual]", 
           RowBox[{"n", "/", "2"}]}], ",", 
          RowBox[{"row", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Mat", "[", 
             RowBox[{"[", 
              RowBox[{"row", ",", 
               RowBox[{"row", "+", 
                RowBox[{"n", "/", "2"}]}]}], "]"}], "]"}], "=", "1"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Mat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"row", "+", 
                RowBox[{"n", "/", "2"}]}], ",", "row"}], "]"}], "]"}], "=", 
            "1"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"AdjacencyGraph", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Transpose", "[", "permm", "]"}], ".", "Mat", ".", 
            "permm"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"70", ",", "70"}], "}"}]}]}], "]"}], "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Transpose", "[", "permmat", "]"}], ".", "Mat", ".", 
       "permmat"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.728942470678993*^9},ExpressionUUID->"a9959c56-54dd-463e-907c-\
c7337e80dc4f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Geometries", "Subsubsection",
 CellChangeTimes->{{3.685285264289551*^9, 
  3.685285266160647*^9}},ExpressionUUID->"1d028dbe-41d0-4c25-b85b-\
a9c8712aa047"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DropOne", "[", 
    RowBox[{"m_", ",", "parts__List"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "@", 
     RowBox[{"{", "parts", "}"}]}], "\[LessEqual]", 
    RowBox[{"ArrayDepth", "[", "m", "]"}]}]}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"m", "[", 
     RowBox[{"[", "##", "]"}], "]"}], "&"}], "@@", 
   RowBox[{"MapThread", "[", 
    RowBox[{"Complement", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Range", "@", 
        RowBox[{"Dimensions", "[", 
         RowBox[{"m", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"{", "parts", "}"}]}]}], "]"}]}], ",", 
       RowBox[{"{", "parts", "}"}]}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"/;", " ", 
    RowBox[{"is", " ", "a", " ", "condition"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.685304211164904*^9, 3.685304211221723*^9}, {
  3.6853045997748404`*^9, 3.6853046267483053`*^9}, {3.6853046660568323`*^9, 
  3.6853046677920094`*^9}, {3.6853047730435534`*^9, 3.6853048078003197`*^9}, {
  3.685304846229764*^9, 3.685304858912572*^9}, {3.685305043556292*^9, 
  3.6853050440592947`*^9}, {3.728940867736771*^9, 
  3.728940875406019*^9}},ExpressionUUID->"2f52ec85-6f3a-4309-af63-\
c20728aa6d05"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Deg", "[", 
    RowBox[{"Amat_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Total", "[", 
    RowBox[{"Amat", "[", 
     RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.726601934264773*^9, 3.72660195576525*^9}, {
   3.728940880450852*^9, 3.728940887210464*^9}, {3.729030094043366*^9, 
   3.7290301137261057`*^9}, 
   3.729030282867867*^9},ExpressionUUID->"52305492-8e3c-4ba9-9607-\
76662545ffc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AvgDeg", "[", "Amat_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", 
      RowBox[{"Length", "[", "Amat", "]"}]}], ")"}], "*", 
    RowBox[{"Total", "[", 
     RowBox[{"Valencyvec", "[", "Amat", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.685315709321251*^9, 3.68531580960411*^9}, {
   3.685391949304284*^9, 3.685391950792122*^9}, {3.728844254217884*^9, 
   3.728844261062986*^9}, {3.72894085310192*^9, 3.7289408546899137`*^9}, {
   3.728940890796179*^9, 3.728940899349265*^9}, 
   3.728942789922206*^9},ExpressionUUID->"de0345fb-f4c1-407c-b955-\
a3cd1dd6f2a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EdgeTot", "[", "Amat_", "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], "*", 
    RowBox[{"Total", "[", 
     RowBox[{"Valencyvec", "[", "Amat", "]"}], "]"}]}]}], ";"}]], "Input",Expr\
essionUUID->"1f7c3a02-a356-4e35-b15c-93a0a67de5ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Valencyvec", "[", "Amat_", "]"}], ":=", 
     RowBox[{"(*", 
      RowBox[{
      "A", " ", "vector", " ", "of", " ", "all", " ", "the", " ", "degrees", 
       " ", "of", " ", "the", " ", "graph"}], "*)"}], 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Deg", "[", 
        RowBox[{"Amat", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "Amat", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Valencymat", "[", "Am_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "dvec", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dvec", "=", 
       RowBox[{"Valencyvec", "[", "Am", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"DiagonalMatrix", "[", "dvec", "]"}]}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6960904222792263`*^9, 3.6960904462612*^9}, 
   3.7289425093068447`*^9, 3.728942791618925*^9, {3.728942887980299*^9, 
   3.7289428890451937`*^9}, {3.728942940344919*^9, 3.7289429802052183`*^9}, {
   3.7289430219475107`*^9, 
   3.7289430236851053`*^9}},ExpressionUUID->"79499bad-9059-46a9-afbf-\
e3f9656fb36a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Neighbors", "[", 
    RowBox[{"Amat_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Position", "[", 
    RowBox[{
     RowBox[{"Amat", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.726593429688654*^9, 3.726593448529714*^9}, {
   3.726594385445133*^9, 3.726594401982792*^9}, 3.726594478803833*^9, {
   3.726594531828723*^9, 
   3.726594533154001*^9}},ExpressionUUID->"5a957d28-5230-474f-9993-\
9750e9cc5358"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DistMat", "[", "Amat_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"V", ",", "dM"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "computes", " ", "the", " ", "distances", " ", "between", " ", "each", 
       " ", "pair", " ", "of", " ", "nodes", " ", "given", " ", "input", " ", 
       "adjacency", " ", "matrix", " ", "using", " ", "the", " ", "Floyd"}], 
      "-", 
      RowBox[{"Warshall", " ", "algorithm"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"V", " ", "=", " ", 
      RowBox[{"Length", "[", "Amat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dM", " ", "=", " ", "Amat"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"i", "\[NotEqual]", "j"}], "&&", 
             RowBox[{
              RowBox[{"dM", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "0"}]}], 
            ")"}], ",", 
           RowBox[{
            RowBox[{"dM", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{"2", "V"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"j", ",", "V"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "V"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"dM", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], ">", 
                 RowBox[{
                  RowBox[{"dM", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "k"}], "]"}], "]"}], "+", 
                  RowBox[{"dM", "[", 
                   RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"dM", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{"dM", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "k"}], "]"}], "]"}], "+", 
                   RowBox[{"dM", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}]}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
             ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "V"}], "}"}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "V"}], "}"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "V"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "dM"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.685392162602635*^9, 3.685392269905305*^9}, {
   3.685392335817011*^9, 3.6853924319756413`*^9}, {3.68539247872554*^9, 
   3.685392510603447*^9}, 3.685392767747624*^9, {3.6853928246886387`*^9, 
   3.685392998056815*^9}, {3.685393056814299*^9, 3.6853930641334763`*^9}, {
   3.685393107181136*^9, 3.685393323016075*^9}, {3.685393381024494*^9, 
   3.685393381455413*^9}, {3.685393419194621*^9, 3.685393457303919*^9}, {
   3.685393602212191*^9, 3.68539367858607*^9}, {3.6853944289927197`*^9, 
   3.6853945034925833`*^9}, {3.68539455703478*^9, 3.68539460302417*^9}, {
   3.6853947227077827`*^9, 3.68539474716961*^9}, {3.685491822044704*^9, 
   3.685491822892323*^9}, 
   3.728942535913455*^9},ExpressionUUID->"701a4e23-0d2f-4a70-aaa7-\
69846e2e96f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sph", "[", 
   RowBox[{"Amat_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"k", ",", "outAmat", ",", "size", ",", "dropvec"}], "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{
     "Unit", " ", "sphere", " ", "in", " ", "a", " ", "graph", " ", "wih", 
      " ", "adjacency", " ", "matrix", " ", "Amat", " ", "at", " ", "vertex", 
      " ", "i"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"size", " ", "=", " ", 
      RowBox[{"Length", "[", "Amat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"size", "\[Equal]", "0"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dropvec", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k", "=", "1"}], ",", 
       RowBox[{"k", "<=", "size"}], ",", 
       RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Amat", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "k"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"dropvec", ",", "k"}], "]"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"outAmat", " ", "=", " ", 
      RowBox[{"DropOne", "[", 
       RowBox[{"Amat", ",", "dropvec", ",", "dropvec"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"MatrixForm", "[", "outAmat", "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"AdjacencyGraph", "[", 
         RowBox[{"outAmat", ",", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"90", ",", "90"}], "}"}]}]}], "]"}], "]"}], ";"}], "*)"}],
      "\[IndentingNewLine]", "outAmat"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.685285325830035*^9, 3.685285387756773*^9}, {
   3.685285535813295*^9, 3.685285586983132*^9}, {3.685286314692357*^9, 
   3.6852863896409197`*^9}, {3.685286422699766*^9, 3.685286438207039*^9}, {
   3.685287068228373*^9, 3.685287181360588*^9}, {3.6852872240292597`*^9, 
   3.685287277512341*^9}, {3.685287345730587*^9, 3.6852874684129143`*^9}, {
   3.685305221601124*^9, 3.685305222013961*^9}, {3.6853052522405787`*^9, 
   3.6853052749331093`*^9}, {3.685305343050672*^9, 3.685305354544889*^9}, {
   3.6853056661489973`*^9, 3.685305666443471*^9}, {3.685305837962905*^9, 
   3.6853058414475393`*^9}, 3.685305890285966*^9, {3.685309320651802*^9, 
   3.685309321002838*^9}, {3.685309920338996*^9, 3.6853099612497396`*^9}, {
   3.685310048616535*^9, 3.685310058555003*^9}, {3.685312909064024*^9, 
   3.685312911881714*^9}, {3.6853136793416853`*^9, 3.685313681674965*^9}, {
   3.6853139209181767`*^9, 3.68531392486784*^9}, {3.6853913565881243`*^9, 
   3.6853914029862432`*^9}, {3.68539189656698*^9, 3.685391923638309*^9}, 
   3.728940946955719*^9, {3.7289425554170218`*^9, 3.7289425557022142`*^9}, {
   3.7289485653601027`*^9, 
   3.72894857872125*^9}},ExpressionUUID->"421d7d02-c51e-4075-ad4b-\
b12d7d68e19c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sph", "[", 
   RowBox[{"Amat_", ",", "i_", ",", "r_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"V", ",", "dropvec", ",", "k", ",", "dm", ",", "outAmat"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Sphere", " ", "of", " ", "radius", " ", "r", " ", "in", " ", "a", " ", 
      "graph", " ", "wih", " ", "adjacency", " ", "matrix", " ", "Amat", " ", 
      "at", " ", "vertex", " ", "i"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"V", " ", "=", " ", 
      RowBox[{"Length", "[", "Amat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"V", "\[Equal]", "0"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dropvec", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dm", "=", 
      RowBox[{"DistMat", "[", "Amat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k", "=", "1"}], ",", 
       RowBox[{"k", "\[LessEqual]", "V"}], ",", 
       RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dm", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "k"}], "]"}], "]"}], "\[NotEqual]", "r"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"dropvec", ",", "k"}], "]"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"outAmat", " ", "=", " ", 
      RowBox[{"DropOne", "[", 
       RowBox[{"Amat", ",", "dropvec", ",", "dropvec"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"MatrixForm", "[", "outAmat", "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"AdjacencyGraph", "[", 
         RowBox[{"outAmat", ",", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"90", ",", "90"}], "}"}]}]}], "]"}], "]"}], ";"}], "*)"}],
      "\[IndentingNewLine]", "outAmat"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.685391352118799*^9, 3.68539142884873*^9}, {
   3.685391928105328*^9, 3.685391936438116*^9}, {3.6853948501594963`*^9, 
   3.6853948672216253`*^9}, {3.685394924116172*^9, 3.685394950343998*^9}, {
   3.685394993618593*^9, 3.685395025486086*^9}, {3.685491984805168*^9, 
   3.685491985579102*^9}, 3.728940958448009*^9, 3.7289425372626038`*^9, {
   3.728948613481269*^9, 3.728948625786697*^9}, {3.735489529841442*^9, 
   3.735489538976489*^9}, {3.735490715092039*^9, 
   3.735490716086649*^9}},ExpressionUUID->"0555a679-4012-4385-ab92-\
04f71cd59588"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KDim", "[", 
     RowBox[{"Amat_", ",", "i_", ",", "r_"}], "]"}], "/;", 
    RowBox[{
     RowBox[{
      RowBox[{"ArrayDepth", "[", "Amat", "]"}], ">", "1"}], "&&", 
     RowBox[{"IntegerQ", "[", "i", "]"}]}]}], ":=", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"Recursive", " ", "dimension", " ", 
     RowBox[{"(", 
      RowBox[{"as", " ", "defined", " ", "by", " ", "Oliver", " ", "Knill"}], 
      ")"}], " ", "of", " ", "vertex", " ", "i", " ", "of", " ", "graph", " ",
      "with", " ", "adjacency", " ", "matrix", " ", "Amat", " ", "for", " ", 
     "spheres", " ", "of", " ", "radius", " ", 
     RowBox[{"r", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"result", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"result", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "Amat", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "\[Equal]", "0"}], ",", 
        RowBox[{"result", " ", "=", " ", 
         RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"n", "\[Equal]", "1"}], ",", 
        RowBox[{"result", "=", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"n", ">", "1"}], ",", 
        RowBox[{"result", " ", "=", " ", 
         RowBox[{"1", "+", 
          RowBox[{"AvgKDim", "[", 
           RowBox[{"Sph", "[", 
            RowBox[{"Amat", ",", "i", ",", "r"}], "]"}], "]"}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "result"}]}],
     "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KDim", "[", 
    RowBox[{"Amat_", ",", "i_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"ArrayDepth", "[", "Amat", "]"}], ">", "1"}], "&&", 
    RowBox[{"IntegerQ", "[", "i", "]"}]}]}], ":=", 
  RowBox[{"(*", 
   RowBox[{"Recursive", " ", "dimension", " ", 
    RowBox[{"(", 
     RowBox[{"as", " ", "defined", " ", "by", " ", "Oliver", " ", "Knill"}], 
     ")"}], " ", "of", " ", "vertex", " ", "i", " ", "of", " ", "graph", " ", 
    "with", " ", "adjacency", " ", "matrix", " ", 
    RowBox[{"Amat", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"result", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"result", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "Amat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "0"}], ",", 
       RowBox[{"result", " ", "=", " ", 
        RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"n", "\[Equal]", "1"}], ",", 
       RowBox[{"result", "=", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"n", ">", "1"}], ",", 
       RowBox[{"result", " ", "=", " ", 
        RowBox[{"1", "+", 
         RowBox[{"AvgKDim", "[", 
          RowBox[{"Sph", "[", 
           RowBox[{"Amat", ",", "i"}], "]"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "result"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.685285271544243*^9, 3.6852853040246058`*^9}, {
   3.685285417215383*^9, 3.685285437659519*^9}, {3.685308664853153*^9, 
   3.685308773966372*^9}, {3.6853089657201853`*^9, 3.685308991750259*^9}, {
   3.685309068392283*^9, 3.685309074376618*^9}, {3.685309122092683*^9, 
   3.685309147778051*^9}, {3.685309259511801*^9, 3.685309259893763*^9}, {
   3.685309297813203*^9, 3.685309298068022*^9}, {3.685310293634656*^9, 
   3.685310294281191*^9}, {3.6853112386558723`*^9, 3.685311239418831*^9}, {
   3.6853113874089127`*^9, 3.6853113897450933`*^9}, {3.68531147101404*^9, 
   3.685311493869503*^9}, {3.685391938852721*^9, 3.685391941986809*^9}, {
   3.685491837835944*^9, 3.6854918761085873`*^9}, {3.685491992317643*^9, 
   3.6854919939390306`*^9}, {3.72894256295691*^9, 3.728942598633781*^9}, {
   3.728947853246628*^9, 3.728947878825068*^9}, {3.728948177373075*^9, 
   3.728948202000771*^9}, {3.728948811193858*^9, 3.72894882366119*^9}, {
   3.7289488632772293`*^9, 3.7289488644085207`*^9}, {3.728948997431429*^9, 
   3.7289489982111063`*^9}, {3.7289491076661997`*^9, 3.728949179731876*^9}, {
   3.728949247961714*^9, 3.728949269354426*^9}, {3.72894959540306*^9, 
   3.7289496051924467`*^9}, 3.735406799051293*^9, {3.735406860235361*^9, 
   3.7354068748919773`*^9}, 3.735410798669332*^9, {3.7354746316667337`*^9, 
   3.735474687498589*^9}, {3.7354895679571323`*^9, 3.735489574388097*^9}, 
   3.735490707001294*^9},ExpressionUUID->"bbc54fc8-5ea1-454f-bd6b-\
edc6b936a716"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AvgKDim", "[", 
     RowBox[{"Amat_", ",", "r_"}], "]"}], "/;", 
    RowBox[{"!", 
     RowBox[{"IntegerQ", "[", "Amat", "]"}]}]}], ":=", "\[IndentingNewLine]", 
   
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "dimension", " ", "of", " ", "graph", " ", "with", " ", "adjacency", " ",
       "matrix", " ", "Amat"}], ",", " ", 
     RowBox[{"for", " ", "spheres", " ", "of", " ", "radius", " ", "r"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "Amat", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "\[Equal]", "0"}], ",", " ", 
        RowBox[{"result", " ", "=", " ", 
         RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"IsKn", "[", "Amat", "]"}], "\[Equal]", "True"}], ",", 
        RowBox[{"result", " ", "=", " ", 
         RowBox[{"n", "-", "1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"n", "\[Equal]", "1"}], ",", 
        RowBox[{"result", "=", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"n", ">", "1"}], ",", 
        RowBox[{"result", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "n"}], ")"}], "*", 
          RowBox[{"Total", "[", 
           RowBox[{"KDims", "[", 
            RowBox[{"Amat", ",", "r"}], "]"}], "]"}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "result"}]}],
     "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AvgKDim", "[", "Amat_", "]"}], "/;", 
   RowBox[{"!", 
    RowBox[{"IntegerQ", "[", "Amat", "]"}]}]}], ":=", 
  RowBox[{"(*", 
   RowBox[{
   "dimension", " ", "of", " ", "graph", " ", "with", " ", "adjacency", " ", 
    "matrix", " ", 
    RowBox[{"Amat", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "Amat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "0"}], ",", " ", 
       RowBox[{"result", " ", "=", " ", 
        RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"IsKn", "[", "Amat", "]"}], "\[Equal]", "True"}], ",", 
       RowBox[{"result", " ", "=", " ", 
        RowBox[{"n", "-", "1"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"n", "\[Equal]", "1"}], ",", 
       RowBox[{"result", "=", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"n", ">", "1"}], ",", 
       RowBox[{"result", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1.0", "/", "n"}], ")"}], "*", 
         RowBox[{"Total", "[", 
          RowBox[{"KDims", "[", "Amat", "]"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "result"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6853112536126623`*^9, 3.685311362890376*^9}, {
   3.6853113980899143`*^9, 3.685311399945146*^9}, {3.685311478272537*^9, 
   3.68531148252597*^9}, {3.685314082897401*^9, 3.6853141064775047`*^9}, {
   3.685391943213709*^9, 3.685391946928835*^9}, {3.6854918830537567`*^9, 
   3.685491899484665*^9}, {3.685491999652752*^9, 3.685492001043195*^9}, {
   3.685495010209318*^9, 3.68549501412792*^9}, {3.685562587517499*^9, 
   3.68556258960319*^9}, 3.7289410473765993`*^9, {3.728942602938779*^9, 
   3.728942607058043*^9}, {3.728947657613257*^9, 3.728947661285101*^9}, {
   3.728948232341407*^9, 3.728948256080718*^9}, {3.72894833907125*^9, 
   3.728948394420203*^9}, {3.728948436376745*^9, 3.728948436779996*^9}, {
   3.728948498736232*^9, 3.72894852917024*^9}, {3.728948985853694*^9, 
   3.728948986749977*^9}, 3.728949236686652*^9, {3.728949301812265*^9, 
   3.728949317173863*^9}, {3.728949448819426*^9, 3.72894945181945*^9}, 
   3.728949487194729*^9, {3.7289496150744123`*^9, 3.7289496159003057`*^9}, 
   3.729010090001685*^9, {3.7290227841046867`*^9, 3.7290227905499496`*^9}, {
   3.729031155268293*^9, 3.7290311574062757`*^9}, {3.72904164748451*^9, 
   3.72904164798746*^9}, {3.729090265080501*^9, 3.729090288662305*^9}, {
   3.729450111023015*^9, 3.729450111678*^9}, {3.7354068813074512`*^9, 
   3.73540689099445*^9}, {3.735474717610075*^9, 3.735474741716049*^9}, {
   3.7354895871121693`*^9, 3.735489591562216*^9}, {3.7354906975248327`*^9, 
   3.7354906985165033`*^9}, {3.735503312869245*^9, 
   3.7355033130812683`*^9}},ExpressionUUID->"c1cf9ca0-ca17-4c5b-a7ee-\
7fa9908efd51"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"KDims", "[", 
    RowBox[{"Amat_", ",", "r_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"KDim", "[", 
      RowBox[{"Amat", ",", "i", ",", "r"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "Amat", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KDims", "[", "Amat_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"KDim", "[", 
     RowBox[{"Amat", ",", "i"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "Amat", "]"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.735474909015789*^9, 
  3.735474918575109*^9}},ExpressionUUID->"9b1a3835-81a9-4ef4-9599-\
944b792c6e7a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SDim", "[", 
    RowBox[{"Amat_", ",", "s_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"ArrayDepth", "[", "Amat", "]"}], ">", "1"}], "&&", 
    RowBox[{"IntegerQ", "[", "s", "]"}], "&&", 
    RowBox[{"s", ">", "1"}]}]}], ":=", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Spectral", " ", "dimension", " ", "for", " ", "all", " ", "nodes", " ", 
    "at", " ", "step", " ", "s"}], " ", "*)"}], 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n", ",", "AmatPows", ",", "Ps", ",", "avgP", ",", "totTable", ",", 
      "result"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "Amat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AmatPows", " ", "=", " ", 
      RowBox[{"MatrixPower", "[", 
       RowBox[{"Amat", ",", "s"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"totTable", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"AmatPows", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<AmatPows \>\"", ",", " ", 
         RowBox[{"AmatPows", "//", "MatrixForm"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", " ", 
        RowBox[{"\"\< totTable \>\"", ",", "totTable"}], "]"}], ";"}], "*)"}],
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Ps", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"totTable", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "==", "0"}], ",", "0", ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"AmatPows", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "i"}], "]"}], "]"}], "/", 
            RowBox[{"totTable", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"avgP", "=", 
      RowBox[{
       RowBox[{"Total", "[", "Ps", "]"}], "/", "n"}]}], ";", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"result", "=", 
      RowBox[{
       RowBox[{"-", "2.0"}], "*", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"avgP", "*", "1.0"}], "]"}], "/", 
        RowBox[{"Log", "[", 
         RowBox[{"s", "*", "1.0"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Ps \>\"", ",", "Ps", ",", " ", "\"\< avgP \>\"", ",", "avgP", 
         ",", " ", "\"\< result \>\"", ",", "result"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7354069085798388`*^9, 3.735406911578877*^9}, {
   3.735406945020296*^9, 3.735406982705492*^9}, {3.735407028020643*^9, 
   3.7354070765722313`*^9}, {3.73540711640907*^9, 3.735407243107547*^9}, 
   3.735407547894992*^9, {3.735407740770598*^9, 3.735407831350911*^9}, {
   3.735407969478423*^9, 3.73540799705205*^9}, {3.735409020686063*^9, 
   3.7354090653249083`*^9}, {3.735409098514058*^9, 3.735409335418269*^9}, {
   3.735410928345668*^9, 3.735410939125602*^9}, {3.735411143156608*^9, 
   3.7354111572402277`*^9}, {3.735411189530697*^9, 3.735411423128374*^9}, {
   3.735412008513331*^9, 3.7354120198634653`*^9}, {3.735412323649506*^9, 
   3.735412348335161*^9}, {3.735412730182063*^9, 3.735412733654807*^9}, {
   3.7354134854566383`*^9, 3.7354135355082073`*^9}, {3.7354136868543377`*^9, 
   3.7354137107423477`*^9}, {3.7354137550947227`*^9, 3.735413758841996*^9}, {
   3.735413842105884*^9, 3.735413888223094*^9}, {3.735413920332993*^9, 
   3.735413932820016*^9}, {3.73541397466685*^9, 3.735414004219719*^9}, {
   3.73541404571047*^9, 3.735414071044498*^9}, 3.735414136220274*^9, 
   3.735414194509316*^9, {3.735472745900598*^9, 3.735472788247636*^9}, {
   3.735472839268663*^9, 3.7354729929043427`*^9}, {3.7354899836434727`*^9, 
   3.7354899860916367`*^9}, {3.7354900425241117`*^9, 3.735490045218205*^9}, {
   3.735490127156083*^9, 3.735490134660933*^9}, {3.735490255929847*^9, 
   3.735490268941518*^9}, {3.735502945540934*^9, 
   3.7355029906200857`*^9}},ExpressionUUID->"9d17c6e1-da76-4bde-874d-\
3a89f0b6a7f5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GVolume", "[", 
    RowBox[{"Amat_", ",", "Dmat_", ",", "r_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Volume", " ", "of", " ", "the", " ", "ball", " ", "in", " ", "the", " ",
       "graph", " ", "with", " ", "adjacency", " ", "matrix", " ", "Amat"}], 
     ",", " ", 
     RowBox[{
     "where", " ", "the", " ", "distance", " ", "between", " ", "nodes", " ", 
      "is", " ", "given", " ", "by", " ", "Dmat"}], ",", " ", 
     RowBox[{
     "centered", " ", "at", " ", "node", " ", "i", " ", "and", " ", "having", 
      " ", "radius", " ", "r"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "inball"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "Amat", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"inball", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Dmat", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[LessEqual]", "r"}], 
           ",", "1", ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Total", "[", "inball", "]"}], "-", "1"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GVolume", "[", 
   RowBox[{"Amat_", ",", "r_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Volume", " ", "of", " ", "the", " ", "ball", " ", "in", " ", "the", " ", 
     "graph", " ", "with", " ", "adjacency", " ", "matrix", " ", "Amat"}], 
    ",", " ", 
    RowBox[{
    "centered", " ", "at", " ", "node", " ", "i", " ", "and", " ", "having", 
     " ", "radius", " ", "r"}]}], "*)"}], 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "dmat", ",", "inball"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "Amat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dmat", "=", 
      RowBox[{"DistMat", "[", "Amat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"inball", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dmat", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[LessEqual]", "r"}], 
          ",", "1", ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Total", "[", "inball", "]"}], "-", "1"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.735418136725124*^9, 3.735418252183557*^9}, {
   3.73541833741955*^9, 3.73541843096095*^9}, 3.7354184752171593`*^9, {
   3.735418548706379*^9, 3.735418555090736*^9}, {3.735418605028982*^9, 
   3.735418605133939*^9}, {3.7354732924398203`*^9, 3.735473293233569*^9}, {
   3.7354742902758617`*^9, 3.735474363812407*^9}, 
   3.73549749680497*^9},ExpressionUUID->"1e386301-87b8-49cf-ba6e-\
684e5b3a69d0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"HDim", "[", 
    RowBox[{"Amat_", ",", "Dmat_", ",", " ", "s_"}], " ", "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"ArrayDepth", "[", "Amat", "]"}], ">", "1"}], "&&", 
    RowBox[{"IntegerQ", "[", "s", "]"}], "&&", 
    RowBox[{"s", ">", "1"}]}]}], ":=", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Hausdorff", " ", "dimension", " ", "for", " ", "all", " ", "nodes", " ", 
    "at", " ", "step", " ", "s", " ", "when", " ", "the", " ", "distance", 
    " ", "between", " ", "nodes", " ", "is", " ", "given", " ", "by", " ", 
    "the", " ", "matrix", " ", "Dmat"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "vol", ",", "result"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "Amat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"vol", "=", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"GVolume", "[", 
            RowBox[{"Amat", ",", "Dmat", ",", "s", ",", "i"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "/", "n"}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"vol", "=", 
      RowBox[{"GVolume", "[", 
       RowBox[{"Amat", ",", "Dmat", ",", "s", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"vol", "*", "1.0"}], "]"}], "/", 
       RowBox[{"Log", "[", 
        RowBox[{"s", "*", "1.0"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "result"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HDim", "[", 
    RowBox[{"Amat_", ",", "s_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"ArrayDepth", "[", "Amat", "]"}], ">", "1"}], "&&", 
    RowBox[{"IntegerQ", "[", "s", "]"}], "&&", 
    RowBox[{"s", ">", "1"}]}]}], ":=", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Hausdorff", " ", "dimension", " ", "for", " ", "all", " ", "nodes", " ", 
    "at", " ", "step", " ", "s"}], " ", "*)"}], 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "vol", ",", "result"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "Amat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vol", "=", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"GVolume", "[", 
          RowBox[{"Amat", ",", "s", ",", "i"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "/", "n"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"vol", "*", "1.0"}], "]"}], "/", 
       RowBox[{"Log", "[", 
        RowBox[{"s", "*", "1.0"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "result"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.735417649191115*^9, 3.735417667121676*^9}, {
  3.735418094405015*^9, 3.73541811145719*^9}, {3.735418636330488*^9, 
  3.735418667912992*^9}, {3.735418737702017*^9, 3.735418738058413*^9}, {
  3.7354724274137487`*^9, 3.735472427685013*^9}, {3.735472460142425*^9, 
  3.735472504504434*^9}, {3.73547423305617*^9, 3.735474268921125*^9}, {
  3.735474303256081*^9, 3.735474308534274*^9}, {3.7354743773181868`*^9, 
  3.735474378136072*^9}, {3.735497718529128*^9, 3.7354977504888077`*^9}, {
  3.735503267365679*^9, 
  3.7355032822248173`*^9}},ExpressionUUID->"0268c160-0229-42c5-a901-\
fd3b6775c550"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ComponentCount", "[", "Amat_", "]"}], ":=", 
   RowBox[{"Length", "[", 
    RowBox[{"ConnectedComponents", "[", 
     RowBox[{"AdjacencyGraph", "[", "Amat", "]"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.696092186036847*^9, 3.696092215002187*^9}, {
  3.7289427323471212`*^9, 
  3.728942732953848*^9}},ExpressionUUID->"76bc2ecf-fe42-43c4-8080-\
7189f70d1978"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "Cliques", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cliques", "[", 
    RowBox[{"Amat_", ",", "cliqueSize_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"g", ",", "V", ",", "kcliques", ",", " ", "maxCliques"}], "}"}],
      ",", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Finds", " ", "all", " ", "subgraphs", " ", "that", " ", "are", " ", 
        "k"}], "-", 
       RowBox[{
       "dimensional", " ", "complete", " ", "subgraphs", " ", "or", " ", 
        RowBox[{"cliques", ".", " ", "It"}], " ", "uses", " ", 
        RowBox[{"Mathematica", "'"}], "s", " ", "FindClique", " ", "which", 
        " ", "finds", " ", "maximal", " ", "cliques", " ", "and", " ", 
        "takes", " ", "the", " ", "union", " ", "of", " ", "all", " ", 
        "subsets", " ", "of", " ", "the", " ", "maximal", " ", 
        RowBox[{"cliques", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"g", "=", 
       RowBox[{"AdjacencyGraph", "[", "Amat", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"maxCliques", " ", "=", " ", 
       RowBox[{"FindClique", "[", 
        RowBox[{"g", ",", "Infinity", ",", "All"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"kcliques", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Subsets", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", "cliqueSize", "}"}]}], "]"}], "&"}], ",", 
            "maxCliques"}], "]"}], ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Length", "[", "kcliques", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.725999755993422*^9, 3.725999924613496*^9}, {
   3.7259999664076157`*^9, 3.7260000611437674`*^9}, {3.72600011932831*^9, 
   3.726000139086905*^9}, 3.726070055594236*^9, {3.7260700890821247`*^9, 
   3.726070255554277*^9}, {3.72607044777094*^9, 3.7260704564965754`*^9}, {
   3.726071500747328*^9, 3.726071560140142*^9}, {3.726071736096753*^9, 
   3.72607176949717*^9}, {3.72607179957578*^9, 3.726071806130422*^9}, {
   3.726071984912179*^9, 3.726072030481831*^9}, {3.7278295358839407`*^9, 
   3.727829536146084*^9}, {3.729031324364636*^9, 3.729031343922147*^9}, {
   3.7290313759124317`*^9, 3.729031419257551*^9}, {3.729031755055675*^9, 
   3.729031758674261*^9}},ExpressionUUID->"9fd10063-6e64-4619-b82b-\
b48bf6d38f04"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"testg", "=", 
    RowBox[{
     RowBox[{"AdjacencyMatrix", "[", 
      RowBox[{"RandomGraph", "[", 
       RowBox[{"{", 
        RowBox[{"5", ",", "9"}], "}"}], "]"}], "]"}], "//", "Normal"}]}], ";",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AdjacencyGraph", "[", 
     RowBox[{"testg", ",", 
      RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}]}], "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Cliques", "[", 
     RowBox[{"testg", ",", "4"}], "]"}]}]}], "\[IndentingNewLine]", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7260702840837097`*^9, 3.726070465761545*^9}, {
  3.726071594700041*^9, 3.72607160479963*^9}, {3.726071701224719*^9, 
  3.7260717292901573`*^9}, {3.726071832228373*^9, 3.726071839833955*^9}, {
  3.726071885791604*^9, 3.726071886151208*^9}, {3.726071925682934*^9, 
  3.726071936149914*^9}, {3.726071972807845*^9, 3.726071973462747*^9}, {
  3.726072007818698*^9, 3.726072007874887*^9}, {3.726072059908579*^9, 
  3.726072069840947*^9}},ExpressionUUID->"8b725def-baa6-49eb-995b-\
941fedcc16cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CliquesKnill", "[", 
   RowBox[{"Amat_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Knill", " ", "code", " ", "for", " ", "number", " ", "of", " ", "k"}], 
    "-", 
    RowBox[{
    "dimensional", " ", "simplices", " ", "of", " ", "a", " ", "graph"}]}], 
   " ", "*)"}], 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "g", ",", "V", ",", "Vertices", ",", "n", ",", "m", ",", "s", ",", 
      "result", ",", "U"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"g", "=", 
      RowBox[{"AdjacencyGraph", "[", "Amat", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "Amat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Vertices", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"EdgeList", "[", 
        RowBox[{"AdjacencyGraph", "[", "Amat", "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"s", "=", 
      RowBox[{"Subsets", "[", 
       RowBox[{"Vertices", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "k"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"k", "\[Equal]", "1"}], ",", 
       RowBox[{"result", "=", "n"}], ",", "\[IndentingNewLine]", 
       RowBox[{"k", "\[Equal]", "2"}], ",", 
       RowBox[{"result", " ", "=", " ", "m"}], ",", "\[IndentingNewLine]", 
       RowBox[{"k", ">", "2"}], ",", " ", 
       RowBox[{"result", " ", "=", " ", 
        RowBox[{"Sum", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"EdgeList", "[", 
               RowBox[{"Subgraph", "[", 
                RowBox[{"g", ",", 
                 RowBox[{"s", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "]"}], 
             "\[Equal]", 
             RowBox[{"Binomial", "[", 
              RowBox[{"k", ",", "2"}], "]"}]}], "\[IndentingNewLine]", ",", 
            "1", ",", "0"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", "s", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.685396095002487*^9, 3.685396148698514*^9}, {
  3.6853962678096743`*^9, 3.685396486800006*^9}, {3.685397036032117*^9, 
  3.68539736238726*^9}, {3.685397412050091*^9, 3.68539743327379*^9}, {
  3.685397509000375*^9, 3.6853975183969297`*^9}, {3.685397668516114*^9, 
  3.685397673051732*^9}, {3.685397710868476*^9, 3.685397711859044*^9}, {
  3.685397873206506*^9, 3.6853978880836277`*^9}, {3.685397921269864*^9, 
  3.685397940330209*^9}, {3.725999749731594*^9, 
  3.725999750389386*^9}},ExpressionUUID->"d41c273f-58dd-4b3b-a1e3-\
e75ec27e0412"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EulerChi", "[", "Amat_", "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{"Euler", " ", "characteristic"}], "*)"}], 
   RowBox[{"Total", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"k", "-", "1"}], ")"}]}], 
       RowBox[{"Cliques", "[", 
        RowBox[{"Amat", ",", "k"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"Length", "[", "Amat", "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.685397713882185*^9, 3.685397820010895*^9}, {
  3.7290314570581303`*^9, 3.729031491666119*^9}, {3.729031528223598*^9, 
  3.729031534200189*^9}, {3.729031796266302*^9, 
  3.729031799911265*^9}},ExpressionUUID->"315a5bc5-fcab-46f4-957b-\
fcf79df3768d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EulerPChi", "[", "Amat_", "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Euler", " ", "characteristic", " ", "where", " ", "the", " ", "powers", 
      " ", "of", " ", "the"}], " ", "-", 
     RowBox[{"1", " ", "are", " ", "offset", " ", "by", " ", 
      RowBox[{"one", "."}]}]}], "*)"}], 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"k", "^", "2"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"k", "-", "1"}], ")"}]}], "*", 
      RowBox[{"Cliques", "[", 
       RowBox[{"Amat", ",", "k"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "[", "Amat", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.719419609038076*^9, 3.7194196420173903`*^9}, {
  3.719420535816002*^9, 3.719420553064093*^9}, {3.719420641615756*^9, 
  3.719420643478306*^9}, {3.7194206888904533`*^9, 3.719420689421508*^9}, {
  3.719939618070642*^9, 3.719939622798258*^9}, {3.719939688284563*^9, 
  3.719939695740411*^9}},ExpressionUUID->"09405d3e-6fca-435e-8c7f-\
c8b92c15f1a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "These", " ", "have", " ", "produced", " ", "uninteresting", " ", 
    "results"}], " ", "*)"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"SymChi", "[", "Amat_", "]"}], ":=", 
     RowBox[{"(*", 
      RowBox[{
      "Euler", " ", "characteristic", " ", "with", " ", "only", " ", "the", 
       " ", "even", " ", "sized", " ", "cliques"}], "*)"}], 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Cliques", "[", 
        RowBox[{"Amat", ",", 
         RowBox[{"2", "k"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Floor", "[", 
          RowBox[{
           RowBox[{"Length", "[", "Amat", "]"}], "/", "2"}], "]"}]}], "}"}]}],
       "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AntiSymChi", "[", "Amat_", "]"}], ":=", 
     RowBox[{"(*", 
      RowBox[{
      "Euler", " ", "characteristic", " ", "with", " ", "only", " ", "the", 
       " ", "odd", " ", "sized", " ", "cliques"}], "*)"}], 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Cliques", "[", 
        RowBox[{"Amat", ",", 
         RowBox[{
          RowBox[{"2", "k"}], "-", "1"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Ceiling", "[", 
          RowBox[{
           RowBox[{"Length", "[", "Amat", "]"}], "/", "2"}], "]"}]}], "}"}]}],
       "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TotChi", "[", "Amat_", "]"}], ":=", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Tot", " ", "characteristic", " ", "is", " ", "basically", " ", 
        "Euler", " ", "characteristic", " ", "with", " ", "all", " ", 
        "clique", " ", "numbers", " ", "added"}], ",", 
       RowBox[{"i", ".", "e", "."}], ",", " ", 
       RowBox[{"without", " ", "the", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"k", "-", "1"}], ")"}]}]}]}], "*)"}], 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Cliques", "[", 
        RowBox[{"Amat", ",", "k"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "[", "Amat", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.685397713882185*^9, 3.685397820010895*^9}, {
  3.719418538931933*^9, 3.71941856070256*^9}, {3.719418655114986*^9, 
  3.719418679899556*^9}, {3.719418759596036*^9, 3.719418774502276*^9}, {
  3.719419511837083*^9, 3.7194195148351192`*^9}, {3.719419559897273*^9, 
  3.7194195924828176`*^9}},ExpressionUUID->"be64badc-c39d-487e-a61b-\
a6fc33fe06ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LCurvature", "[", 
    RowBox[{"Amat_", ",", "i_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"ArrayDepth", "[", "Amat", "]"}], ">", "1"}], "&&", 
    RowBox[{"IntegerQ", "[", "i", "]"}]}]}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1", ",", "n", ",", "vs1", ",", "k", ",", "r", ",", "result"}], 
     "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{"Knill", " ", "curvature", " ", "at", " ", "a", " ", "vertex"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s1", "=", 
      RowBox[{"Sph", "[", 
       RowBox[{"Amat", ",", "i"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "s1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "^", "k"}], "/", 
         RowBox[{"(", 
          RowBox[{"k", "+", "1"}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Cliques", "[", 
         RowBox[{"s1", ",", "k"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"1", "+", 
       RowBox[{"result", ".", "r"}]}]}], ";", "\[IndentingNewLine]", 
     "result"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.685285439448195*^9, 3.685285465134056*^9}, {
   3.685316794681675*^9, 3.6853168555686893`*^9}, 3.6853919519788427`*^9, 
   3.685395451165743*^9, {3.6853955930211782`*^9, 3.685395593341267*^9}, {
   3.685397827091537*^9, 3.685397861730012*^9}, {3.6853980027420673`*^9, 
   3.6853980244204617`*^9}, {3.6853980660060062`*^9, 
   3.6853982588331223`*^9}, {3.685398592132354*^9, 3.685398592490349*^9}, {
   3.685398759078837*^9, 3.685398770078187*^9}, {3.68539880708735*^9, 
   3.685398813804287*^9}, 3.685398983979718*^9, {3.685399027545656*^9, 
   3.68539910264151*^9}, {3.685399249169982*^9, 3.685399255415718*^9}, {
   3.729031215969419*^9, 3.729031227726157*^9}, {3.7290315685245333`*^9, 
   3.729031599580275*^9}, {3.729031809859688*^9, 3.729031812261011*^9}, {
   3.729031899951429*^9, 3.729031902742641*^9}, {3.7294477262279377`*^9, 
   3.729447735538559*^9}, 3.7294480006750174`*^9, {3.729448238914003*^9, 
   3.72944824996133*^9}},ExpressionUUID->"a371f5b9-0c5e-4e4f-b0ca-\
510b50b62d93"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Curvatures", "[", "Amat_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "n", "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{
     "Knill", " ", "curvature", " ", "for", " ", "the", " ", "graph"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "Amat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"LCurvature", "[", 
        RowBox[{"Amat", ",", "k"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.685285467634906*^9, 3.685285480830269*^9}, {
   3.685316835401086*^9, 3.685316871856348*^9}, 3.6853919524500723`*^9, {
   3.6853978349889593`*^9, 3.685397837019404*^9}, {3.68539829397539*^9, 
   3.685398450660418*^9}, {3.6853984930443687`*^9, 3.685398501883107*^9}, {
   3.685398564147924*^9, 3.685398564506428*^9}, {3.6853987043348103`*^9, 
   3.685398717550023*^9}, {3.685398857552802*^9, 3.685398867307728*^9}, {
   3.685399005531288*^9, 3.685399009841436*^9}, {3.7290311989950314`*^9, 
   3.729031206912878*^9}, {3.729031817212654*^9, 3.729031820911832*^9}, 
   3.7295414868519087`*^9},ExpressionUUID->"0eced2c4-145e-40e3-aa6e-\
5cb3d74edf30"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GCurvature", "[", "Amat_", "]"}], ":=", 
  RowBox[{"Total", "[", 
   RowBox[{"Curvatures", "[", "Amat", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.685398455259366*^9, 3.6853984841869087`*^9}, {
  3.685398517275148*^9, 3.685398517338245*^9}, {3.729448265344252*^9, 
  3.7294482772397747`*^9}},ExpressionUUID->"f5558d8f-a7ac-4e2e-a65a-\
5e0d6764d5b5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "MinCycle", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MinCycle", "[", 
    RowBox[{"Amat_", ",", "v_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "n", ",", "m", ",", "vneighbors", ",", "paths", ",", "coveredEdges", 
       ",", "cycles", ",", "maxCycleLength", ",", "FindNextPaths", ",", 
       "FindCycles", ",", "result"}], "}"}], ",", " ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "The", " ", "length", " ", "of", " ", "the", " ", "minimum", " ", 
        "cycle", " ", "containing", " ", "node", " ", "i", " ", "of", " ", 
        "the", " ", "graph", " ", "with", " ", "adjacency", " ", "matrix", 
        " ", 
        RowBox[{"Amat", ".", " ", "If"}], " ", "there", " ", "is", " ", "no", 
        " ", "cycle", " ", "containing", " ", "i"}], ",", " ", 
       RowBox[{
       "the", " ", "result", " ", "will", " ", "be", " ", "infinity"}], ",", 
       " ", 
       RowBox[{
       "which", " ", "for", " ", "the", " ", "sake", " ", "of", " ", 
        "computation", " ", "is", " ", "given", " ", "here", " ", "to", " ", 
        "be", " ", 
        RowBox[{"10", "^", "50."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "Amat", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", " ", "=", " ", "\[Infinity]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Deg", "[", 
           RowBox[{"Amat", ",", "v"}], "]"}], "<", "2"}], ")"}], ",", 
        RowBox[{"Return", "[", "result", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"init", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{
               RowBox[{"Neighbors", "[", 
                RowBox[{"Amat", ",", "i"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"Neighbors", "[", 
               RowBox[{"Amat", ",", "i"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<init \>\"", ",", "init"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"maxCycleLength", " ", "=", " ", "n"}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
       "Max", " ", "cycle", " ", "length", " ", "is", " ", "the", " ", "the", 
        " ", "size", " ", "of", " ", "the", " ", "vertex", " ", "set"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"paths", " ", "=", " ", 
       RowBox[{"<|", 
        RowBox[{"1", "\[Rule]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{
               RowBox[{"Neighbors", "[", 
                RowBox[{"Amat", ",", "v"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"Neighbors", "[", 
               RowBox[{"Amat", ",", "v"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
        "|>"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"coveredEdges", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "n", "}"}], ",", 
         RowBox[{"{", "n", "}"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      
      RowBox[{"vneighbors", "=", 
       RowBox[{"Neighbors", "[", 
        RowBox[{"Amat", ",", "v"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"coveredEdges", "[", 
           RowBox[{"[", 
            RowBox[{"v", ",", 
             RowBox[{"vneighbors", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "=", "1"}], ";", 
         RowBox[{
          RowBox[{"coveredEdges", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"vneighbors", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", "v"}], "]"}], "]"}], "=", 
          "1"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "[", "vneighbors", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "to", " ", "keep", " ", "track", " ", "of", " ", "edges", " ", "that", 
        " ", "have", " ", "been", " ", "traveled", " ", "on"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FindNextPaths", "[", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "currnode", ",", "currPaths", ",", "numCurrSteps", ",", 
           "numCurrPaths", ",", "dest", ",", "nextDestinations", ",", " ", 
           "nextPaths", ",", " ", "numNextPaths"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Find", " ", "all", " ", "paths", " ", "of", " ", "one", " ", 
            "more", " ", "step"}], ",", " ", 
           RowBox[{"index", " ", "j"}]}], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"currPaths", " ", "=", " ", 
           RowBox[{"paths", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "currPaths", "]"}], "\[Equal]", "0"}], 
            ",", 
            RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"numCurrPaths", " ", "=", " ", 
           RowBox[{"Length", "[", "currPaths", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"numCurrSteps", " ", "=", " ", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"currPaths", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nextPaths", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "loop", " ", "though", " ", "paths", " ", "in", " ", 
              "currPaths"}], ",", " ", 
             RowBox[{"index", " ", "i"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"currnode", "=", 
              RowBox[{"currPaths", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"nextDestinations", " ", "=", " ", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Neighbors", "[", 
                RowBox[{"Amat", ",", "currnode"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"dest", "=", 
                 RowBox[{"nextDestinations", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"coveredEdges", "[", 
                    RowBox[{"[", 
                    RowBox[{"currnode", ",", "dest"}], "]"}], "]"}], 
                   "\[Equal]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"nextPaths", ",", 
                    RowBox[{"(", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"currPaths", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "dest"}], "]"}], 
                    ")"}]}], "]"}], ";", 
                   RowBox[{
                    RowBox[{"coveredEdges", "[", 
                    RowBox[{"[", 
                    RowBox[{"currnode", ",", "dest"}], "]"}], "]"}], "=", 
                    "1"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"coveredEdges", "[", 
                    RowBox[{"[", 
                    RowBox[{"dest", ",", "currnode"}], "]"}], "]"}], "=", 
                    "1"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", "nextDestinations", "]"}]}], "}"}]}], 
              "]"}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "numCurrPaths"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"paths", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"numCurrSteps", "+", "1"}], ")"}], "->", 
             "nextPaths"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FindCycles", "[", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "j", ",", "onecycle", ",", "cycleLengths", ",", "curr", ",", " ", 
           "Numcurr", ",", " ", "prev", ",", " ", "Numprev", ",", "end"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "paths", "]"}], "<", "2"}], ",", 
            RowBox[{"Return", "[", 
             RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"cycleLengths", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"curr", " ", "=", " ", 
           RowBox[{"paths", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Numcurr", " ", "=", " ", 
           RowBox[{"Length", "[", "curr", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"prev", " ", "=", " ", 
           RowBox[{"paths", "[", 
            RowBox[{"[", 
             RowBox[{"-", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Numprev", " ", "=", " ", 
           RowBox[{"Length", "[", "prev", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<curr \>\"", ",", "curr"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<prev \>\"", ",", "prev"}], "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"j", "=", "1"}], ";", "\[IndentingNewLine]", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{"j", "\[LessEqual]", "Numcurr"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<i \>\"", ",", "i", ",", "\"\< j \>\"", ",", "j"}], 
                  "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"curr", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], "\[Equal]", 
                    RowBox[{"prev", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ")"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"curr", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "\[Equal]", 
                    RowBox[{"prev", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], ")"}]}], ")"}], ",",
                   "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"Print", "[", "\"\<True\>\"", "]"}], ";"}], 
                   "*)"}], "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"curr", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], "]"}], "]"}], " ", ",", 
                    RowBox[{
                    RowBox[{"prev", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], "]"}], "]"}]}], "]"}], "\[Equal]", 
                    RowBox[{"{", "}"}]}], ")"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"onecycle", "=", 
                    RowBox[{
                    RowBox[{"2", 
                    RowBox[{"Length", "[", 
                    RowBox[{"curr", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "-", "3"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Found cycle of length \>\"", ",", "onecycle"}], 
                    "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"cycleLengths", ",", "onecycle"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Goto", "[", "end", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", "pruning", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<pruning prev\>\"", ",", "prev"}], "]"}], ";",
                     "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<pruning curr\>\"", ",", "curr"}], "]"}], 
                    ";"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"curr", " ", "=", " ", 
                    RowBox[{"DropOne", "[", 
                    RowBox[{"curr", ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Numcurr", "=", 
                    RowBox[{"Length", "[", "curr", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"paths", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "=", "curr"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"j", "-=", "1"}], ";"}]}], "\[IndentingNewLine]", 
                   "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"j", "++"}]}]}], "\[IndentingNewLine]", "]"}]}], ",", 
            
            RowBox[{"{", 
             RowBox[{"i", ",", "Numprev"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "cycleLengths", "]"}], "\[Equal]", "0"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Do", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Do", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"curr", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], "\[Equal]", 
                    RowBox[{"curr", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ")"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"curr", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "\[Equal]", 
                    RowBox[{"curr", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], ")"}]}], ")"}], ",",
                    "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"curr", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], "]"}], "]"}], " ", ",", 
                    RowBox[{
                    RowBox[{"curr", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], "]"}], "]"}]}], "]"}], "\[Equal]", 
                    RowBox[{"{", "}"}]}], ")"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"onecycle", "=", 
                    RowBox[{
                    RowBox[{"2", 
                    RowBox[{"Length", "[", 
                    RowBox[{"curr", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "-", "2"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"cycleLengths", ",", "onecycle"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Goto", "[", "end", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                  "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"j", "+", "1"}], ",", "Numcurr"}], "}"}]}], "]"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "Numcurr"}], "}"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Label", "[", "end", "]"}], ";", "\[IndentingNewLine]", 
          "cycleLengths"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"m", "=", "2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"cycles", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"m", "\[LessEqual]", "n"}], "&&", 
          RowBox[{
           RowBox[{"Length", "[", "cycles", "]"}], "\[Equal]", "0"}]}], ")"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"FindNextPaths", "[", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"cycles", " ", "=", " ", 
          RowBox[{"FindCycles", "[", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"m", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"Min", "[", "cycles", "]"}]}], ";", "\[IndentingNewLine]", 
      "result"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.725985058172117*^9, 3.72598520958197*^9}, {
   3.725985273291544*^9, 3.725985372658777*^9}, {3.726072139384342*^9, 
   3.726072206883103*^9}, {3.726526680496101*^9, 3.7265267199441*^9}, {
   3.726526773106598*^9, 3.726526995340633*^9}, {3.726527054306183*^9, 
   3.72652711837088*^9}, {3.726527231525324*^9, 3.726527254778607*^9}, {
   3.7265272879823837`*^9, 3.72652730466982*^9}, {3.72652739848656*^9, 
   3.726527475956542*^9}, {3.726527522782228*^9, 3.7265275515745153`*^9}, 
   3.7265276392932367`*^9, {3.7265276719917*^9, 3.726527771519315*^9}, {
   3.726593058775003*^9, 3.7265931569358187`*^9}, {3.7265932302620573`*^9, 
   3.7265933601747437`*^9}, {3.7265946064395027`*^9, 
   3.7265946774882812`*^9}, {3.726594771089554*^9, 3.72659478638063*^9}, {
   3.726594821487335*^9, 3.726594857650803*^9}, 3.7265949559543123`*^9, {
   3.726595388810137*^9, 3.726595389951331*^9}, {3.726595480271669*^9, 
   3.726595488145812*^9}, {3.726595522811119*^9, 3.726595739752934*^9}, {
   3.7265959392031307`*^9, 3.7265959404005547`*^9}, {3.726596060828475*^9, 
   3.7265960970155*^9}, {3.726596158389546*^9, 3.7265965049580917`*^9}, {
   3.7265967869524403`*^9, 3.726596791712284*^9}, 3.726596826321501*^9, {
   3.726598230377759*^9, 3.726598342897641*^9}, {3.726598583580462*^9, 
   3.726598593471403*^9}, {3.7265986422323837`*^9, 3.726598777713128*^9}, {
   3.726598842914164*^9, 3.72659891608154*^9}, {3.726598968432075*^9, 
   3.726599003732483*^9}, {3.726599218638248*^9, 3.726599254768517*^9}, {
   3.726599293036499*^9, 3.726599410354394*^9}, {3.726599499244586*^9, 
   3.7265995078740797`*^9}, {3.726599637290625*^9, 3.726599783776815*^9}, {
   3.7265998803074636`*^9, 3.726600135198453*^9}, {3.726600168120244*^9, 
   3.726600223808629*^9}, {3.726600289949113*^9, 3.7266002935177298`*^9}, {
   3.72660033080274*^9, 3.726600443859645*^9}, {3.726600478361971*^9, 
   3.726600680880652*^9}, {3.72660083712042*^9, 3.726601060937545*^9}, {
   3.7266016327141247`*^9, 3.726601734789168*^9}, {3.7266017688318644`*^9, 
   3.726601809501307*^9}, {3.7266020124311457`*^9, 3.726602063127149*^9}, {
   3.726602104288331*^9, 3.72660212049168*^9}, {3.726602163144967*^9, 
   3.726602266273628*^9}, 3.726602320539336*^9, {3.726602465885758*^9, 
   3.726602487287752*^9}, {3.726602636496291*^9, 3.726602771671801*^9}, {
   3.726602806406899*^9, 3.7266028205471773`*^9}, {3.7266029019879417`*^9, 
   3.7266029388238907`*^9}, {3.7266029851933813`*^9, 3.726603099550542*^9}, {
   3.7266031902821693`*^9, 3.726603204692676*^9}, {3.726603314338942*^9, 
   3.726603318904093*^9}, {3.726603357027431*^9, 3.7266033816424828`*^9}, {
   3.727182069731761*^9, 3.7271820761609*^9}, {3.72718218033985*^9, 
   3.7271822047734222`*^9}, {3.7271822403062468`*^9, 
   3.7271822978033447`*^9}, {3.727182335836874*^9, 3.7271823689514217`*^9}, {
   3.727182436892243*^9, 3.7271824878692617`*^9}, {3.727182579123405*^9, 
   3.727182647006832*^9}, {3.72718268118712*^9, 3.727182770149671*^9}, {
   3.7271828289246902`*^9, 3.727182831673196*^9}, {3.7271835151223307`*^9, 
   3.727183524423649*^9}, {3.7271836732788467`*^9, 3.727183717294002*^9}, {
   3.727183757230588*^9, 3.7271837872433863`*^9}, {3.727183918235263*^9, 
   3.727183933272921*^9}, {3.7271893496080427`*^9, 3.727189387363941*^9}, {
   3.7271894832948*^9, 3.727189619353795*^9}, {3.727189663172515*^9, 
   3.727189669220832*^9}, {3.727189716604066*^9, 3.7271897336508293`*^9}, {
   3.72718978515973*^9, 3.727189865976467*^9}, {3.727190029189389*^9, 
   3.727190108613058*^9}, {3.727190141218998*^9, 3.7271902296757727`*^9}, {
   3.7271903024737377`*^9, 3.727190340231069*^9}, {3.727190371763289*^9, 
   3.727190384702166*^9}, {3.72719042762394*^9, 3.727190549800733*^9}, {
   3.727190591424021*^9, 3.727190659845828*^9}, {3.727190757840597*^9, 
   3.727190758473777*^9}, {3.727190834187565*^9, 3.727191059338394*^9}, 
   3.727796960037692*^9, {3.727797127420785*^9, 3.727797138067987*^9}, {
   3.727797191088644*^9, 3.72779728770098*^9}, {3.727797321522839*^9, 
   3.727797342217968*^9}, {3.727797376188979*^9, 3.727797401968053*^9}, {
   3.727797454606208*^9, 3.727797535900792*^9}, {3.727797566741947*^9, 
   3.727797706590551*^9}, 3.7277977840056267`*^9, 3.727797902716034*^9, {
   3.727797937567556*^9, 3.727797976234096*^9}, 3.727798087350095*^9, {
   3.727798120043913*^9, 3.727798146965231*^9}, {3.727798184178068*^9, 
   3.727798200829947*^9}, {3.727798265048647*^9, 3.727798404531598*^9}, {
   3.727798445451787*^9, 3.7277984931690617`*^9}, {3.7277985407952423`*^9, 
   3.72779854110913*^9}, {3.727798595418612*^9, 3.727798652928932*^9}, {
   3.727798722988624*^9, 3.727798768613134*^9}, {3.7277988121166973`*^9, 
   3.727798812572751*^9}, {3.727798875349918*^9, 3.727798898652034*^9}, {
   3.727799193703788*^9, 3.727799316906612*^9}, {3.727799550370034*^9, 
   3.727799575803319*^9}, {3.7277996175255833`*^9, 3.727799711490102*^9}, {
   3.727799746379945*^9, 3.7277997505895844`*^9}, {3.727799803546414*^9, 
   3.7277999457219143`*^9}, {3.727799997195858*^9, 3.727800063399579*^9}, {
   3.727800127776997*^9, 3.727800149209062*^9}, {3.727805064110168*^9, 
   3.7278051053154917`*^9}, {3.727805191893384*^9, 3.727805323404633*^9}, {
   3.727805420222744*^9, 3.72780543004368*^9}, {3.727805462962586*^9, 
   3.727805477956839*^9}, {3.727805553215343*^9, 3.7278055893688993`*^9}, {
   3.7278056246360607`*^9, 3.7278056286786327`*^9}, {3.727805677017082*^9, 
   3.727805681639501*^9}, {3.727805807327938*^9, 3.7278058136567698`*^9}, {
   3.727805883424861*^9, 3.727805909322526*^9}, {3.7278059838344917`*^9, 
   3.727805992589055*^9}, 3.727806088743129*^9, {3.727806123833376*^9, 
   3.727806337670141*^9}, {3.7278064462183723`*^9, 3.727806495426952*^9}, {
   3.7278065625193996`*^9, 3.7278065696682997`*^9}, {3.727806638936245*^9, 
   3.7278066426989193`*^9}, {3.727806777272689*^9, 3.727806788866992*^9}, {
   3.7278068482147512`*^9, 3.727806878177739*^9}, {3.727806931015547*^9, 
   3.727806943992857*^9}, {3.727806974018417*^9, 3.727806991555626*^9}, {
   3.72780703872296*^9, 3.727807061888811*^9}, {3.727807184204348*^9, 
   3.72780726230483*^9}, {3.727807376429347*^9, 3.727807394226901*^9}, {
   3.727807506267457*^9, 3.727807518874793*^9}, {3.7278076321616173`*^9, 
   3.7278076813373404`*^9}, {3.727807734050819*^9, 3.727807747528865*^9}, {
   3.727807904955709*^9, 3.727808017987794*^9}, {3.7278080501180887`*^9, 
   3.72780805156102*^9}, {3.72780809519244*^9, 3.727808115837263*^9}, {
   3.727808255871808*^9, 3.727808268256185*^9}, {3.7278083311288652`*^9, 
   3.727808348184518*^9}, {3.727808537556349*^9, 3.72780858182449*^9}, {
   3.727808640781337*^9, 3.7278086840461597`*^9}, {3.727808829467244*^9, 
   3.727808971853607*^9}, {3.727809097337126*^9, 3.727809144344062*^9}, {
   3.727809224928217*^9, 3.72780923917844*^9}, {3.727809366768404*^9, 
   3.727809381425568*^9}, {3.727809497291287*^9, 3.7278095035362988`*^9}, {
   3.72780956528253*^9, 3.7278096234974537`*^9}, {3.72780980866343*^9, 
   3.727809926499487*^9}, 3.727810652296097*^9, {3.727811165599798*^9, 
   3.727811314441371*^9}, {3.727817212139327*^9, 3.7278172462864647`*^9}, {
   3.7278173301777773`*^9, 3.7278173440854893`*^9}, {3.727817553330488*^9, 
   3.7278175665778933`*^9}, {3.727817715227172*^9, 3.727817738981017*^9}, {
   3.727817909372018*^9, 3.727817933665183*^9}, {3.7278184492381067`*^9, 
   3.7278185294749413`*^9}, {3.727818666735786*^9, 3.727818680609668*^9}, {
   3.72781900678594*^9, 3.7278190093401623`*^9}, {3.7278192585977087`*^9, 
   3.727819267262285*^9}, {3.727819391058489*^9, 3.727819402262014*^9}, {
   3.72781992016576*^9, 3.727819920492663*^9}, {3.7278199859124537`*^9, 
   3.7278200141673403`*^9}, {3.7278201940056868`*^9, 3.727820256053203*^9}, {
   3.727820292632749*^9, 3.727820339642727*^9}, {3.7278205454555902`*^9, 
   3.72782054892128*^9}, {3.727820603584916*^9, 3.727820644271166*^9}, {
   3.727820737057247*^9, 3.7278207376366673`*^9}, {3.727820935252166*^9, 
   3.727820936519012*^9}, 3.727821414388495*^9, {3.7278215213071423`*^9, 
   3.727821537940565*^9}, {3.727821715438715*^9, 3.727821718334937*^9}, {
   3.727821872573579*^9, 3.727821904454698*^9}, 3.7278219556453047`*^9, {
   3.727822105875471*^9, 3.727822109775731*^9}, {3.727822260199294*^9, 
   3.727822297932828*^9}, {3.727822386955575*^9, 3.727822416684849*^9}, {
   3.727822534961212*^9, 3.7278226455077667`*^9}, {3.7278227639622517`*^9, 
   3.7278227677308483`*^9}, 3.727822825955412*^9, 3.727822872547839*^9, {
   3.727823009032835*^9, 3.727823054054175*^9}, {3.727823105089321*^9, 
   3.727823115895103*^9}, {3.727823237276361*^9, 3.727823252645628*^9}, {
   3.727823297219007*^9, 3.7278233195794*^9}, {3.727823356113267*^9, 
   3.7278233804861193`*^9}, {3.72782342314209*^9, 3.7278234438799334`*^9}, {
   3.72782347470573*^9, 3.727823475192521*^9}, 3.727823939849465*^9, {
   3.727823999739009*^9, 3.727824008509857*^9}, {3.727824086586623*^9, 
   3.727824092918311*^9}, {3.7278241723658323`*^9, 3.7278241810688257`*^9}, {
   3.727824255990047*^9, 3.727824386055626*^9}, {3.727824825025023*^9, 
   3.727824829122732*^9}, {3.7278249742584743`*^9, 3.727824988579281*^9}, {
   3.727825129124487*^9, 3.727825156513036*^9}, {3.727825300868265*^9, 
   3.727825303428154*^9}, {3.727825551246209*^9, 3.727825557492231*^9}, {
   3.7278257738180857`*^9, 3.727825784811488*^9}, {3.727825827839456*^9, 
   3.7278258412269983`*^9}, {3.7278259220102453`*^9, 3.72782596618568*^9}, {
   3.7278264756197853`*^9, 3.727826504568074*^9}, {3.727826835177104*^9, 
   3.7278268378972063`*^9}, {3.727827127817314*^9, 3.727827133782249*^9}, {
   3.7278274484619293`*^9, 3.727827452197204*^9}, {3.727827536626651*^9, 
   3.727827564984106*^9}, {3.7278276828612013`*^9, 3.727827703275086*^9}, 
   3.728940963247608*^9, {3.728947738779801*^9, 
   3.728947739101424*^9}},ExpressionUUID->"e8a8b94c-9f48-4904-8771-\
ba0484882c15"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Hamiltonians", "Subsubsection",
 CellChangeTimes->{{3.6852852412431593`*^9, 
  3.685285243194044*^9}},ExpressionUUID->"41fd9711-353a-4ea2-9d91-\
38daaa159a97"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"H0", ",", "H1", ",", "H2", ",", "H3", ",", "Hsource"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.686183733182925*^9, 
  3.686183744629346*^9}},ExpressionUUID->"f87175b2-9c24-4214-8e16-\
e00adb79d789"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Ttr", "[", "mat_", "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{"Ttr", " ", "=", " ", 
     RowBox[{
      RowBox[{"Total", " ", "trace"}], " ", "=", " ", 
      RowBox[{"sum_", 
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], "mat_", 
       RowBox[{"{", "ij", "}"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "rowsum"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "mat", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rowsum", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"mat", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Total", "[", "rowsum", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",ExpressionUUID->"2be8caa7-4c7e-4b4c-b6bb-\
dd84ecdc6fcb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TtrSq", "[", "mat_", "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{"TtrSq", " ", "=", " ", 
     RowBox[{
      RowBox[{"Total", " ", "tracesquared"}], " ", "=", " ", 
      RowBox[{"sum_", 
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], 
       RowBox[{"(", 
        RowBox[{"mat", "^", "2"}], ")"}], "_", 
       RowBox[{"{", "ij", "}"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "matsq", ",", "rowsum"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "mat", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"matsq", " ", "=", " ", 
       RowBox[{"mat", ".", "mat"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rowsum", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"matsq", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Total", "[", "rowsum", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.685401241541493*^9, 3.685401291627575*^9}, {
  3.685401357540058*^9, 
  3.685401374682599*^9}},ExpressionUUID->"0707e08d-ba95-4ac4-b163-\
3ffb31f87bdd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Offtr", "[", "mat_", "]"}], ":=", 
  RowBox[{"(*", 
   RowBox[{"Offtr", " ", "=", " ", 
    RowBox[{
     RowBox[{"Off", "-", 
      RowBox[{"diagonal", " ", "trace"}]}], " ", "=", " ", 
     RowBox[{"sum_", 
      RowBox[{"{", 
       RowBox[{"i", "!=", "j"}], "}"}], "Am_", 
      RowBox[{"{", "ij", "}"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "rowsum", ",", "diag"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "mat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rowsum", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"mat", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"diag", " ", "=", " ", 
      RowBox[{"Diagonal", "[", "mat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Total", "[", 
      RowBox[{"rowsum", "-", "diag"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6853997267508373`*^9, 3.6853997914278307`*^9}, {
  3.685399877850698*^9, 3.685399907855665*^9}, {3.685399938402515*^9, 
  3.685399943802404*^9}, {3.685400157201934*^9, 3.685400192850019*^9}, {
  3.685400285052659*^9, 3.685400308330763*^9}, {3.68540035012525*^9, 
  3.6854003867935257`*^9}, {3.685400629813126*^9, 3.685400641571528*^9}, {
  3.685400698125841*^9, 3.685400717754389*^9}, {3.685401028126594*^9, 
  3.685401029652122*^9}},ExpressionUUID->"e56be043-7125-4431-8a6f-\
ce020ddac8fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OfftrSq", "[", "mat_", "]"}], ":=", 
  RowBox[{"(*", 
   RowBox[{"Offtr", " ", "=", " ", 
    RowBox[{
     RowBox[{"Off", "-", 
      RowBox[{"diagonal", " ", "tracesquared"}]}], " ", "=", " ", 
     RowBox[{"sum_", 
      RowBox[{"{", 
       RowBox[{"i", "!=", "j"}], "}"}], 
      RowBox[{"(", 
       RowBox[{"mat", "^", "2"}], ")"}], "_", 
      RowBox[{"{", "ij", "}"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "matsq", ",", "rowsum", ",", "diag"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "mat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"matsq", "=", 
      RowBox[{"mat", ".", "mat"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rowsum", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"matsq", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"diag", " ", "=", " ", 
      RowBox[{"Diagonal", "[", "matsq", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Total", "[", 
      RowBox[{"rowsum", "-", "diag"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6854013085487137`*^9, 3.6854013304189243`*^9}, {
  3.685401384082748*^9, 
  3.685401403050486*^9}},ExpressionUUID->"8dc346ff-ce0e-4612-8f86-\
584e34bf0b6e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"H0", ",", "Hsource", ",", "H0Tot"}], "]"}], ";"}]], "Input",Expres\
sionUUID->"d759f49e-39a3-4612-98c2-cf739179b169"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"H0", "[", 
     RowBox[{"Am_", ",", "J_"}], "]"}], ":=", 
    RowBox[{"(*", 
     RowBox[{"H0", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"J", "/", "2"}], "N"}], ")"}], "sum_", 
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"di", "-", "dj"}], ")"}], "^", "2"}]}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "dvec", ",", "d2vec"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{
         RowBox[{"Length", "[", "Am", "]"}], "*", "1.0"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dvec", "=", 
        RowBox[{"Valencyvec", "[", "Am", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"d2vec", "=", 
        RowBox[{"dvec", ".", "dvec"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"J", 
        RowBox[{"(", 
         RowBox[{"d2vec", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1.0", "/", "n"}], ")"}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Total", "[", "dvec", "]"}], ")"}], "^", "2"}]}]}], 
         ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Dl", "[", "Amat_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "vmat", ",", "Dmat"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "Amat", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vmat", "=", 
        RowBox[{"Valencymat", "[", "Amat", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Dmat", "=", 
        RowBox[{
         RowBox[{"MakeRegAij", "[", 
          RowBox[{
           RowBox[{"n", "-", "1"}], ",", "n"}], "]"}], "+", 
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"1", "-", "n"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}], 
        RowBox[{"Tr", "[", 
         RowBox[{"vmat", ".", "Dmat", ".", "vmat"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"H1", "[", 
     RowBox[{"Am_", ",", "J_"}], "]"}], ":=", 
    RowBox[{"(*", 
     RowBox[{"H1", " ", "=", " ", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", "sum_", 
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"di", "-", "dj"}], ")"}], "^", "2"}], "A_", 
       RowBox[{"{", "ij", "}"}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"del", ",", "dvec", ",", "vmat"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dvec", "=", 
        RowBox[{"Valencyvec", "[", "Am", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"vmat", "=", 
        RowBox[{"DiagonalMatrix", "[", "dvec", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"del", "=", 
        RowBox[{"Am", "-", "vmat"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "J"}], "/", "2"}], "*", 
        RowBox[{"(", 
         RowBox[{"dvec", ".", "del", ".", "dvec"}], ")"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"H2", "[", 
     RowBox[{"Am_", ",", "J_"}], "]"}], ":=", 
    RowBox[{"(*", 
     RowBox[{"H2", " ", "=", " ", 
      RowBox[{"sum_", 
       RowBox[{"{", 
        RowBox[{"i", ",", "j", ",", "k"}], "}"}], "A_", 
       RowBox[{"{", "ij", "}"}], "A_", 
       RowBox[{"{", 
        RowBox[{"j", ",", "k"}], "}"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "-", 
          RowBox[{"sum_", 
           RowBox[{"{", "l", "}"}], "A_", 
           RowBox[{"{", "il", "}"}], "A_", 
           RowBox[{"{", "lk", "}"}]}]}], ")"}], "^", "2"}]}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "size", ",", "Amsq", ",", "Amp2", ",", "mat4", ",", " ", "Amp4", ",", 
        "mat6", ",", "Amp6"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"size", "=", 
        RowBox[{"Length", "[", "Am", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Amsq", "=", 
        RowBox[{"Am", ".", "Am"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Amp2", "=", 
        RowBox[{"Ttr", "[", "Amsq", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mat4", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Amsq", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "^", "2"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "size"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "size"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Amp4", "=", 
        RowBox[{"Ttr", "[", "mat4", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mat6", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Amsq", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "^", "3"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "size"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "size"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Amp6", "=", 
        RowBox[{"Ttr", "[", "mat6", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"MatrixForm", "[", 
            RowBox[{"4", "*", "Amsq"}], "]"}], ",", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{"4", "*", "mat4"}], "]"}], ",", 
           RowBox[{"MatrixForm", "[", "mat6", "]"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"J", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", "*", "Amp2"}], "-", 
          RowBox[{"4", "*", "Amp4"}], "+", "Amp6"}], ")"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"H3", "[", 
     RowBox[{"Am_", ",", "J_", ",", "h_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vmat", ",", "hmat", ",", "size", ",", "diff"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"size", "=", 
        RowBox[{"Length", "[", "Am", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vmat", "=", 
        RowBox[{"Valencymat", "[", "Am", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"hmat", " ", "=", " ", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"Table", "[", 
          RowBox[{"h", ",", "size"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"diff", "=", 
        RowBox[{"vmat", "-", "hmat"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"J", " ", 
        RowBox[{"Tr", "[", 
         RowBox[{"diff", ".", "diff"}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Hsource", "[", 
     RowBox[{"Am_", ",", "L_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "dvec", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dvec", " ", "=", " ", 
        RowBox[{"Valencyvec", "[", "Am", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"L", "*", 
        RowBox[{"Total", "[", "dvec", "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"H0Tot", "[", 
     RowBox[{"Am_", ",", "J_", ",", "L_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"H0", "[", 
        RowBox[{"Am", ",", "J"}], "]"}], "+", 
       RowBox[{"Hsource", "[", 
        RowBox[{"Am", ",", "L"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"H1Tot", "[", 
     RowBox[{"Am_", ",", "J_", ",", "L_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"H1", "[", 
        RowBox[{"Am", ",", "J"}], "]"}], "+", 
       RowBox[{"Hsource", "[", 
        RowBox[{"Am", ",", "L"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"H03", "[", 
     RowBox[{"Am_", ",", "J0_", ",", "J3_", ",", "h_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"H0", "[", 
        RowBox[{"Am", ",", "J0"}], "]"}], "+", 
       RowBox[{"H3", "[", 
        RowBox[{"Am", ",", "J3", ",", "h"}], "]"}]}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H13", "[", 
    RowBox[{"Am_", ",", "J1_", ",", "J3_", ",", "h_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"H1", "[", 
       RowBox[{"Am", ",", "J1"}], "]"}], "+", 
      RowBox[{"H3", "[", 
       RowBox[{"Am", ",", "J3", ",", "h"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.68244117269153*^9, 3.682441333623021*^9}, {
   3.682441402847156*^9, 3.682441429636497*^9}, {3.682441713224805*^9, 
   3.6824417574539833`*^9}, {3.682441904402019*^9, 3.682441970653397*^9}, {
   3.682448055422387*^9, 3.682448079468656*^9}, {3.68244812305724*^9, 
   3.682448126352195*^9}, {3.682448190470563*^9, 3.68244820000128*^9}, {
   3.682448242838901*^9, 3.682448365835534*^9}, {3.682448472762855*^9, 
   3.6824485197141438`*^9}, 3.6824485885283747`*^9, {3.682448623152047*^9, 
   3.682448623454833*^9}, {3.68244919396795*^9, 3.682449233487343*^9}, {
   3.6824493329586687`*^9, 3.6824493399901447`*^9}, {3.682449381537567*^9, 
   3.682449404856249*^9}, {3.6828059851017714`*^9, 3.682805988236994*^9}, {
   3.682963273837276*^9, 3.682963291678575*^9}, {3.682963380491969*^9, 
   3.682963426427503*^9}, {3.6829634834178047`*^9, 3.6829634976383533`*^9}, {
   3.682963705001992*^9, 3.682963724695826*^9}, {3.682963923096404*^9, 
   3.6829639436430817`*^9}, {3.682964566406363*^9, 3.682964569039167*^9}, {
   3.682964717845229*^9, 3.682964724734523*^9}, {3.6829651020622*^9, 
   3.682965107045863*^9}, {3.682965552632104*^9, 3.68296562742736*^9}, {
   3.68296566445043*^9, 3.682965700633444*^9}, {3.6829658685505533`*^9, 
   3.682965877817296*^9}, {3.68296633071307*^9, 3.682966439861768*^9}, {
   3.682966792346384*^9, 3.682966834274192*^9}, {3.682967454196859*^9, 
   3.682967473354712*^9}, {3.682967595124259*^9, 3.682967665598791*^9}, {
   3.682968658692377*^9, 3.682968755319017*^9}, {3.682969053329329*^9, 
   3.682969071995675*^9}, {3.682969117485826*^9, 3.6829691661685658`*^9}, {
   3.6829692168491983`*^9, 3.682969240699669*^9}, {3.682969487966555*^9, 
   3.682969575791896*^9}, 3.6829696088259993`*^9, 3.682969666682803*^9, {
   3.6829698190067577`*^9, 3.682969849146255*^9}, {3.682970004501849*^9, 
   3.6829700364154053`*^9}, {3.682970088354322*^9, 3.682970115140873*^9}, {
   3.682970189709928*^9, 3.6829702265431213`*^9}, {3.682970282762166*^9, 
   3.6829703194564447`*^9}, {3.682971166399961*^9, 3.6829712049099007`*^9}, {
   3.682971240597621*^9, 3.682971301352787*^9}, {3.682971436381394*^9, 
   3.6829714519003468`*^9}, {3.683129358525508*^9, 3.6831293641657553`*^9}, {
   3.683129404157477*^9, 3.6831294224304523`*^9}, {3.685491634998296*^9, 
   3.685491652369053*^9}, {3.685492019023652*^9, 3.685492027695908*^9}, {
   3.6861772539673977`*^9, 3.686177256502378*^9}, {3.6861772974047003`*^9, 
   3.686177308860181*^9}, {3.686177346772682*^9, 3.686177465345649*^9}, {
   3.6861783946813793`*^9, 3.6861785594319477`*^9}, {3.686183587086577*^9, 
   3.6861836567148857`*^9}, {3.686183774843089*^9, 3.6861837756609383`*^9}, {
   3.686188625760828*^9, 3.686188661203019*^9}, {3.686190339281826*^9, 
   3.686190453221527*^9}, {3.686276386656827*^9, 3.686276393219389*^9}, {
   3.688845633627104*^9, 3.6888456806467752`*^9}, 3.7289424716925507`*^9, {
   3.72894277317841*^9, 3.72894277552064*^9}, {3.729029976393852*^9, 
   3.729030035277665*^9}, {3.729030338787714*^9, 3.729030339323765*^9}, {
   3.729030392982073*^9, 3.729030425072905*^9}, {3.729030472174325*^9, 
   3.729030485368918*^9}, {3.729030537598565*^9, 3.729030668257906*^9}, {
   3.729036464280196*^9, 3.729036514349221*^9}, {3.729037395515177*^9, 
   3.729037404722343*^9}, {3.72903757878153*^9, 3.729037598708894*^9}, {
   3.729037962919374*^9, 3.7290379750613194`*^9}, {3.729038024892757*^9, 
   3.729038042499008*^9}, {3.7290933161787863`*^9, 3.7290933250092173`*^9}, {
   3.729093846562668*^9, 
   3.729093858896613*^9}},ExpressionUUID->"2ae8c5de-c577-4e55-a005-\
e9be6e8515a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"HEuler", "[", 
    RowBox[{"Am_", ",", "J_"}], "]"}], ":=", 
   RowBox[{"J", "*", 
    RowBox[{"GCurvature", "[", "Am", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.686410175183127*^9, 3.686410197038262*^9}, {
   3.696044013174066*^9, 3.696044015789918*^9}, {3.696222281904539*^9, 
   3.696222284454731*^9}, {3.696226394630395*^9, 3.696226397347438*^9}, 
   3.729541551503481*^9},ExpressionUUID->"f6ba3170-4d26-4fff-bef3-\
9d42e2c1f05b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "HEulerWs", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HEulerWS", "[", 
    RowBox[{"Am_", ",", "JEu_", ",", "L_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"JEu", "*", 
     RowBox[{"EulerChi", "[", "Am", "]"}]}], "+", 
    RowBox[{"Hsource", "[", 
     RowBox[{"Am", ",", "L"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.729030687940888*^9, 3.729030703882873*^9}, {
  3.730042966538978*^9, 3.730042984128345*^9}, {3.7300430653500032`*^9, 
  3.7300430721732063`*^9}},ExpressionUUID->"25c2f357-1a32-4544-a390-\
27351e2ce094"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"H0Euler", "[", 
    RowBox[{"Am_", ",", "J0_", ",", "JEu_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"H0", "[", 
     RowBox[{"Am", ",", "J0"}], "]"}], "+", 
    RowBox[{"HEuler", "[", 
     RowBox[{"Am", ",", "JEu"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.686410215674849*^9, 3.6864102792907457`*^9}, 
   3.696044024800404*^9, 3.696222292170212*^9, 
   3.696226306042966*^9},ExpressionUUID->"fc2898e9-a10f-4e3c-94ef-\
0460b82ddc14"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"H1Euler", "[", 
    RowBox[{"Am_", ",", "J1_", ",", "JEu_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"H1", "[", 
     RowBox[{"Am", ",", "J1"}], "]"}], "+", 
    RowBox[{"HEuler", "[", 
     RowBox[{"Am", ",", "JEu"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68641598129148*^9, 3.686415989235283*^9}, {
   3.686416041282918*^9, 3.686416041347375*^9}, 3.6960440267840643`*^9, 
   3.696222293464196*^9, 
   3.696226307771552*^9},ExpressionUUID->"f20cfcb0-85ff-42ad-ba7f-\
06d7f88c1b81"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"H3Euler", "[", 
    RowBox[{"Am_", ",", "J3_", ",", "h_", ",", "JEu_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"H3", "[", 
     RowBox[{"Am", ",", "J3", ",", "h"}], "]"}], "+", 
    RowBox[{"HEuler", "[", 
     RowBox[{"Am", ",", "JEu"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.686416001292935*^9, 3.6864160365388803`*^9}, 
   3.696044028256859*^9, {3.696219745932748*^9, 3.696219749854843*^9}, 
   3.696222294818303*^9, 3.69622630977887*^9, {3.696227900829928*^9, 
   3.696227905393827*^9}},ExpressionUUID->"2c8aac58-6cbd-4232-bdc0-\
373480b5c1d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"H03Euler", "[", 
    RowBox[{"Am_", ",", "J0_", ",", "J3_", ",", "h_", ",", "JEu_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"H0", "[", 
     RowBox[{"Am", ",", "J0"}], "]"}], "+", 
    RowBox[{"H3", "[", 
     RowBox[{"Am", ",", "J3", ",", "h"}], "]"}], "+", 
    RowBox[{"HEuler", "[", 
     RowBox[{"Am", ",", "JEu"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.696227909585832*^9, 
  3.696227936169013*^9}},ExpressionUUID->"52b9a144-4141-41e6-836b-\
8314cb078e37"],

Cell[BoxData[
 RowBox[{"(*", " ", "TRIALS", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.719419007191514*^9, 3.719419043717515*^9}, {
  3.7194196579721537`*^9, 3.719419725496448*^9}, {3.719948014527287*^9, 
  3.7199480257361307`*^9}},ExpressionUUID->"a3ae2e98-5573-42d9-a467-\
335561484a41"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"HDelLocalCurvature", "[", 
    RowBox[{"Am_", ",", " ", "c_", ",", "J_"}], "]"}], ":=", 
   RowBox[{"J", "*", 
    RowBox[{"Total", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Curvatures", "[", "Am", "]"}], "-", "c"}], ")"}], "^", "2"}],
      "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.720026363814443*^9, 
  3.7200264765287457`*^9}},ExpressionUUID->"223eda35-b9d8-4d5c-bfe8-\
ad3e8896538c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"HDelEuler", "[", 
    RowBox[{"Am_", ",", "chi_", ",", "J_"}], "]"}], ":=", 
   RowBox[{"J", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"GCurvature", "[", "Am", "]"}], "-", "chi"}], ")"}], "^", 
     "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H0DelEuler", "[", 
    RowBox[{"Am_", ",", "chi_", ",", "J0_", ",", "JEu_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"H0", "[", 
     RowBox[{"Am", ",", "J0"}], "]"}], "+", 
    RowBox[{"HDelEuler", "[", 
     RowBox[{"Am", ",", "chi", ",", "J0"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7199481435429697`*^9, 3.719948144888386*^9}, {
   3.719948698071101*^9, 3.71994871004967*^9}, {3.719948757326339*^9, 
   3.719948757883305*^9}, 
   3.729541583654305*^9},ExpressionUUID->"a284701a-f31b-4371-8c58-\
81179e7eac2a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"HDeldim", "[", 
    RowBox[{"Am_", ",", "d_", ",", "J_"}], "]"}], ":=", 
   RowBox[{"J", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"KDim", "[", "Am", "]"}], "-", "d"}], ")"}], "^", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H0Deldim", "[", 
    RowBox[{"Am_", ",", "d_", ",", "J0_", ",", "JEu_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"H0", "[", 
     RowBox[{"Am", ",", "J0"}], "]"}], "+", 
    RowBox[{"HDeldim", "[", 
     RowBox[{"Am", ",", "d", ",", "J0"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.71941973871491*^9, 3.7194197582679243`*^9}, {
   3.719948061213818*^9, 3.719948124575357*^9}, {3.719948173143957*^9, 
   3.719948187911338*^9}, {3.719948755855879*^9, 3.719948801077304*^9}, 
   3.728942614294979*^9, 
   3.735406824785974*^9},ExpressionUUID->"5c2f7298-7001-4c6d-9443-\
aabdc91b0547"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "These", " ", "have", " ", "produced", " ", "uninteresting", " ", 
    "graphs"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"HSymChi", "[", 
      RowBox[{"Am_", ",", "J_"}], "]"}], ":=", 
     RowBox[{"J", "*", 
      RowBox[{"SymChi", "[", "Am", "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"HAntiSymChi", "[", 
      RowBox[{"Am_", ",", "J_"}], "]"}], ":=", 
     RowBox[{"J", "*", 
      RowBox[{"AntiSymChi", "[", "Am", "]"}]}]}], ";", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"HTotChi", "[", 
      RowBox[{"Am_", ",", "J_"}], "]"}], ":=", 
     RowBox[{"J", "*", 
      RowBox[{"TotChi", "[", "Am", "]"}]}]}], ";", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"HEulerPChi", "[", 
      RowBox[{"Am_", ",", "J_"}], "]"}], ":=", 
     RowBox[{"J", "*", 
      RowBox[{"EulerPChi", "[", "Am", "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"HDelEuler", "[", 
      RowBox[{"Am_", ",", "chi_", ",", "J_"}], "]"}], ":=", 
     RowBox[{"J", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Curvature", "[", "Am", "]"}], "-", "chi"}], ")"}], "^", 
       "2"}]}]}], ";"}], "\[IndentingNewLine]", "*)"}]}]], "Input",
 CellChangeTimes->{{3.719948064275969*^9, 3.719948065673965*^9}, {
  3.719948217130411*^9, 
  3.719948217418317*^9}},ExpressionUUID->"b546d5bf-9b3a-435c-a775-\
3af639d3ca96"]
}, Closed]],

Cell[CellGroupData[{

Cell["Ensembles", "Subsubsection",
 CellChangeTimes->{{3.6852851827640133`*^9, 
  3.685285185219716*^9}},ExpressionUUID->"acdb2777-bd6f-40b2-8823-\
98a21f4ed377"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Makeensemble", "[", "n_", "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{
    "Makes", " ", "all", " ", "graphs", " ", "with", " ", "n", " ", 
     "vertices"}], "*)"}], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "N", ",", "temprow", ",", "tempg", ",", "templist", ",", "graphs", ",", 
       "l", ",", "k", ",", "i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"N", "=", 
       RowBox[{"n", "-", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"graphs", "=", 
       RowBox[{"{", 
        RowBox[{"MakeKn", "[", "1", "]"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tempg", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<=", "N"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"templist", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "0"}], ",", 
           RowBox[{"j", "<", 
            RowBox[{"2", "^", "i"}]}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"temprow", "=", 
             RowBox[{"IntegerDigits", "[", 
              RowBox[{"j", ",", "2", ",", 
               RowBox[{"i", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"templist", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"templist", ",", "temprow"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", 
            RowBox[{"Length", "[", "graphs", "]"}]}], ",", 
           RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"l", "=", "1"}], ",", 
              RowBox[{"l", "\[LessEqual]", 
               RowBox[{"Length", "[", "templist", "]"}]}], ",", 
              RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"tempg", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"tempg", ",", 
                  RowBox[{"ExpandGraph", "[", 
                   RowBox[{
                    RowBox[{"graphs", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                    RowBox[{"templist", "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], "]"}]}], "]"}]}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"graphs", "=", "tempg"}], ";", "\[IndentingNewLine]", 
         RowBox[{"tempg", "=", 
          RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "[", "graphs", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{"graphs", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", "graphs"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.686178094350287*^9, 3.686178111848537*^9}, 
   3.728941019799617*^9, 3.728941166601939*^9, 
   3.728943148045288*^9},ExpressionUUID->"fcf5cc14-0767-4946-85ce-\
40c4736dafce"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Makeensemble2", "[", "n_", "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{
    "Makes", " ", "all", " ", "graphs", " ", "with", " ", "n", " ", 
     "vertices"}], "*)"}], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "graphs", ",", "nentries", ",", "size", ",", "aijs", ",", "oneg", ",", 
       "i"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"graphs", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nentries", "=", 
       RowBox[{"(", 
        RowBox[{"n", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], "/", "2"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"size", "=", 
       RowBox[{"2", "^", "nentries"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "0"}], ",", 
        RowBox[{"i", "<", "size"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"i", ",", 
              RowBox[{"size", "/", "100"}]}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Making graph \>\"", ",", "i"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"aijs", "=", 
          RowBox[{"IntegerDigits", "[", 
           RowBox[{"i", ",", "2", ",", "nentries"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"oneg", "=", 
          RowBox[{"MakeAmat", "[", 
           RowBox[{"aijs", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"graphs", ",", "oneg"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "[", "graphs", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{"graphs", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", "graphs"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.68617753873868*^9, 3.686178117366329*^9, {3.6862801509992313`*^9, 
   3.686280155758533*^9}, 3.728942434611125*^9, 
   3.7289431485162992`*^9},ExpressionUUID->"6dcbd734-9b33-4181-93ed-\
06e0a1552ab0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsIsomorphic", "[", 
     RowBox[{"Amat_", ",", "ensemble_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "result", ",", "size", ",", "count"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"result", "=", "False"}], ";", "\[IndentingNewLine]", 
       RowBox[{"size", "=", 
        RowBox[{"Length", "[", "ensemble", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"size", "\[Equal]", "0"}], ",", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"i", "\[LessEqual]", "size"}], ",", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"IsomorphicGraphQ", "[", 
             RowBox[{
              RowBox[{"AdjacencyGraph", "[", "Amat", "]"}], ",", 
              RowBox[{"AdjacencyGraph", "[", 
               RowBox[{"ensemble", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"i", "++"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeUniqueEnsemble", "[", "n_", "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{
    "Makes", " ", "all", " ", "graphs", " ", "with", " ", "n", " ", 
     "unlabeled", " ", "vertices"}], "*)"}], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "graphs", ",", "nentries", ",", "size", ",", "aijs", ",", "oneg", ",", 
       "i"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"graphs", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nentries", "=", 
       RowBox[{"(", 
        RowBox[{"n", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], "/", "2"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"size", "=", 
       RowBox[{"2", "^", "nentries"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "0"}], ",", 
        RowBox[{"i", "<", "size"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"i", ",", 
              RowBox[{"size", "/", 
               RowBox[{"2", "^", "8"}]}]}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Making graph \>\"", ",", "i", ",", "\"\< unique graphs \>\"",
              ",", 
             RowBox[{"Length", "[", "graphs", "]"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"aijs", "=", 
          RowBox[{"IntegerDigits", "[", 
           RowBox[{"i", ",", "2", ",", "nentries"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"oneg", "=", 
          RowBox[{"MakeAmat", "[", 
           RowBox[{"aijs", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"IsIsomorphic", "[", 
             RowBox[{"oneg", ",", "graphs"}], "]"}], "\[Equal]", "False"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"graphs", ",", "oneg"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "[", "graphs", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{"graphs", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", "graphs"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.686178094350287*^9, 3.686178111848537*^9}, {
   3.696034901106317*^9, 3.696034916746015*^9}, 3.6960349770767403`*^9, {
   3.69603510460266*^9, 3.6960351123946047`*^9}, {3.696035233561095*^9, 
   3.696035252960023*^9}, {3.6960359911481857`*^9, 3.696035994205635*^9}, {
   3.6960360435413094`*^9, 3.696036058521202*^9}, {3.696036099116919*^9, 
   3.6960363587328863`*^9}, {3.696036420155443*^9, 3.696036442168709*^9}, {
   3.696036524572392*^9, 3.696036575683914*^9}, {3.696036642438944*^9, 
   3.6960366457984667`*^9}, {3.6960367082082233`*^9, 3.696036748952036*^9}, {
   3.696036797371697*^9, 3.696036797993868*^9}, {3.696036842499411*^9, 
   3.696036843161907*^9}, {3.696036964067789*^9, 3.696036991509781*^9}, {
   3.696037033186129*^9, 3.696037062182289*^9}, 3.696085396954915*^9, {
   3.696093981898809*^9, 3.696093997503655*^9}, {3.6960941396605453`*^9, 
   3.696094202924233*^9}, {3.6960942393497353`*^9, 3.696094286266488*^9}, {
   3.6960943854714947`*^9, 3.696094436047078*^9}, {3.6960944701848717`*^9, 
   3.6960945086065197`*^9}, {3.6960945391073523`*^9, 
   3.6960946836084642`*^9}, {3.696094730594178*^9, 3.696094755679204*^9}, {
   3.696094798357188*^9, 3.6960947987549057`*^9}, 3.7289424352029953`*^9, 
   3.728943191807835*^9},ExpressionUUID->"839d3bfa-143e-4dac-b546-\
a919ae5e3df2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FilterOnce", "[", "ensemble_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"size", ",", "graphs", ",", "newgraphs", ",", "i"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"size", " ", "=", " ", 
       RowBox[{"Length", "[", "ensemble", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"graphs", "=", 
       RowBox[{"ensemble", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<", "size"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "i", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<b4 iso\>\"", ",", "graphs"}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"IsomorphicGraphQ", "[", 
            RowBox[{
             RowBox[{"AdjacencyGraph", "[", 
              RowBox[{"ensemble", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
             RowBox[{"AdjacencyGraph", "[", 
              RowBox[{"ensemble", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
           "\[Equal]", "False"}], ",", 
          RowBox[{"graphs", " ", "=", " ", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"graphs", ",", 
             RowBox[{"ensemble", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"graphs", " ", "=", " ", 
             RowBox[{"Delete", "[", 
              RowBox[{"graphs", ",", 
               RowBox[{"Length", "[", "graphs", "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"graphs", " ", "=", " ", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"graphs", ",", 
               RowBox[{"ensemble", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<after iso\>\"", ",", "graphs"}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"graphs", " ", "=", " ", 
       RowBox[{"SortBy", "[", 
        RowBox[{"graphs", ",", "EdgeTot"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"size", "=", 
       RowBox[{"Length", "[", "graphs", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newgraphs", "=", 
       RowBox[{"graphs", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<=", 
         RowBox[{"size", "-", "2"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "i", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<b4 iso\>\"", ",", "graphs"}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"IsomorphicGraphQ", "[", 
            RowBox[{
             RowBox[{"AdjacencyGraph", "[", 
              RowBox[{"graphs", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
             RowBox[{"AdjacencyGraph", "[", 
              RowBox[{"graphs", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
           "\[Equal]", "False"}], ",", 
          RowBox[{"newgraphs", " ", "=", " ", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"newgraphs", ",", 
             RowBox[{"graphs", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "2"}], "]"}], "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"newgraphs", " ", "=", " ", 
             RowBox[{"Delete", "[", 
              RowBox[{"newgraphs", ",", 
               RowBox[{"Length", "[", "newgraphs", "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"newgraphs", " ", "=", " ", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"newgraphs", ",", 
               RowBox[{"graphs", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "2"}], "]"}], "]"}]}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<after iso\>\"", ",", "graphs"}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"newgraphs", " ", "=", " ", 
       RowBox[{"SortBy", "[", 
        RowBox[{"newgraphs", ",", "EdgeTot"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "newgraphs"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeUniqueEnsemble2", "[", "n_", "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{
    "Makes", " ", "all", " ", "graphs", " ", "with", " ", "n", " ", 
     "unlabeled", " ", "vertices"}], "*)"}], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "graphs", ",", "curgraphs", ",", "prevSize", ",", "currentSize", ",", 
       "i"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"graphs", "=", 
       RowBox[{"Makeensemble2", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"curgraphs", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"prevSize", " ", "=", " ", 
       RowBox[{"Length", "[", "graphs", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"currentSize", "=", 
       RowBox[{"Length", "[", "curgraphs", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"prevSize", ">", "currentSize"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{"prevSize", " ", "=", " ", 
          RowBox[{"Length", "[", "graphs", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<before 1 fileter \>\"", ",", 
           RowBox[{"Length", "[", "graphs", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"curgraphs", " ", "=", " ", 
          RowBox[{"FilterOnce", "[", "graphs", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<after 1 fileter \>\"", ",", 
           RowBox[{"Length", "[", "graphs", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"currentSize", " ", "=", " ", 
          RowBox[{"Length", "[", "curgraphs", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"graphs", " ", "=", " ", "curgraphs"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<prevSize \>\"", ",", "prevSize", ",", "\"\<currentSize \>\"", 
           ",", "currentSize"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "[", "graphs", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{"graphs", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", "graphs"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.696085567082847*^9, 3.696085577713933*^9}, {
   3.696086187202516*^9, 3.696086233763946*^9}, {3.696086267286821*^9, 
   3.696086389949327*^9}, {3.696086492827108*^9, 3.696086495194891*^9}, {
   3.6960865474638653`*^9, 3.696086683086789*^9}, {3.696086742458129*^9, 
   3.696086770754519*^9}, {3.696086881715757*^9, 3.696086997787054*^9}, {
   3.696087041649383*^9, 3.6960871495816307`*^9}, {3.696087238044791*^9, 
   3.696087276490222*^9}, {3.696087308963789*^9, 3.696087378945107*^9}, {
   3.696087439247861*^9, 3.6960874854697847`*^9}, {3.696087632320075*^9, 
   3.6960877577490673`*^9}, 3.696087793259596*^9, {3.696088069581908*^9, 
   3.6960881159941473`*^9}, {3.696088150391604*^9, 3.696088239345923*^9}, {
   3.696088337201771*^9, 3.696088352344142*^9}, {3.6960884579295464`*^9, 
   3.6960884757509336`*^9}, {3.696088626133271*^9, 3.696088718411797*^9}, {
   3.69608891908993*^9, 3.6960889378476467`*^9}, {3.6960891610927963`*^9, 
   3.6960892578342867`*^9}, {3.696089340051691*^9, 3.696089340109522*^9}, {
   3.696089373095703*^9, 3.6960893759506817`*^9}, {3.696089428807415*^9, 
   3.69608942889429*^9}, {3.696089540213889*^9, 3.696089541058676*^9}, 
   3.696089598758828*^9, {3.696089705455957*^9, 3.696089707853403*^9}, {
   3.696090037944031*^9, 3.696090063750536*^9}, {3.696090244243607*^9, 
   3.696090248961211*^9}, 3.696090293016424*^9, {3.696090364760116*^9, 
   3.696090368006571*^9}, {3.6960904804715357`*^9, 3.6960904842923594`*^9}, {
   3.696090547220221*^9, 3.6960905822580643`*^9}, {3.6960911753312817`*^9, 
   3.69609120848208*^9}, {3.696091304548162*^9, 3.696091315234818*^9}, {
   3.696091398573966*^9, 3.6960914400491333`*^9}, 3.6960922343037*^9, {
   3.696092345828936*^9, 3.696092347442535*^9}, 3.696092505007732*^9, {
   3.696092541281423*^9, 3.6960927284960003`*^9}, {3.728942510120894*^9, 
   3.72894251078129*^9}, 3.728943149929473*^9, {3.728943192863616*^9, 
   3.728943211083564*^9}},ExpressionUUID->"6664b3d6-ad4a-4d38-bca6-\
69b0b6f64ae3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowGraphs", "[", "ensemble_", "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AdjacencyGraph", "[", 
        RowBox[{"#", ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"60", ",", "60"}], "}"}]}]}], "]"}], "&"}], ",", 
      "ensemble"}], "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.728943151698145*^9, 3.7289432280636063`*^9, {3.729619885748233*^9, 
   3.7296199984067097`*^9}},ExpressionUUID->"431b355d-1b94-4828-a06f-\
57cd1ccb09e1"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "Energies", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Energies", "[", 
    RowBox[{"ensemble_", ",", 
     RowBox[{"H_", "[", "params__", "]"}], ",", "level_"}], "]"}], ":=", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Calculates", " ", "the", " ", "energies", " ", "of", " ", "states", " ", 
     "from", " ", "the", " ", "given", " ", "ensemble", " ", "of", " ", 
     "graphs", " ", 
     RowBox[{"(", 
      RowBox[{
      "which", " ", "is", " ", "an", " ", "input", " ", "to", " ", "the", " ",
        "function"}], ")"}], " ", "and", " ", "for", " ", "the", " ", "given",
      " ", "hamiltonian", " ", "function", " ", 
     RowBox[{"H", ".", " ", "Outputs"}], " ", "an", " ", "ordered", " ", 
     "association", " ", "with", " ", "the", " ", "lowest", " ", 
     "\"\<level\>\"", " ", "energies", " ", "as", " ", "the", " ", "keys", 
     " ", "and", " ", "the", " ", "graphs", " ", "with", " ", "those", " ", 
     "energies", " ", "as", " ", "the", " ", "values"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"val", ",", "elist", ",", "size", ",", "nprint", ",", "ge"}], 
      " ", 
      RowBox[{"(*", 
       RowBox[{"energy", " ", "of", " ", "a", " ", "given", " ", "graph"}], 
       "*)"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"size", "=", 
       RowBox[{"Length", "[", "ensemble", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"elist", "=", 
       RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nprint", "=", "100000"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"k", ",", "nprint"}], "]"}], "\[Equal]", "0"}], ",", " ", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Now computing energy of graph \>\"", ",", " ", "k"}],
             "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<k \>\"", ",", "k"}], "]"}], ";", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<working on graph \>\"", ",", 
             RowBox[{"AdjacencyGraph", "[", 
              RowBox[{"ensemble", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<elist \>\"", ",", "elist"}], "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"ge", "=", 
          RowBox[{"H", "[", 
           RowBox[{
            RowBox[{"ensemble", "[", 
             RowBox[{"[", "k", "]"}], "]"}], ",", "params"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"val", "=", 
          RowBox[{"Lookup", "[", 
           RowBox[{"elist", ",", "ge", ",", 
            RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"val", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"val", ",", 
            RowBox[{"AdjacencyGraph", "[", 
             RowBox[{
              RowBox[{"ensemble", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"50", ",", "50"}], "}"}]}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AssociateTo", "[", 
          RowBox[{"elist", ",", 
           RowBox[{"ge", "\[Rule]", "val"}]}], "]"}]}], "\[IndentingNewLine]",
         ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "size"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"KeySort", "[", "elist", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "level"}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.673801458595578*^9, 3.673801752304997*^9}, {
   3.6824405214722767`*^9, 3.682440549390232*^9}, {3.682440819703638*^9, 
   3.682440824927926*^9}, {3.682442476288712*^9, 3.682442480255172*^9}, {
   3.6824425352575283`*^9, 3.6824425669163523`*^9}, {3.682442892726409*^9, 
   3.682442933019244*^9}, {3.682443556065442*^9, 3.6824436744042797`*^9}, {
   3.6824437423133183`*^9, 3.682443744536434*^9}, {3.682443826934668*^9, 
   3.682443834190394*^9}, {3.682443913920323*^9, 3.6824439964262333`*^9}, {
   3.682444073198868*^9, 3.6824440825342693`*^9}, {3.6824486582963753`*^9, 
   3.68244868820583*^9}, {3.6824487377981157`*^9, 3.682448768003504*^9}, {
   3.68244930251328*^9, 3.6824493029670877`*^9}, {3.682449413295601*^9, 
   3.682449425950437*^9}, {3.682449588097794*^9, 3.682449589935635*^9}, {
   3.682514266726828*^9, 3.682514317537464*^9}, 3.682514585252665*^9, {
   3.682522195872603*^9, 3.682522204727343*^9}, 3.6825226129748907`*^9, {
   3.682806116128159*^9, 3.6828061196411333`*^9}, {3.682964125881212*^9, 
   3.682964315739369*^9}, {3.682965017409186*^9, 3.682965021208428*^9}, {
   3.682965293887083*^9, 3.682965302026099*^9}, {3.682965719578313*^9, 
   3.682965756071908*^9}, {3.682965989585938*^9, 3.682966095933114*^9}, {
   3.6829694131757402`*^9, 3.682969431254356*^9}, {3.682969653903062*^9, 
   3.6829696543336363`*^9}, {3.6829714221133757`*^9, 3.682971422305602*^9}, {
   3.6831308237768497`*^9, 3.6831308279757967`*^9}, {3.686186010257649*^9, 
   3.686186013145973*^9}, 3.6861860456576138`*^9, {3.686186863895445*^9, 
   3.6861868681561117`*^9}, {3.686186966773773*^9, 3.686187036631218*^9}, {
   3.686187079902692*^9, 3.6861870836281767`*^9}, {3.6861874751067944`*^9, 
   3.686187490739624*^9}, {3.686187991220544*^9, 3.686188021846942*^9}, 
   3.686189994403713*^9, {3.686190041492764*^9, 3.686190083301264*^9}, 
   3.686190216495926*^9, {3.686190299372188*^9, 3.686190312462882*^9}, {
   3.686278680493629*^9, 3.686278690654829*^9}, 3.686278998291082*^9, {
   3.686279133840809*^9, 3.686279135994371*^9}, 3.686410614368635*^9, {
   3.719351796444392*^9, 3.719351796931802*^9}, {3.719353081292914*^9, 
   3.719353081693605*^9}, {3.7193536938058863`*^9, 3.719353752333803*^9}, {
   3.7193538564860907`*^9, 3.719353856675708*^9}, {3.719353958307864*^9, 
   3.719353958972464*^9}, {3.719354827318335*^9, 3.719354827544883*^9}, {
   3.71935502276901*^9, 3.7193550238638287`*^9}, {3.719355482202009*^9, 
   3.719355496299679*^9}, {3.719356349860477*^9, 3.71935635247332*^9}, {
   3.719356399630274*^9, 3.719356464313382*^9}, {3.7193566304266*^9, 
   3.7193566317922163`*^9}, {3.719366045958263*^9, 3.719366093087901*^9}, 
   3.728943244407893*^9, {3.729102789722287*^9, 3.7291028009842052`*^9}, {
   3.729340753071251*^9, 3.729340761636178*^9}, {3.729618255983655*^9, 
   3.7296182665332623`*^9}, 3.729618395498074*^9, 3.729618472352223*^9, {
   3.72961855069119*^9, 3.72961857973695*^9}, {3.729618618168866*^9, 
   3.729618619191346*^9}, {3.729618654599681*^9, 3.729618677205348*^9}, {
   3.729618731788267*^9, 3.729618759322771*^9}, {3.729620044845798*^9, 
   3.729620049318494*^9}, {3.729620141907282*^9, 3.7296201700333853`*^9}, {
   3.729620204456809*^9, 3.7296202472139063`*^9}, {3.7296203064303827`*^9, 
   3.7296203520098743`*^9}, 3.7296204197693*^9, {3.729620590553698*^9, 
   3.7296205937926197`*^9}, {3.7296206385122023`*^9, 3.729620650742042*^9}, {
   3.729620712925119*^9, 3.729620714603773*^9}, {3.7296263233513536`*^9, 
   3.729626323542056*^9}, {3.729626420068205*^9, 3.729626438146093*^9}, {
   3.72963670759289*^9, 3.7296367855863113`*^9}, {3.729636818819227*^9, 
   3.729636820870625*^9}, {3.7296368853609123`*^9, 3.729636897358224*^9}, {
   3.729636945693478*^9, 3.7296369573864317`*^9}, {3.7296370056363573`*^9, 
   3.729637018874309*^9}, {3.729637082730433*^9, 3.7296371108144417`*^9}, {
   3.729637221837481*^9, 3.729637324527705*^9}, {3.7296378933407993`*^9, 
   3.7296379182101183`*^9}, {3.729637949403554*^9, 3.729637953489664*^9}, {
   3.729638004496461*^9, 3.729638030134666*^9}, {3.729638113646278*^9, 
   3.7296381561858664`*^9}, {3.729638364284943*^9, 3.729638437937653*^9}, {
   3.729638760852319*^9, 3.729638786835506*^9}, {3.729639116514512*^9, 
   3.729639157221869*^9}, {3.729639354105815*^9, 3.729639357078966*^9}, {
   3.729639412696368*^9, 3.729639415420734*^9}, {3.729639459423028*^9, 
   3.729639497691435*^9}, {3.729639591506884*^9, 3.7296395980463333`*^9}, {
   3.7296400753868093`*^9, 3.7296400977127247`*^9}, {3.729640128481391*^9, 
   3.729640152957611*^9}, 3.729640272588125*^9, {3.729640328994577*^9, 
   3.72964033802291*^9}},ExpressionUUID->"54879f64-9868-4012-afb7-\
675695554ffa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MinEnergies", "[", 
    RowBox[{"ensemble_", ",", "h_"}], "]"}], ":=", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Calculates", " ", "the", " ", "lowest", " ", "energy", " ", "state", " ",
      "from", " ", "the", " ", "ensemble", " ", "of", " ", "graphs", " ", 
     RowBox[{"(", 
      RowBox[{
      "which", " ", "is", " ", "an", " ", "input", " ", "to", " ", "the", " ",
        "function"}], ")"}], " ", "with", " ", "the", " ", "source", " ", 
     "term", " ", "set", " ", "to", " ", 
     RowBox[{"h", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"templist", ",", "minE", ",", "result"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"templist", "=", 
       RowBox[{"Energies", "[", 
        RowBox[{"ensemble", ",", "h"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"minE", "=", 
       RowBox[{
        RowBox[{"Keys", "[", "templist", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"Lookup", "[", 
        RowBox[{"templist", ",", "minE"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{3.728943257484132*^9, 
  3.728943329493147*^9},ExpressionUUID->"6f659476-7832-40a6-9df9-\
6dbcd98f1525"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MinEnergies2", "[", 
     RowBox[{"n_", ",", "ham_", ",", "h_"}], "]"}], ":=", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Calculates", " ", "the", " ", "two", " ", "lowest", " ", "energy", " ", 
      "states", " ", "from", " ", "the", " ", "whole", " ", "ensemble", " ", 
      "of", " ", "graphs", " ", "of", " ", "n", " ", "vertices", " ", "with", 
      " ", "the", " ", "given", " ", "hamiltonian", " ", "ham", " ", "and", 
      " ", "source", " ", "term", " ", "set", " ", "to", " ", "h"}], "*)"}], 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nentries", ",", "mings", ",", "minPgs", ",", "totNumOfG", ",", "i", 
        ",", "aijs", ",", "oneg", ",", "ge", ",", "foundge", ",", "minE", ",",
         "minpE", ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nentries", "=", 
        RowBox[{"n", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], "/", "2"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"totNumOfG", "=", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"2", "^", "nentries"}], ",", "1000000"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"totNumOfG", "=", "1000000"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"minE", "=", "10000"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"some", " ", "large", " ", "number"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"minpE", "=", 
        RowBox[{"2", "*", "minE"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"foundge", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "0"}], ",", 
         RowBox[{"i", "<", "totNumOfG"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"i", ",", "100000"}], "]"}], "\[Equal]", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Working on graph \>\"", ",", "i"}], "]"}], ";"}], 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Print", "[", "result", "]"}], "*)"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"mings", "=", 
           RowBox[{"Length", "[", 
            RowBox[{"Lookup", "[", 
             RowBox[{"result", ",", "minE", ",", 
              RowBox[{"{", "}"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"minPgs", "=", 
           RowBox[{"Length", "[", 
            RowBox[{"Lookup", "[", 
             RowBox[{"result", ",", "minpE", ",", 
              RowBox[{"{", "}"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{"mings", "\[GreaterEqual]", "5"}], " ", ")"}], ",", 
              RowBox[{"Return", "[", "result", "]"}]}], "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"aijs", "=", 
             RowBox[{"IntegerDigits", "[", 
              RowBox[{
               RowBox[{"RandomInteger", "[", 
                RowBox[{
                 RowBox[{"2", "^", "nentries"}], "-", "1"}], "]"}], ",", "2", 
               ",", "nentries"}], "]"}]}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"aijs", "=", 
           RowBox[{"IntegerDigits", "[", 
            RowBox[{"i", ",", "2", ",", "nentries"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"oneg", "=", 
           RowBox[{"MakeAmat", "[", 
            RowBox[{"aijs", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ge", "=", 
           RowBox[{"ham", "[", 
            RowBox[{"oneg", ",", "h"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ge", ">", "minpE"}], ")"}], ",", 
            RowBox[{"Continue", "[", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ge", "\[Equal]", "minpE"}], "||", 
              RowBox[{"ge", "\[Equal]", "minE"}]}], ")"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"foundge", "=", 
               RowBox[{"Lookup", "[", 
                RowBox[{"result", ",", "ge", ",", 
                 RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"foundge", ",", 
                RowBox[{"AdjacencyGraph", "[", 
                 RowBox[{"oneg", ",", 
                  RowBox[{"ImageSize", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"50", ",", "50"}], "}"}]}]}], "]"}]}], "]"}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"AssociateTo", "[", 
               RowBox[{"result", ",", 
                RowBox[{"ge", "\[Rule]", "foundge"}]}], "]"}], ";"}], 
             "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ge", "<", "minpE"}], " ", "&&", " ", 
              RowBox[{"ge", " ", ">", " ", "minE"}]}], ")"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"result", "=", 
               RowBox[{"KeyDrop", "[", 
                RowBox[{"result", ",", "minpE"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"minpE", " ", "=", " ", "ge"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"result", ",", 
                RowBox[{"minpE", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"AdjacencyGraph", "[", 
                   RowBox[{"oneg", ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "50"}], "}"}]}]}], "]"}], "}"}]}]}], 
               "]"}], ";"}], "\[IndentingNewLine]", "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ge", "<", "minE"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"result", "=", 
               RowBox[{"KeyDrop", "[", 
                RowBox[{"result", ",", "minpE"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"minpE", " ", "=", " ", "minE"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"minE", "=", "ge"}], ";", "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"result", ",", 
                RowBox[{"minE", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"AdjacencyGraph", "[", 
                   RowBox[{"oneg", ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "50"}], "}"}]}]}], "]"}], "}"}]}]}], 
               "]"}], ";"}], "\[IndentingNewLine]", "}"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "result"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RegEnergies", "[", 
    RowBox[{"n_", ",", "h_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "mings", ",", "minPgs", ",", "pmats", ",", "totNumOfG", ",", "i", ",", 
       "oneg", ",", "ge", ",", "foundge", ",", "minE", ",", "minpE", ",", 
       "result"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"totNumOfG", "=", 
       RowBox[{"n", "!"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"minE", "=", "400"}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"some", " ", "large", " ", "number"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"minpE", "=", 
       RowBox[{"2", "*", "minE"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"foundge", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pmats", "=", 
       RowBox[{"PermMats", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "0"}], ",", 
        RowBox[{"i", "<", 
         RowBox[{"n", "!"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"i", ",", "500000"}], "]"}], "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Working on graph \>\"", ",", "i"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", "result", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"mings", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"Lookup", "[", 
            RowBox[{"result", ",", "minE", ",", 
             RowBox[{"{", "}"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"minE", "\[LessEqual]", "1"}], " ", "&&", " ", 
             RowBox[{"mings", "\[GreaterEqual]", "6"}]}], " ", ")"}], ",", 
           RowBox[{"Return", "[", "result", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"oneg", "=", 
          RowBox[{"MakeRegAijs", "[", 
           RowBox[{
            RowBox[{"pmats", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", "h", ",", "n"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ge", "=", 
          RowBox[{
           RowBox[{"H1", "[", "oneg", "]"}], "+", 
           RowBox[{"Hsource", "[", 
            RowBox[{"oneg", ",", "h"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ge", ">", "minpE"}], ")"}], ",", 
           RowBox[{"Continue", "[", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ge", "\[Equal]", "minpE"}], "||", 
             RowBox[{"ge", "\[Equal]", "minE"}]}], ")"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"foundge", "=", 
              RowBox[{"Lookup", "[", 
               RowBox[{"result", ",", "ge", ",", 
                RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"foundge", ",", 
               RowBox[{"AdjacencyGraph", "[", 
                RowBox[{"oneg", ",", 
                 RowBox[{"ImageSize", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"50", ",", "50"}], "}"}]}]}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AssociateTo", "[", 
              RowBox[{"result", ",", 
               RowBox[{"ge", "\[Rule]", "foundge"}]}], "]"}], ";"}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ge", "<", "minpE"}], " ", "&&", " ", 
             RowBox[{"ge", " ", ">", " ", "minE"}]}], ")"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"result", "=", 
              RowBox[{"KeyDrop", "[", 
               RowBox[{"result", ",", "minpE"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"minpE", " ", "=", " ", "ge"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"result", ",", 
               RowBox[{"minpE", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"AdjacencyGraph", "[", 
                  RowBox[{"oneg", ",", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "50"}], "}"}]}]}], "]"}], "}"}]}]}], 
              "]"}], ";"}], "\[IndentingNewLine]", "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ge", "<", "minE"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"result", "=", 
              RowBox[{"KeyDrop", "[", 
               RowBox[{"result", ",", "minpE"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"minpE", " ", "=", " ", "minE"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"minE", "=", "ge"}], ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"result", ",", 
               RowBox[{"minE", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"AdjacencyGraph", "[", 
                  RowBox[{"oneg", ",", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "50"}], "}"}]}]}], "]"}], "}"}]}]}], 
              "]"}], ";"}], "\[IndentingNewLine]", "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6824420720301456`*^9, 3.6824420936447153`*^9}, {
   3.682442131964427*^9, 3.6824422377453337`*^9}, {3.6824430445571213`*^9, 
   3.6824430748730783`*^9}, {3.6824471433720903`*^9, 
   3.6824471630509043`*^9}, {3.682447226933119*^9, 3.682447247707403*^9}, {
   3.682447288700124*^9, 3.6824473154491367`*^9}, {3.6824473456083317`*^9, 
   3.682447371245913*^9}, {3.6824474044309397`*^9, 3.682447409789364*^9}, {
   3.682447440486545*^9, 3.682447474563562*^9}, {3.682447654123846*^9, 
   3.682447715200302*^9}, {3.682447808763897*^9, 3.682447809153681*^9}, {
   3.682449490698442*^9, 3.682449500584167*^9}, {3.682522729997365*^9, 
   3.682522737421235*^9}, {3.68252286723671*^9, 3.682522883087799*^9}, {
   3.682522916333416*^9, 3.682522948899218*^9}, {3.682523018412442*^9, 
   3.682523236802238*^9}, {3.682523273816784*^9, 3.682523288223014*^9}, {
   3.682523391862959*^9, 3.6825233955817738`*^9}, {3.682523441834982*^9, 
   3.682523557225255*^9}, {3.682523616461577*^9, 3.682523667027895*^9}, {
   3.682523839558804*^9, 3.682523930628069*^9}, {3.682523988200842*^9, 
   3.682523989727819*^9}, {3.682524102503388*^9, 3.6825241353796864`*^9}, {
   3.682524168595934*^9, 3.682524170117155*^9}, {3.682524220455853*^9, 
   3.682524233296089*^9}, {3.682524280910325*^9, 3.682524287651908*^9}, {
   3.682524425740032*^9, 3.682524435970525*^9}, {3.68252448081028*^9, 
   3.682524502791522*^9}, {3.68252453905103*^9, 3.682524703470545*^9}, {
   3.6825247717358*^9, 3.682524800711595*^9}, {3.682525094139566*^9, 
   3.682525133938781*^9}, {3.6825252569161663`*^9, 3.682525260659836*^9}, {
   3.682525340970933*^9, 3.682525344721587*^9}, {3.682525683380229*^9, 
   3.682525709603751*^9}, {3.682525938219734*^9, 3.682525954393306*^9}, {
   3.682526250179844*^9, 3.6825262926678257`*^9}, {3.68252633485175*^9, 
   3.6825263616398497`*^9}, {3.6825264071564283`*^9, 
   3.6825264073723297`*^9}, {3.682526443868445*^9, 3.682526505793594*^9}, {
   3.682526688820095*^9, 3.68252670905332*^9}, {3.6825267981997423`*^9, 
   3.68252680342865*^9}, {3.6825268352843018`*^9, 3.682526841452468*^9}, {
   3.682526898498951*^9, 3.682526904359673*^9}, {3.682527008550898*^9, 
   3.6825270296281137`*^9}, {3.682527100723875*^9, 3.6825271209692373`*^9}, {
   3.682527264347664*^9, 3.682527278736681*^9}, {3.682527333489567*^9, 
   3.6825273828533077`*^9}, {3.682527419279303*^9, 3.682527528617097*^9}, {
   3.682527575600456*^9, 3.682527634831505*^9}, {3.68252767311909*^9, 
   3.682527743954382*^9}, {3.682527835882465*^9, 3.6825278361041613`*^9}, {
   3.6825279075300922`*^9, 3.6825279601811666`*^9}, {3.682528070389975*^9, 
   3.6825281223799047`*^9}, {3.6825281723563643`*^9, 
   3.6825281958927803`*^9}, {3.682528442060618*^9, 3.682528486701881*^9}, {
   3.68252852928747*^9, 3.682528563713209*^9}, {3.682528644379661*^9, 
   3.6825286448902473`*^9}, {3.682528710583208*^9, 3.682528713798401*^9}, {
   3.6825287587822227`*^9, 3.682528869941998*^9}, {3.6825289257714357`*^9, 
   3.6825289433857822`*^9}, {3.682529030529395*^9, 3.682529033053853*^9}, {
   3.6825290685390997`*^9, 3.682529075738427*^9}, {3.682529119850021*^9, 
   3.682529172451665*^9}, {3.682529227916443*^9, 3.682529241081012*^9}, {
   3.682529288803329*^9, 3.6825292891678247`*^9}, {3.682529323181849*^9, 
   3.682529323218956*^9}, {3.682529381150084*^9, 3.68252938339505*^9}, {
   3.6825294473598537`*^9, 3.682529458607472*^9}, {3.68252950639533*^9, 
   3.6825295092559433`*^9}, {3.682529592701619*^9, 3.6825295962830153`*^9}, {
   3.682529671097582*^9, 3.682529671152465*^9}, {3.682532053394864*^9, 
   3.682532054206604*^9}, {3.68253220633885*^9, 3.682532223881295*^9}, {
   3.682532350707877*^9, 3.682532456171769*^9}, {3.682532489771244*^9, 
   3.682532538270596*^9}, {3.6825327202771673`*^9, 3.682532846063188*^9}, {
   3.6825329500463343`*^9, 3.682532966475505*^9}, {3.6825330013262672`*^9, 
   3.682533004404269*^9}, {3.682533063000263*^9, 3.682533128749476*^9}, {
   3.68253318839806*^9, 3.6825331885487843`*^9}, {3.682535754818685*^9, 
   3.682535754903184*^9}, {3.682535799262887*^9, 3.682535811462977*^9}, {
   3.682535985943728*^9, 3.682536000588684*^9}, {3.682538345797448*^9, 
   3.682538349974049*^9}, {3.6825386696442204`*^9, 3.682538713166287*^9}, {
   3.682538773705429*^9, 3.6825387742144833`*^9}, {3.682538834374908*^9, 
   3.682538836188488*^9}, {3.6825389204635677`*^9, 3.6825389239978456`*^9}, {
   3.682538978571279*^9, 3.682538979265472*^9}, {3.682539231262514*^9, 
   3.682539235827362*^9}, {3.6825398077629023`*^9, 3.6825398078804007`*^9}, {
   3.6825398438807173`*^9, 3.682539864318368*^9}, {3.6825398958185368`*^9, 
   3.682539906658259*^9}, {3.6825399736883*^9, 3.682540002343277*^9}, 
   3.682540038280023*^9, {3.6825400730778112`*^9, 3.682540089090081*^9}, {
   3.6825401305717363`*^9, 3.682540130824888*^9}, {3.682540181718046*^9, 
   3.682540184707334*^9}, {3.6825403127371683`*^9, 3.682540313210453*^9}, {
   3.682540366561442*^9, 3.682540369663702*^9}, {3.682540439630087*^9, 
   3.682540454891994*^9}, {3.682543660040791*^9, 3.682543661303591*^9}, 
   3.682558059292788*^9, {3.682558212007399*^9, 3.682558218404488*^9}, {
   3.682565785442934*^9, 3.682565792300969*^9}, {3.6825658269000797`*^9, 
   3.682565846360096*^9}, {3.682565881307461*^9, 3.682565882511636*^9}, {
   3.68262272927363*^9, 3.682622817995369*^9}, {3.682625738798678*^9, 
   3.682625739421496*^9}, {3.682629109465975*^9, 3.6826291273078823`*^9}, 
   3.682629270929083*^9, 3.682643251955955*^9, {3.682643615240068*^9, 
   3.682643652368565*^9}, {3.6826437204532146`*^9, 3.682643729950493*^9}, {
   3.6826437715777693`*^9, 3.682643824220945*^9}, {3.68264386097118*^9, 
   3.6826438618505163`*^9}, {3.68264391914332*^9, 3.6826439413027*^9}, {
   3.6826440068585663`*^9, 3.6826442038809557`*^9}, {3.68264424857826*^9, 
   3.682644277022994*^9}, {3.682796001663151*^9, 3.6827960031949997`*^9}, {
   3.682796188338829*^9, 3.682796411536405*^9}, {3.682796446307313*^9, 
   3.682796544367385*^9}, {3.682796653943735*^9, 3.682796655008246*^9}, 
   3.68279774211281*^9, {3.682797825231905*^9, 3.6827979838227987`*^9}, {
   3.682798025297665*^9, 3.682798025622271*^9}, {3.6827981892678957`*^9, 
   3.682798189865315*^9}, {3.682798222181197*^9, 3.682798295126009*^9}, {
   3.6827983337065973`*^9, 3.6827983354569607`*^9}, {3.682798394787188*^9, 
   3.6827984775524397`*^9}, {3.682798515072234*^9, 3.682798515488791*^9}, {
   3.682798654142914*^9, 3.682798674637989*^9}, {3.6827987464696407`*^9, 
   3.682798749539262*^9}, {3.6827987936303587`*^9, 3.68279886016894*^9}, {
   3.6827989443672647`*^9, 3.682798944388856*^9}, {3.6827990976202593`*^9, 
   3.682799097781045*^9}, {3.6827991545094633`*^9, 3.682799154707663*^9}, {
   3.682799723937954*^9, 3.682799729676547*^9}, {3.682799836153384*^9, 
   3.682799964844412*^9}, {3.682800079384046*^9, 3.6828001741863003`*^9}, {
   3.682800264854319*^9, 3.682800294275268*^9}, {3.682800355660797*^9, 
   3.682800355738599*^9}, {3.6828021982204657`*^9, 3.6828021996032267`*^9}, {
   3.682802237236*^9, 3.6828023588137608`*^9}, {3.6828023928655777`*^9, 
   3.682802429435131*^9}, {3.682802467813321*^9, 3.682802468090247*^9}, {
   3.682802594028617*^9, 3.682802599633585*^9}, {3.6828029466992283`*^9, 
   3.682802998810795*^9}, {3.682803118648431*^9, 3.68280316403039*^9}, {
   3.6828032686768847`*^9, 3.682803355247933*^9}, {3.68280339004888*^9, 
   3.682803391017404*^9}, {3.682803449967486*^9, 3.682803477708272*^9}, 
   3.682803513385249*^9, {3.682803686606406*^9, 3.682803702050799*^9}, {
   3.6828037625328197`*^9, 3.682803792856942*^9}, {3.682803891692175*^9, 
   3.682803898063734*^9}, {3.6828039632090683`*^9, 3.682804005829898*^9}, {
   3.6828057434937162`*^9, 3.6828057526697483`*^9}, {3.682805993063856*^9, 
   3.682806012774291*^9}, {3.682806105157526*^9, 3.682806107020171*^9}, 
   3.6828061403059177`*^9, {3.682963998222543*^9, 3.682964103790595*^9}, {
   3.682971063376786*^9, 3.682971101140381*^9}, {3.6829711315189753`*^9, 
   3.682971131774081*^9}, {3.682971566426166*^9, 3.682971603529434*^9}, {
   3.68297173964777*^9, 3.6829717426208687`*^9}, {3.682971778100194*^9, 
   3.682971781027027*^9}, {3.682971945093752*^9, 3.6829719478697*^9}, {
   3.682971981017995*^9, 3.68297198372865*^9}, {3.682972064702223*^9, 
   3.682972065650915*^9}, {3.682972179703682*^9, 3.6829721834476*^9}, {
   3.682972283277917*^9, 3.682972331277125*^9}, {3.68297253874439*^9, 
   3.68297264897357*^9}, {3.682973414252448*^9, 3.6829734352189503`*^9}, {
   3.6831307069851913`*^9, 3.683130731375978*^9}, {3.683130876676507*^9, 
   3.6831308809383574`*^9}, {3.683130966835348*^9, 3.6831309943998823`*^9}, {
   3.685309721940097*^9, 3.685309723897512*^9}, 3.6861778084328337`*^9, {
   3.7288467303297987`*^9, 3.7288467354284973`*^9}, 3.728941081543144*^9, 
   3.7289424356946297`*^9, 3.7289424723104057`*^9, {3.7289433303783083`*^9, 
   3.728943344191951*^9}},ExpressionUUID->"72e89b13-3bde-48b0-b263-\
120f9f7f3bf0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CountGraphs", "[", 
   RowBox[{"ensemble_", ",", "condition_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "given", " ", "a", " ", "list", " ", "of", " ", "graphs", " ", "and", 
      " ", "a", " ", "condition"}], ",", " ", 
     RowBox[{
     "this", " ", "function", " ", "outputs", " ", "an", " ", "association", 
      " ", "where", " ", "the", " ", "keys", " ", "are", " ", "vectors", " ", 
      "of", " ", "size", " ", "equal", " ", "to", " ", "the", " ", "number", 
      " ", "of", " ", "nodes"}], ",", " ", 
     RowBox[{
     "whose", " ", "values", " ", "are", " ", "the", " ", "value", " ", "of", 
      " ", "the", " ", "condition", " ", "on", " ", "each", " ", 
      RowBox[{"node", ".", " ", "The"}], " ", "values", " ", "of", " ", "the",
       " ", "association", " ", "are", " ", "the", " ", "number", " ", "of", 
      " ", "graphs", " ", "having", " ", "the", " ", "same", " ", "sorted", 
      " ", 
      RowBox[{"keys", ".", " ", "For"}], " ", "example"}], ",", " ", 
     RowBox[{
     "if", " ", "the", " ", "condition", " ", "is", " ", "degs", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
        "degrees", " ", "which", " ", "is", " ", "a", " ", "function", " ", 
         "that", " ", "acts", " ", "on", " ", "a", " ", "graph", " ", "and", 
         " ", "outputs", " ", "a", " ", "vector", " ", "of", " ", "length", 
         " ", "n", " ", "of", " ", "the", " ", "degrees", " ", "of", " ", 
         "each", " ", "nodes"}], ",", " ", 
        RowBox[{
        "then", " ", "CountGraphs", " ", "outputs", " ", "an", " ", 
         "association", " ", "where", " ", "the", " ", "keys", " ", "are", 
         " ", "the", " ", "sorted", " ", "degs", " ", "and", " ", "the", " ", 
         "values", " ", "are", " ", "the", " ", "number", " ", "of", " ", 
         "graphs", " ", "having", " ", "the", " ", "same", " ", "sorted", " ", 
         RowBox[{"keys", "."}]}]}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"{", 
     RowBox[{"assoc", ",", "val", ",", "result", ",", "n"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "ensemble", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"result", "=", 
      RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"val", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{"condition", "[", 
           RowBox[{"ensemble", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"result", "[", "val", "]"}], "=", 
         RowBox[{
          RowBox[{"Lookup", "[", 
           RowBox[{"result", ",", 
            RowBox[{"Key", "[", "val", "]"}], ",", "0"}], "]"}], "+", "1"}]}],
         ";"}], "  ", "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "result"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.728843955122464*^9, 3.728843990775795*^9}, {
  3.7288440465581636`*^9, 3.728844168401226*^9}, {3.728844326976037*^9, 
  3.728844381586583*^9}, {3.7288445259856157`*^9, 3.728844536260024*^9}, {
  3.72884459464261*^9, 3.728844607360087*^9}, {3.728844647796192*^9, 
  3.7288446614124107`*^9}, {3.728844869601828*^9, 3.728844891769058*^9}, {
  3.728844955049055*^9, 3.7288449569189987`*^9}, {3.728844999930884*^9, 
  3.728845000199073*^9}, {3.728845034615325*^9, 3.728845067322031*^9}, {
  3.728845244012169*^9, 3.728845246243681*^9}, {3.728845855998818*^9, 
  3.728845859095992*^9}, {3.728846753382924*^9, 3.728846908140263*^9}, {
  3.728846942873101*^9, 
  3.728846980031341*^9}},ExpressionUUID->"5bc0ad13-027a-44b0-98fd-\
8ccc61e18801"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ParallelExpectationValue", "[", 
    RowBox[{"ensemble_", ",", 
     RowBox[{"function_", "[", "fparams__", "]"}], ",", 
     RowBox[{"Hamiltonian_", "[", "hparams__", "]"}], ",", "beta_"}], "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "This", " ", "computes", " ", "the", " ", "expectation", " ", "value", 
      " ", "of", " ", "the", " ", "observable", " ", "function", " ", "that", 
      " ", "needs", " ", "parameters", " ", "fparams"}], ",", " ", 
     RowBox[{
     "for", " ", "energies", " ", "computed", " ", "using", " ", "the", " ", 
      "Hamiltonian", " ", "with", " ", "its", " ", "own", " ", "parameters", 
      " ", 
      RowBox[{"hparams", ".", " ", "Beta"}], " ", "is", " ", "inverse", " ", 
      RowBox[{"temperature", ".", "\[IndentingNewLine]", "Usage"}], " ", 
      RowBox[{"ExpectationValue", "[", 
       RowBox[{"g4", ",", 
        RowBox[{"KDim", "[", "1", "]"}], ",", 
        RowBox[{"H0", "[", "1.0", "]"}], ",", "10.0"}], "]"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "result", ",", "n", ",", "nprint", ",", "boltzmanWeights", ",", 
       "partitionZ", ",", "freeF", ",", " ", "funcvalues"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "ensemble", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nprint", "=", 
       RowBox[{"n", "/", "50"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", " ", "=", " ", "0.0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"boltzmanWeights", "=", 
       RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"k", ",", "nprint"}], "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Working on energy of graph = \>\"", ",", "k"}], 
             "]"}]}], "]"}], ";"}], "*)"}], 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "beta"}], "*", 
           RowBox[{"Hamiltonian", "[", 
            RowBox[{
             RowBox[{"ensemble", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", "hparams"}], "]"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"funcvalues", "=", 
       RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"k", ",", "nprint"}], "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Working on function value of graph = \>\"", ",", "k"}], 
             "]"}]}], "]"}], ";"}], "*)"}], 
        RowBox[{
         RowBox[{"function", "[", 
          RowBox[{
           RowBox[{"ensemble", "[", 
            RowBox[{"[", "k", "]"}], "]"}], ",", "fparams"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partitionZ", "=", 
       RowBox[{"Total", "[", "boltzmanWeights", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"freeF", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1.0"}], "/", "beta"}], ")"}], "*", 
        RowBox[{"Log", "[", "partitionZ", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1.0", "/", "partitionZ"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"boltzmanWeights", ".", "funcvalues"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<boltzmanWeights \>\"", ",", " ", "boltzmanWeights"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<funcvalues \>\"", ",", " ", "funcvalues"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<partitionZ \>\"", ",", " ", "partitionZ"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<freeF \>\"", ",", " ", "freeF"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<expvalue \>\"", ",", " ", "result"}], "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"partitionZ", ",", "freeF", ",", "result"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelExpectationValue", "[", 
   RowBox[{"ensemble_", ",", "function_", ",", "Hamiltonian_", ",", "beta_"}],
    "]"}], ":=", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "computes", " ", "the", " ", "expectation", " ", "value", 
     " ", "of", " ", "the", " ", "observable", " ", "function", " ", "that", 
     " ", "needs", " ", "parameters", " ", "fparams"}], ",", " ", 
    RowBox[{
    "for", " ", "energies", " ", "computed", " ", "using", " ", "the", " ", 
     "Hamiltonian", " ", "with", " ", "its", " ", "own", " ", "parameters", 
     " ", 
     RowBox[{"hparams", ".", " ", "Beta"}], " ", "is", " ", "inverse", " ", 
     RowBox[{"temperature", ".", "\[IndentingNewLine]", "Usage"}], " ", 
     RowBox[{"ExpectationValue", "[", 
      RowBox[{"g4", ",", 
       RowBox[{"KDim", "[", "1", "]"}], ",", 
       RowBox[{"H0", "[", "1.0", "]"}], ",", "10.0"}], "]"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "result", ",", "n", ",", "nprint", ",", "boltzmanWeights", ",", 
      "partitionZ", ",", "freeF", ",", " ", "funcvalues"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "ensemble", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"nprint", "=", 
      RowBox[{"n", "/", "50"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", "0.0"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"boltzmanWeights", "=", 
      RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"k", ",", "nprint"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Working on energy of graph = \>\"", ",", "k"}], 
            "]"}]}], "]"}], ";"}], "*)"}], 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "beta"}], "*", 
          RowBox[{"Hamiltonian", "[", 
           RowBox[{"ensemble", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"funcvalues", "=", 
      RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"k", ",", "nprint"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Working on function value of graph = \>\"", ",", "k"}], 
            "]"}]}], "]"}], ";"}], "*)"}], 
       RowBox[{
        RowBox[{"function", "[", 
         RowBox[{"ensemble", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partitionZ", "=", 
      RowBox[{"Total", "[", "boltzmanWeights", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"freeF", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1.0"}], "/", "beta"}], ")"}], "*", 
       RowBox[{"Log", "[", "partitionZ", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1.0", "/", "partitionZ"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"boltzmanWeights", ".", "funcvalues"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<boltzmanWeights \>\"", ",", " ", "boltzmanWeights"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<funcvalues \>\"", ",", " ", "funcvalues"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<partitionZ \>\"", ",", " ", "partitionZ"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<freeF \>\"", ",", " ", "freeF"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<expvalue \>\"", ",", " ", "result"}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"partitionZ", ",", "freeF", ",", "result"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.728939316163528*^9, 3.728939391669297*^9}, {
   3.728939556117547*^9, 3.728939676544958*^9}, {3.728939741539773*^9, 
   3.728939845607884*^9}, {3.728940057852396*^9, 3.7289400641311502`*^9}, {
   3.728940104806961*^9, 3.728940159566787*^9}, {3.728940621794004*^9, 
   3.7289406259467373`*^9}, {3.7289406883810062`*^9, 3.728940746205003*^9}, {
   3.728943373330677*^9, 3.728943378425359*^9}, {3.728943427726066*^9, 
   3.728943433188465*^9}, {3.728943525674787*^9, 3.7289436328911877`*^9}, {
   3.728944194191009*^9, 3.728944416676358*^9}, {3.72894445277485*^9, 
   3.728944472704481*^9}, {3.728944510415411*^9, 3.728944622417694*^9}, {
   3.728944710335339*^9, 3.728944757159457*^9}, {3.728944806954382*^9, 
   3.728944811857716*^9}, 3.728944849144582*^9, {3.7289453844765673`*^9, 
   3.7289454975829697`*^9}, {3.728945742356427*^9, 3.728945745335644*^9}, {
   3.72900926831102*^9, 3.7290092751972847`*^9}, {3.729009682935623*^9, 
   3.729009691499091*^9}, {3.729009789435227*^9, 3.7290098318350782`*^9}, {
   3.7290098886454887`*^9, 3.729009992492117*^9}, {3.729010140645849*^9, 
   3.72901014188638*^9}, {3.72901020442397*^9, 3.729010207424861*^9}, {
   3.729023443173615*^9, 3.7290234519950533`*^9}, {3.7290335604687033`*^9, 
   3.7290335720670023`*^9}, {3.729254638313065*^9, 3.7292546587472887`*^9}, {
   3.729254720519292*^9, 3.729254920648892*^9}, {3.729254960312044*^9, 
   3.7292549660790453`*^9}, {3.729255046847575*^9, 3.7292550511962557`*^9}, {
   3.729255129018457*^9, 3.7292551396501007`*^9}, {3.72925540681045*^9, 
   3.729255418399568*^9}, {3.729255874732621*^9, 3.729255908887309*^9}, {
   3.729255977447002*^9, 3.7292559786042433`*^9}, {3.729256420834078*^9, 
   3.729256447223699*^9}, {3.7292573590658627`*^9, 3.729257371960018*^9}, {
   3.729437649904258*^9, 3.7294377061477757`*^9}, {3.729441064912859*^9, 
   3.729441066159484*^9}, {3.729441125373417*^9, 3.7294411319567747`*^9}, {
   3.729441415931553*^9, 3.729441427082144*^9}, {3.729446705696979*^9, 
   3.7294468188836946`*^9}, 3.729447458551021*^9, {3.729625452567629*^9, 
   3.729625458158162*^9}, {3.729625538636194*^9, 3.729625575435081*^9}, {
   3.729625635175633*^9, 3.729625661950721*^9}, {3.730226072067178*^9, 
   3.730226072721979*^9}, {3.7302261109848423`*^9, 3.7302261600554953`*^9}, {
   3.735406827775249*^9, 
   3.7354068286927547`*^9}},ExpressionUUID->"5cde0346-4b7e-4b62-8f31-\
a080b8bf9178"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Clear", "[", "ExpectationValue", "]"}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExpectationValue", "[", 
     RowBox[{"ensemble_", ",", 
      RowBox[{"function_", "[", "fparams__", "]"}], ",", 
      RowBox[{"Hamiltonian_", "[", "hparams__", "]"}], ",", "beta_"}], "]"}], 
    ":=", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "This", " ", "computes", " ", "the", " ", "expectation", " ", "value", 
       " ", "of", " ", "the", " ", "observable", " ", "function", " ", "that",
        " ", 
       RowBox[{"doesn", "'"}], "t", " ", "have", " ", "inpute", " ", 
       "parameters", " ", "but", " ", "can", " ", "be", " ", "vector", " ", 
       "valued"}], ",", " ", 
      RowBox[{
      "for", " ", "energies", " ", "computed", " ", "using", " ", "the", " ", 
       "Hamiltonian", " ", "with", " ", "its", " ", "own", " ", "parameters", 
       " ", 
       RowBox[{"hparams", ".", " ", "Beta"}], " ", "is", " ", "inverse", " ", 
       
       RowBox[{"temperature", ".", "\[IndentingNewLine]", "Usage"}], " ", 
       RowBox[{"ExpectationValue", "[", 
        RowBox[{"g4", ",", "KDim", ",", 
         RowBox[{"H0", "[", "1.0", "]"}], ",", "10.0"}], "]"}]}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "result", ",", "n", ",", "nprint", ",", "kernels", ",", 
        "currentNumber", ",", "boltzmanWeights", ",", "partitionZ", ",", 
        "freeF", ",", " ", "funcvalues"}], "}"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "ensemble", "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", "10000"}], ";", "\[IndentingNewLine]", 
       RowBox[{"nprint", "=", "100000"}], ";", "\[IndentingNewLine]", 
       RowBox[{"result", " ", "=", " ", "0.0"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"kernels", "=", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"$KernelID", "\[Rule]", "i"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "$KernelCount"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SetSharedVariable", "[", "kernels", "]"}], ";", 
         RowBox[{"SetSharedVariable", "[", "currentNumber", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"currentNumber", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "@", "kernels"}]}], "]"}]}], ";", "\n", 
         "\[IndentingNewLine]", 
         RowBox[{
         "PrintTemporary", "[", "\"\<Current calculations:\>\"", "]"}], ";", 
         RowBox[{"PrintTemporary", "@", 
          RowBox[{"Dynamic", "[", "currentNumber", "]"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"boltzmanWeights", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"k", ",", "nprint"}], "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"currentNumber", "[", 
               RowBox[{"[", 
                RowBox[{"$KernelID", "/.", "kernels"}], "]"}], "]"}], "=", 
              "k"}]}], "]"}], ";"}], "*)"}], 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"k", ",", "nprint"}], "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Working on energy of graph \>\"", ",", "k"}], 
              "]"}]}], "]"}], ";", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "beta"}], "*", 
             RowBox[{"Hamiltonian", "[", 
              RowBox[{
               RowBox[{"ensemble", "[", 
                RowBox[{"[", "k", "]"}], "]"}], ",", "hparams"}], "]"}]}], 
            "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"funcvalues", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"k", ",", "nprint"}], "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"currentNumber", "[", 
               RowBox[{"[", 
                RowBox[{"$KernelID", "/.", "kernels"}], "]"}], "]"}], "=", 
              "k"}]}], "]"}], ";"}], "*)"}], 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"k", ",", "nprint"}], "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Working on function value of graph = \>\"", ",", "k"}], 
              "]"}]}], "]"}], ";", 
           RowBox[{"function", "[", 
            RowBox[{
             RowBox[{"ensemble", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", "fparams"}], "]"}]}], ",", 
          
          RowBox[{"{", 
           RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"partitionZ", "=", 
        RowBox[{"Total", "[", "boltzmanWeights", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"freeF", "=", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Log", "[", "partitionZ", "]"}]}], "/", "beta"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1.0", "/", "partitionZ"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"boltzmanWeights", ".", "funcvalues"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<boltzmanWeights \>\"", ",", " ", "boltzmanWeights"}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<funcvalues \>\"", ",", " ", "funcvalues"}], "]"}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<partitionZ \>\"", ",", " ", "partitionZ"}], "]"}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<freeF \>\"", ",", " ", "freeF"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<expvalue \>\"", ",", " ", "result"}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"partitionZ", ",", "freeF", ",", "result"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7290095442739773`*^9, 3.729009548899184*^9}, {
   3.729009674782712*^9, 3.7290097113712807`*^9}, {3.729010002661334*^9, 
   3.729010043160241*^9}, {3.7290102112939377`*^9, 3.7290102138273973`*^9}, {
   3.729023180858129*^9, 3.729023199696007*^9}, {3.729023276090564*^9, 
   3.729023280089484*^9}, {3.72902342354873*^9, 3.729023427626709*^9}, {
   3.729033537854773*^9, 3.72903354686934*^9}, {3.729255065060163*^9, 
   3.7292551181298037`*^9}, {3.7292551592817097`*^9, 3.729255167360813*^9}, {
   3.7292559869898443`*^9, 3.7292559892922487`*^9}, {3.729256025196059*^9, 
   3.7292560763574057`*^9}, {3.729256381443472*^9, 3.729256413777001*^9}, {
   3.729256892194888*^9, 3.7292569414557257`*^9}, {3.729256973030286*^9, 
   3.729257057667049*^9}, {3.729257153785017*^9, 3.729257177902752*^9}, {
   3.729257210374034*^9, 3.729257210773509*^9}, 3.729257255302307*^9, {
   3.729257445239264*^9, 3.7292574714616747`*^9}, {3.729257501581389*^9, 
   3.729257501899721*^9}, {3.729261757957992*^9, 3.729261766628812*^9}, {
   3.7292618039474154`*^9, 3.729261897720893*^9}, {3.729261999062834*^9, 
   3.729261999707933*^9}, {3.7292620409567623`*^9, 3.729262041665924*^9}, {
   3.729262077674604*^9, 3.729262078712719*^9}, {3.729262141912356*^9, 
   3.7292621553186283`*^9}, {3.729262196686225*^9, 3.729262207204279*^9}, {
   3.729262310490404*^9, 3.729262404054022*^9}, {3.729262450909635*^9, 
   3.729262458459795*^9}, {3.7292627426982822`*^9, 3.7292627428327637`*^9}, {
   3.729262837621971*^9, 3.729262876779854*^9}, {3.729263900143241*^9, 
   3.729263900612277*^9}, {3.729263980571177*^9, 3.729263981160919*^9}, {
   3.7292640422498493`*^9, 3.729264047590391*^9}, 3.729272524728307*^9, {
   3.7292778094529877`*^9, 3.729277841572441*^9}, {3.729277877595536*^9, 
   3.7292779218337173`*^9}, {3.729277985928059*^9, 3.729277987758133*^9}, {
   3.7292780917550898`*^9, 3.729278095067753*^9}, {3.729278210272493*^9, 
   3.72927828066227*^9}, {3.729278654529817*^9, 3.729278666766975*^9}, {
   3.729279039128956*^9, 3.72927904035096*^9}, {3.7292820758996*^9, 
   3.7292820850968122`*^9}, {3.729282378470663*^9, 3.729282378662003*^9}, 
   3.729290689193757*^9, {3.729293635623386*^9, 3.729293635781085*^9}, {
   3.729294023929817*^9, 3.729294025375567*^9}, {3.729295214548571*^9, 
   3.72929522504251*^9}, {3.729295593343354*^9, 3.729295599876767*^9}, {
   3.729295819470676*^9, 3.7292958219011593`*^9}, {3.7292959675227537`*^9, 
   3.729295976127684*^9}, {3.729296062566855*^9, 3.729296069051815*^9}, {
   3.729296370525578*^9, 3.7292963708810997`*^9}, {3.729440980253134*^9, 
   3.729441009737343*^9}, {3.729441482572269*^9, 3.72944149048286*^9}, 
   3.729446858875843*^9, {3.7294500302056713`*^9, 3.7294500383285513`*^9}, 
   3.735406829966783*^9},ExpressionUUID->"abbd1477-4177-4726-91d5-\
afbdbfff524b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "ExpectationValue", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpectationValue", "[", 
   RowBox[{"ensemble_", ",", "function_", ",", 
    RowBox[{"Hamiltonian_", "[", "hparams__", "]"}], ",", "beta_"}], "]"}], ":=", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "computes", " ", "the", " ", "expectation", " ", "value", 
     " ", "of", " ", "the", " ", "observable", " ", "function", " ", "that", 
     " ", 
     RowBox[{"doesn", "'"}], "t", " ", "have", " ", "inpute", " ", 
     "parameters", " ", "but", " ", "can", " ", "be", " ", "vector", " ", 
     "valued"}], ",", " ", 
    RowBox[{
    "for", " ", "energies", " ", "computed", " ", "using", " ", "the", " ", 
     "Hamiltonian", " ", "with", " ", "its", " ", "own", " ", "parameters", 
     " ", 
     RowBox[{"hparams", ".", " ", "Beta"}], " ", "is", " ", "inverse", " ", 
     RowBox[{"temperature", ".", "\[IndentingNewLine]", "Usage"}], " ", 
     RowBox[{"ExpectationValue", "[", 
      RowBox[{"g4", ",", "KDim", ",", 
       RowBox[{"H0", "[", "1.0", "]"}], ",", "10.0"}], "]"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "result", ",", "n", ",", "nprint", ",", "kernels", ",", "currentNumber", 
      ",", "boltzmanWeights", ",", "partitionZ", ",", "freeF", ",", " ", 
      "funcvalues"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "ensemble", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"n", "=", "10000"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"nprint", "=", "100000"}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", "0.0"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"kernels", "=", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"$KernelID", "\[Rule]", "i"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "$KernelCount"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SetSharedVariable", "[", "kernels", "]"}], ";", 
       RowBox[{"SetSharedVariable", "[", "currentNumber", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"currentNumber", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Length", "@", "kernels"}]}], "]"}]}], ";", "\n", 
       "\[IndentingNewLine]", 
       RowBox[{"PrintTemporary", "[", "\"\<Current calculations:\>\"", "]"}], 
       ";", 
       RowBox[{"PrintTemporary", "@", 
        RowBox[{"Dynamic", "[", "currentNumber", "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"boltzmanWeights", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"k", ",", "nprint"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"currentNumber", "[", 
             RowBox[{"[", 
              RowBox[{"$KernelID", "/.", "kernels"}], "]"}], "]"}], "=", 
            "k"}]}], "]"}], ";"}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"k", ",", "nprint"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Working on energy of graph \>\"", ",", "k"}], 
            "]"}]}], "]"}], ";", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "beta"}], "*", 
           RowBox[{"Hamiltonian", "[", 
            RowBox[{
             RowBox[{"ensemble", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", "hparams"}], "]"}]}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"funcvalues", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"k", ",", "nprint"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"currentNumber", "[", 
             RowBox[{"[", 
              RowBox[{"$KernelID", "/.", "kernels"}], "]"}], "]"}], "=", 
            "k"}]}], "]"}], ";"}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"k", ",", "nprint"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Working on function value of graph = \>\"", ",", "k"}], 
            "]"}]}], "]"}], ";", 
         RowBox[{"function", "[", 
          RowBox[{"ensemble", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partitionZ", "=", 
      RowBox[{"Total", "[", "boltzmanWeights", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"freeF", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Log", "[", "partitionZ", "]"}]}], "/", "beta"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1.0", "/", "partitionZ"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"boltzmanWeights", ".", "funcvalues"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<boltzmanWeights \>\"", ",", " ", "boltzmanWeights"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<funcvalues \>\"", ",", " ", "funcvalues"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<partitionZ \>\"", ",", " ", "partitionZ"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<freeF \>\"", ",", " ", "freeF"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<expvalue \>\"", ",", " ", "result"}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"partitionZ", ",", "freeF", ",", "result"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.7290095442739773`*^9, 3.729009548899184*^9}, {
   3.729009674782712*^9, 3.7290097113712807`*^9}, {3.729010002661334*^9, 
   3.729010043160241*^9}, {3.7290102112939377`*^9, 3.7290102138273973`*^9}, {
   3.729023180858129*^9, 3.729023199696007*^9}, {3.729023276090564*^9, 
   3.729023280089484*^9}, {3.72902342354873*^9, 3.729023427626709*^9}, {
   3.729033537854773*^9, 3.72903354686934*^9}, {3.729255065060163*^9, 
   3.7292551181298037`*^9}, {3.7292551592817097`*^9, 3.729255167360813*^9}, {
   3.7292559869898443`*^9, 3.7292559892922487`*^9}, {3.729256025196059*^9, 
   3.7292560763574057`*^9}, {3.729256381443472*^9, 3.729256413777001*^9}, {
   3.729256892194888*^9, 3.7292569414557257`*^9}, {3.729256973030286*^9, 
   3.729257057667049*^9}, {3.729257153785017*^9, 3.729257177902752*^9}, {
   3.729257210374034*^9, 3.729257210773509*^9}, 3.729257255302307*^9, {
   3.729257445239264*^9, 3.7292574714616747`*^9}, {3.729257501581389*^9, 
   3.729257501899721*^9}, {3.729261757957992*^9, 3.729261766628812*^9}, {
   3.7292618039474154`*^9, 3.729261897720893*^9}, {3.729261999062834*^9, 
   3.729261999707933*^9}, {3.7292620409567623`*^9, 3.729262041665924*^9}, {
   3.729262077674604*^9, 3.729262078712719*^9}, {3.729262141912356*^9, 
   3.7292621553186283`*^9}, {3.729262196686225*^9, 3.729262207204279*^9}, {
   3.729262310490404*^9, 3.729262404054022*^9}, {3.729262450909635*^9, 
   3.729262458459795*^9}, {3.7292627426982822`*^9, 3.7292627428327637`*^9}, {
   3.729262837621971*^9, 3.729262876779854*^9}, {3.729263900143241*^9, 
   3.729263900612277*^9}, {3.729263980571177*^9, 3.729263981160919*^9}, {
   3.7292640422498493`*^9, 3.729264047590391*^9}, 3.729272524728307*^9, {
   3.7292778094529877`*^9, 3.729277841572441*^9}, {3.729277877595536*^9, 
   3.7292779218337173`*^9}, {3.729277985928059*^9, 3.729277987758133*^9}, {
   3.7292780917550898`*^9, 3.729278095067753*^9}, {3.729278210272493*^9, 
   3.72927828066227*^9}, {3.729278654529817*^9, 3.729278666766975*^9}, {
   3.729279039128956*^9, 3.72927904035096*^9}, {3.7292820758996*^9, 
   3.7292820850968122`*^9}, {3.729282378470663*^9, 3.729282378662003*^9}, 
   3.729290689193757*^9, {3.729293635623386*^9, 3.729293635781085*^9}, {
   3.729294023929817*^9, 3.729294025375567*^9}, {3.729295214548571*^9, 
   3.72929522504251*^9}, {3.729295593343354*^9, 3.729295599876767*^9}, {
   3.729295819470676*^9, 3.7292958219011593`*^9}, {3.7292959675227537`*^9, 
   3.729295976127684*^9}, {3.729296062566855*^9, 3.729296069051815*^9}, {
   3.729296370525578*^9, 3.7292963708810997`*^9}, {3.729440980253134*^9, 
   3.729441009737343*^9}, {3.729441482572269*^9, 3.72944149048286*^9}, 
   3.729446858875843*^9, {3.729449596788113*^9, 3.729449619642105*^9}, 
   3.735406834681799*^9},ExpressionUUID->"91526297-7bf9-4ece-a67d-\
f15e435896d9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Partition Function", "Subsubsection",
 CellChangeTimes->{{3.685309706000251*^9, 
  3.685309709279347*^9}},ExpressionUUID->"03aecaaf-6bef-4364-bb06-\
3b604533f9fd"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "partitionf", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"partitionf", "[", 
    RowBox[{"n_", ",", "h_", ",", "\[Beta]_", ",", 
     RowBox[{"cH0_:", "1"}], ",", 
     RowBox[{"cH1_:", "0"}], ",", 
     RowBox[{"cH2_:", "0"}], ",", 
     RowBox[{"csource_:", "0"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nentries", ",", "totNumOfG", ",", "i", ",", "aijs", ",", "oneg", ",", 
       "ge", ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nentries", "=", 
       RowBox[{"n", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], "/", "2"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"totNumOfG", "=", 
       RowBox[{"2", "^", "nentries"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "0"}], ",", 
        RowBox[{"i", "<", "totNumOfG"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"i", ",", "500000"}], "]"}], "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Working on graph \>\"", ",", "i"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", "result", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"aijs", "=", 
          RowBox[{"IntegerDigits", "[", 
           RowBox[{"i", ",", "2", ",", "nentries"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"oneg", "=", 
          RowBox[{"MakeAmat", "[", 
           RowBox[{"aijs", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ge", "=", 
          RowBox[{
           RowBox[{"cH0", "*", 
            RowBox[{"H0", "[", "oneg", "]"}]}], "+", 
           RowBox[{"cH1", "*", 
            RowBox[{"H1", "[", "oneg", "]"}]}], "+", 
           RowBox[{"cH2", "*", 
            RowBox[{"H2", "[", "oneg", "]"}]}], "+", 
           RowBox[{"csource", "*", 
            RowBox[{"Hsource", "[", 
             RowBox[{"oneg", ",", "h"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"result", " ", "=", " ", 
          RowBox[{"result", "+", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "\[Beta]"}], "*", "ge"}], "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "result"}]}],
     "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.682805940017354*^9, 3.682805942008106*^9}, {
   3.682806297257209*^9, 3.682806455517911*^9}, {3.682806490141591*^9, 
   3.6828064938359756`*^9}, {3.682806634125609*^9, 3.6828066814010677`*^9}, {
   3.682806752924185*^9, 3.6828067752355757`*^9}, {3.6828068092604856`*^9, 
   3.682806824498953*^9}, {3.682806911982266*^9, 3.682806948168885*^9}, {
   3.682806986357129*^9, 3.6828069941811447`*^9}, {3.6831334125011806`*^9, 
   3.683133507672504*^9}, {3.683133621953486*^9, 3.68313362264815*^9}, 
   3.686177833298007*^9, 
   3.7289424361690903`*^9},ExpressionUUID->"430d88c7-7236-4358-8a65-\
db6b159b4a33"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "expVal", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expVal", "[", 
    RowBox[{"operator_", ",", "n_", ",", "h_", ",", "\[Beta]_", ",", 
     RowBox[{"cH0_:", "1"}], ",", 
     RowBox[{"cH1_:", "0"}], ",", 
     RowBox[{"cH2_:", "0"}], ",", 
     RowBox[{"csource_:", "0"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nentries", ",", "totNumOfG", ",", "i", ",", "aijs", ",", "oneg", ",", 
       "opval", ",", "boltzmanWeight", ",", "ge", ",", "ge0", ",", "ge1", ",",
        "ge2", ",", "gesource", ",", "hlist", ",", "num", ",", "denom", ",", 
       "result"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nentries", "=", 
       RowBox[{"n", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], "/", "2"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"totNumOfG", "=", 
       RowBox[{"2", "^", "nentries"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"num", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"denom", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"for", " ", "each", " ", "of", 
        RowBox[{"{", 
         RowBox[{"H0", ",", "H1", ",", "H2", ",", "Hsource", ",", "Htot"}], 
         "}"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ge0", "=", 
       RowBox[{"ge1", "=", 
        RowBox[{"ge2", "=", 
         RowBox[{"gesource", "=", "0"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "0"}], ",", 
        RowBox[{"i", "<", "totNumOfG"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"i", ",", "10000"}], "]"}], "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Working on graph \>\"", ",", "i"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"hlist", "=", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
         ";", 
         RowBox[{"(*", 
          RowBox[{"{", 
           RowBox[{
           "ge0", ",", "ge1", ",", "ge2", ",", "gesource", ",", "ge"}], "}"}],
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{"aijs", "=", 
          RowBox[{"IntegerDigits", "[", 
           RowBox[{"i", ",", "2", ",", "nentries"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"oneg", "=", 
          RowBox[{"MakeAmat", "[", "aijs", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"AdjacencyGraph", "[", 
             RowBox[{"oneg", ",", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"65", ",", "65"}], "}"}]}]}], "]"}], "]"}], ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"ge", "=", 
            RowBox[{
             RowBox[{"clap", "*", 
              RowBox[{"H1", "[", "oneg", "]"}]}], "+", 
             RowBox[{"csource", "*", 
              RowBox[{"Hsource", "[", 
               RowBox[{"oneg", ",", "h"}], "]"}]}]}]}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"ge0", "=", 
          RowBox[{"cH0", "*", 
           RowBox[{"H0", "[", "oneg", "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ge1", "=", 
          RowBox[{"cH1", "*", 
           RowBox[{"H1", "[", "oneg", "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ge2", "=", 
          RowBox[{"cH2", "*", 
           RowBox[{"H2", "[", "oneg", "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"gesource", "=", 
          RowBox[{"csource", "*", 
           RowBox[{"Hsource", "[", 
            RowBox[{"oneg", ",", "h"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"ge", "=", 
            RowBox[{"ge0", "+", "ge1", "+", "ge2", "+", "gesource"}]}], ";"}],
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{"ge", "=", 
          RowBox[{"ge0", "+", "ge2", "+", "gesource"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"hlist", "=", 
          RowBox[{"{", 
           RowBox[{
           "ge0", ",", "ge1", ",", "ge2", ",", "gesource", ",", "ge"}], 
           "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<hlist \>\"", ",", "hlist"}], "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"boltzmanWeight", "=", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "\[Beta]"}], "*", "hlist"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"opval", "=", 
          RowBox[{
           RowBox[{"operator", "[", "oneg", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<opval \>\"", ",", "opval"}], "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"num", "=", 
          RowBox[{"num", "+", 
           RowBox[{"opval", "*", "boltzmanWeight"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
             RowBox[{"AdjacencyGraph", "[", 
              RowBox[{"oneg", ",", 
               RowBox[{"ImageSize", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"50", ",", "50"}], "}"}]}]}], "]"}], ",", 
             "\"\< opval =\>\"", ",", "opval", ",", "\"\< ge = \>\"", ",", 
             "ge", ",", "\"\< boltzman weight = \>\"", ",", 
             "boltzmanWeight"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<num ->\>\"", ",", "num"}], "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"denom", "=", 
          RowBox[{"denom", "+", "boltzmanWeight"}]}]}]}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<num : \>\"", ",", "num", ",", " ", "\"\< denom : \>\"", ",", 
           "denom"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"num", "/", "denom"}]}], ";", "\[IndentingNewLine]", 
      "result"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.682807020613433*^9, 3.6828070460477343`*^9}, {
   3.682807181357275*^9, 3.682807401570963*^9}, {3.682807456622615*^9, 
   3.682807457486072*^9}, {3.682807515691786*^9, 3.6828075167703657`*^9}, {
   3.682808814398768*^9, 3.68280889074054*^9}, {3.682809046143662*^9, 
   3.682809078675887*^9}, {3.682809171821459*^9, 3.6828093095617933`*^9}, {
   3.68280936307917*^9, 3.682809407582979*^9}, {3.6828098559344482`*^9, 
   3.682809876829835*^9}, {3.682810619585124*^9, 3.6828106213684072`*^9}, {
   3.6828106876061373`*^9, 3.682810742848421*^9}, {3.682810869814157*^9, 
   3.682810870980708*^9}, 3.68296377833075*^9, {3.683129595971342*^9, 
   3.6831296571126842`*^9}, {3.6831302465289593`*^9, 3.683130378126272*^9}, {
   3.683130427163644*^9, 3.683130427506872*^9}, {3.683131073491969*^9, 
   3.6831311229152946`*^9}, {3.683131462190803*^9, 3.683131524564084*^9}, {
   3.683131670755508*^9, 3.6831316833387423`*^9}, {3.6831322519147453`*^9, 
   3.683132252874219*^9}, {3.683132313516013*^9, 3.683132427687735*^9}, {
   3.683132463051079*^9, 3.683132478973155*^9}, {3.68313255724063*^9, 
   3.683132582926639*^9}, {3.68313261750454*^9, 3.683132687589231*^9}, {
   3.683132717678525*^9, 3.683132801491596*^9}, {3.683132875685733*^9, 
   3.68313287658181*^9}, {3.683132941196145*^9, 3.683132965028784*^9}, {
   3.683133012507503*^9, 3.683133029115016*^9}, {3.683133089854266*^9, 
   3.683133099925981*^9}, {3.6831331833354588`*^9, 3.683133184910282*^9}, {
   3.6831332155420713`*^9, 3.683133236133299*^9}, {3.683133272271804*^9, 
   3.683133274495043*^9}, {3.6831333071655273`*^9, 3.683133344019828*^9}, {
   3.683133651349753*^9, 3.6831336573803596`*^9}, {3.683133698389083*^9, 
   3.683133721261572*^9}, {3.683133864683641*^9, 3.683133868123558*^9}, {
   3.6831340476276608`*^9, 3.683134050266942*^9}, {3.6831341643086357`*^9, 
   3.68313418168449*^9}, {3.683134506887804*^9, 3.6831345329097548`*^9}, 
   3.6831350187878237`*^9, {3.6831355287353983`*^9, 3.683135543720159*^9}, 
   3.686177856344137*^9, 
   3.728942436666503*^9},ExpressionUUID->"a5d6153e-be17-482b-8700-\
f8bef05e35f3"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Monte Carlo", "Section",
 CellChangeTimes->{{3.719958699943778*^9, 
  3.719958711326543*^9}},ExpressionUUID->"b05cac38-e026-49bd-a9c8-\
974f07c8efd7"],

Cell[CellGroupData[{

Cell["Metropolis", "Subsection",
 CellChangeTimes->{{3.7290118702847023`*^9, 
  3.729011885978629*^9}},ExpressionUUID->"b4e7ac58-7238-4817-9518-\
f9533fd990c3"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Metropolis", "[", 
    RowBox[{
    "N_", ",", "beta_", ",", "J_", ",", " ", "observables_", ",", 
     "maxSweep_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "edgeMax", ",", "ParallelSow", ",", "graphMax", ",", "expDEVals", ",", 
       "initialize", ",", "sweep", ",", "numsweeps", ",", "Amat"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"edgeMax", "=", 
       RowBox[{"N", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"N", "-", "1"}], ")"}], "/", "2"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"graphMax", "=", 
       RowBox[{"2", "^", "edgeMax"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Amat", "=", 
         RowBox[{"MakeAmat", "[", 
          RowBox[{"IntegerDigits", "[", 
           RowBox[{
            RowBox[{"RandomInteger", "[", 
             RowBox[{"graphMax", "-", "1"}], "]"}], ",", "2", ",", 
            "edgeMax"}], "]"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Amat", "=", 
       RowBox[{"MakeKn", "[", "N", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Source Amat\>\"", ",", 
        RowBox[{"AdjacencyGraph", "[", "Amat", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"expDEVals", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2.0", "aij"}], "-", "1.0"}], ")"}], "*", "2.0", "*", 
            "J", "*", "beta", "*", 
            RowBox[{"(", 
             RowBox[{"daPdb", "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2.0", "/", "N"}], ")"}], "totDeg"}]}], ")"}]}], 
           "]"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "2.0"}], "beta", "*", "J", "*", 
            RowBox[{"(", 
             RowBox[{"N", "-", "2.0"}], ")"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"N", "-", "1.0"}], ")"}], "/", "N"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"aij", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"daPdb", ",", "0", ",", 
           RowBox[{"2.0", 
            RowBox[{"(", 
             RowBox[{"N", "-", "1.0"}], ")"}]}], ",", "1.0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"totDeg", ",", "0", ",", 
           RowBox[{"N", "*", 
            RowBox[{"(", 
             RowBox[{"N", "-", "1.0"}], ")"}]}], ",", "1.0"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "expDEVals", "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"Print", "[", 
         RowBox[{"AdjacencyGraph", "[", "Amat", "]"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sweep", "[", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "l", ",", "lp", ",", "m", ",", "i", ",", "j", ",", "diPdj", ",", 
           "dtot", ",", "edge2bDeleted", ",", "deltaE", ",", "expBetaDE", ",",
            "accept"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Reap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"l", "=", 
               RowBox[{"RandomInteger", "[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "edgeMax"}], "}"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"lp", "=", 
               RowBox[{"edgeMax", "+", "1", "-", "l"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"m", "=", "0"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<before \>\"", ",", 
                  RowBox[{"Amat", "//", "MatrixForm"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<l \>\"", ",", "l", ",", "\"\< lp \>\"", ",", "lp"}], 
                 "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"While", "[", 
               RowBox[{
                RowBox[{"lp", ">", "0"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"m", "++"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"lp", "-=", 
                  RowBox[{"N", "-", "m"}]}], ";"}]}], "\[IndentingNewLine]", 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"j", "=", 
               RowBox[{"N", "+", "1", "-", "m"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"i", "=", 
               RowBox[{"l", "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"j", "-", "1"}], ")"}], 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"j", "-", "2"}], ")"}], "/", "2"}]}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"diPdj", "=", 
               RowBox[{
                RowBox[{"Deg", "[", 
                 RowBox[{"Amat", ",", "i"}], "]"}], "+", 
                RowBox[{"Deg", "[", 
                 RowBox[{"Amat", ",", "j"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"dtot", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"Valencyvec", "[", "Amat", "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"edge2bDeleted", "=", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2.0", "*", 
                  RowBox[{"Amat", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "-", "1.0"}], 
                ")"}]}], ";", " ", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "if", " ", "Aij", " ", "is", " ", "1", " ", "edge", " ", 
                   "will", "  ", "be", " ", "deleted", " ", "and", " ", 
                   "sign", " ", "in", " ", "deltaE", " ", "will", " ", "be"}],
                   " ", "+", "1"}], ";", " ", 
                 RowBox[{"if", " ", "Aij", " ", "is", " ", "0"}]}], ",", " ", 
                
                RowBox[{
                "edge", " ", "will", " ", "not", " ", "be", " ", "deleted"}], 
                ",", " ", 
                RowBox[{
                "and", " ", "sign", " ", "in", " ", "deltaE", " ", "will", 
                 " ", "be", " ", "minus", " ", 
                 RowBox[{"1", " ", ".", " ", "edge2bDeleted"}], " ", "is", 
                 " ", "pm", " ", "1", " ", "corresponding", " ", "to", " ", 
                 "the", " ", "sign", " ", "of", " ", "delta", " ", "E"}]}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"deltaE", "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{"N", "-", "2.0"}], ")"}]}], "/", "N"}], ")"}], 
                "+", 
                RowBox[{"edge2bDeleted", 
                 RowBox[{"(", 
                  RowBox[{"diPdj", "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2.0", "/", "N"}], ")"}], "*", "dtot"}]}], 
                  ")"}]}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"expBetaDE", "=", 
               RowBox[{"expDEVals", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Amat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", "1"}], ",", 
                  RowBox[{"diPdj", "+", "1"}], ",", 
                  RowBox[{"dtot", "+", "1"}]}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"deltaE", "<", "0"}], ",", 
                  RowBox[{"Print", "[", 
                   RowBox[{"\"\<deltaE \>\"", ",", "deltaE"}], "]"}]}], "]"}],
                 ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"deltaE", ">", "0"}], "&"}], "expBetaDE"}], ">", 
                 "1"}], ",", 
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Error! deltaE = \>\"", ",", "deltaE", ",", 
                  "\"\< expBetaDE = \>\"", ",", "expBetaDE"}], "]"}]}], " ", 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"accept", "=", "False"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"deltaE", "<=", "0"}], ",", 
                RowBox[{"accept", "=", "True"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"RandomReal", "[", "]"}], "<", "expBetaDE"}], ",", 
                  
                  RowBox[{"accept", "=", "True"}]}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{"accept", ",", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{
                   "\"\<j \>\"", ",", "j", ",", "\"\< i \>\"", ",", "i"}], 
                   "]"}], ";"}], "*)"}], 
                RowBox[{
                 RowBox[{
                  RowBox[{"Amat", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Amat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", "1"}], ",", 
                    "2"}], "]"}]}], ";", 
                 RowBox[{
                  RowBox[{"Amat", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", 
                  RowBox[{"Amat", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}]}], 
               "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<after \>\"", ",", 
                 RowBox[{"Amat", "//", "MatrixForm"}]}], "]"}], ";"}], "*)"}],
              "\[IndentingNewLine]", "edgeMax"}], "\[IndentingNewLine]", 
            "]"}], ";"}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"numsweeps", "=", "0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"SetSharedFunction", "[", "ParallelSow", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ParallelSow", "[", "expr_", "]"}], ":=", 
       RowBox[{"Sow", "[", "expr", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"DistributeDefinitions", "[", "sweep", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetSharedVariable", "[", "Amat", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Reap", "[", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sweep", "[", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"numsweeps", "++"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"numsweeps", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{"ParallelSow", "[", 
             RowBox[{"AdjacencyGraph", "[", 
              RowBox[{"Amat", ",", 
               RowBox[{"ImageSize", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"140", ",", "140"}], "}"}]}]}], "]"}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"numsweeps", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{"ParallelSow", "[", 
             RowBox[{"H0", "[", 
              RowBox[{"Amat", ",", "J"}], "]"}], "]"}]}], 
           "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
         "maxSweep"}], "]"}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.729011911924306*^9, 3.729011989177074*^9}, {
   3.729012137727057*^9, 3.729012206439478*^9}, {3.7290163687409897`*^9, 
   3.7290164245971603`*^9}, {3.7290210483041162`*^9, 3.729021054667951*^9}, 
   3.729021332583931*^9, {3.730299086117556*^9, 3.730299109912243*^9}, {
   3.7302995982335863`*^9, 3.730299599911676*^9}, {3.730299646878902*^9, 
   3.7302996683919153`*^9}, {3.730299851105*^9, 3.730299863972591*^9}, {
   3.730300135919992*^9, 3.730300192043455*^9}, {3.730305943063089*^9, 
   3.730306025830887*^9}, 3.730306181541602*^9, {3.730306222618163*^9, 
   3.730306263034152*^9}, {3.7303063883570023`*^9, 3.730306410916122*^9}, {
   3.730306455434614*^9, 3.7303064579336033`*^9}, {3.73030649386791*^9, 
   3.73030650912265*^9}, {3.730306543880773*^9, 3.7303065961639767`*^9}, 
   3.730306669149777*^9, {3.7303135698239937`*^9, 3.730313761552574*^9}, {
   3.7303138065569763`*^9, 3.7303139597372704`*^9}, {3.730314016294269*^9, 
   3.730314041118734*^9}, {3.730314097184043*^9, 3.7303141958648567`*^9}, {
   3.730314335825444*^9, 3.730314399043655*^9}, {3.7303144306143627`*^9, 
   3.730314442818921*^9}, 3.730314473015115*^9, 3.730314707037998*^9, {
   3.730314923365057*^9, 3.730314938823072*^9}, {3.730315044946463*^9, 
   3.7303150583965178`*^9}, {3.730315096366252*^9, 3.730315169453223*^9}, {
   3.730315291163644*^9, 3.730315351423997*^9}, {3.730315544433013*^9, 
   3.730315548398731*^9}, 3.7303184407938128`*^9, {3.730318506917809*^9, 
   3.730318549642191*^9}, {3.7303186182833157`*^9, 3.730318679316226*^9}, 
   3.730319014494937*^9, {3.730319242889605*^9, 3.7303195969483624`*^9}, {
   3.730319648053155*^9, 3.730319700527194*^9}, {3.730319771951812*^9, 
   3.7303198100165567`*^9}, {3.730319874912179*^9, 3.730319882827012*^9}, {
   3.7303199192333403`*^9, 3.7303199409973507`*^9}, {3.7303200207904587`*^9, 
   3.730320111053123*^9}, {3.730320153382773*^9, 3.7303201828403063`*^9}, 
   3.730320232447527*^9, {3.730320263865484*^9, 3.730320266843093*^9}, {
   3.730320318846039*^9, 3.730320377379895*^9}, {3.730320458508409*^9, 
   3.730320521892085*^9}, 3.730320554160087*^9, {3.730320588855823*^9, 
   3.730320679754162*^9}, {3.730320724328446*^9, 3.730320767907226*^9}, {
   3.730320866391848*^9, 3.7303209427846403`*^9}, {3.730321011727592*^9, 
   3.730321143736785*^9}, {3.730321178206218*^9, 3.7303211813699493`*^9}, 
   3.730321261211862*^9, {3.730321296749846*^9, 3.730321367391459*^9}, 
   3.730322059736294*^9, {3.730322104837722*^9, 3.73032229404395*^9}, {
   3.7303223855092573`*^9, 3.730322397519309*^9}, {3.730322472093444*^9, 
   3.730322480427155*^9}, {3.73032253577601*^9, 3.730322556390129*^9}, 
   3.730322732761827*^9, {3.730322766376878*^9, 3.7303227679073677`*^9}, {
   3.730323610266073*^9, 3.730323614229232*^9}, {3.73032372512111*^9, 
   3.730323726482191*^9}, {3.7303240680301943`*^9, 3.730324119632022*^9}, {
   3.730324171322345*^9, 3.730324199136318*^9}, {3.730324249159369*^9, 
   3.730324251700872*^9}, {3.730324391384632*^9, 3.730324396064788*^9}, {
   3.730324427427404*^9, 3.730324430098201*^9}, {3.73032462236369*^9, 
   3.73032466169154*^9}, {3.730324694929693*^9, 3.7303248119179573`*^9}, 
   3.730324863758884*^9, {3.730324931719548*^9, 3.7303249321298532`*^9}, {
   3.730325008901594*^9, 3.730325137501645*^9}, {3.7303251982519073`*^9, 
   3.730325232743041*^9}, {3.7303252870201263`*^9, 3.730325289751696*^9}, {
   3.730325473599038*^9, 3.730325486483841*^9}, {3.730325531395349*^9, 
   3.730325562391786*^9}, {3.730325608400971*^9, 3.7303256094383087`*^9}, {
   3.730325647661625*^9, 3.73032577440798*^9}, {3.730325915407393*^9, 
   3.730325927949666*^9}, {3.730326069247168*^9, 3.730326095011765*^9}, {
   3.730326130718094*^9, 3.730326132980336*^9}, {3.7303261716986637`*^9, 
   3.7303261735896473`*^9}, {3.730326441002973*^9, 3.730326452842361*^9}, {
   3.730326568741004*^9, 3.730326571197798*^9}, {3.730326636882267*^9, 
   3.730326636977557*^9}, {3.730326675815651*^9, 3.730326698166408*^9}, {
   3.730326881550909*^9, 3.730326884141448*^9}, {3.730326942474622*^9, 
   3.730326945649371*^9}, {3.730327053709442*^9, 3.730327057160557*^9}, {
   3.7303279719472437`*^9, 3.730327990129211*^9}, {3.7303281400768967`*^9, 
   3.730328145260223*^9}, {3.730328347581406*^9, 3.7303284937900963`*^9}, {
   3.730328631162141*^9, 3.730328635488266*^9}, {3.730328884450657*^9, 
   3.7303288871590776`*^9}, {3.730328992747814*^9, 3.730329005579015*^9}, {
   3.730329296112672*^9, 3.730329299479349*^9}, {3.732025135669115*^9, 
   3.7320251675535803`*^9}, {3.7320252645673656`*^9, 3.732025285469398*^9}, {
   3.7348956327740593`*^9, 
   3.734895647331286*^9}},ExpressionUUID->"f4c1335f-9d55-4849-afbd-\
ad10b9ccb939"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "Metropolis", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Metropolis", "[", 
     RowBox[{"N_", ",", "beta_", ",", " ", 
      RowBox[{"hamiltonian_", "[", "hparams__", "]"}], ",", "observables_", 
      ",", "maxSweep_", ",", "seedAmat_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "edgeMax", ",", "ParallelSow", ",", "graphMax", ",", "expDEVals", ",", 
        "initialize", ",", "sweep", ",", "numsweeps", ",", "Amat", ",", 
        "AmatNew", ",", "x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"edgeMax", "=", 
        RowBox[{"N", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], "/", "2"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"graphMax", "=", 
        RowBox[{"2", "^", "edgeMax"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Amat", "=", 
          RowBox[{"MakeAmat", "[", 
           RowBox[{"IntegerDigits", "[", 
            RowBox[{
             RowBox[{"RandomInteger", "[", 
              RowBox[{"graphMax", "-", "1"}], "]"}], ",", "2", ",", 
             "edgeMax"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Amat", "=", 
           RowBox[{"MakeKn", "[", "N", "]"}]}], ";"}], "*)"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Amat", " ", "=", " ", "seedAmat"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AmatNew", " ", "=", " ", "Amat"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<seed graph\>\"", ",", 
         RowBox[{"AdjacencyGraph", "[", "Amat", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sweep", "[", "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "l", ",", "lp", ",", "m", ",", "i", ",", "j", ",", "deltaE", ",", 
            "expBetaDE", ",", "accept"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"AmatNew", " ", "=", " ", "Amat"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"l", "=", 
               RowBox[{"RandomInteger", "[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "edgeMax"}], "}"}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"lp", "=", 
               RowBox[{"edgeMax", "+", "1", "-", "l"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"m", "=", "0"}], ";", "\[IndentingNewLine]", 
              RowBox[{"While", "[", 
               RowBox[{
                RowBox[{"lp", ">", "0"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"m", "++"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"lp", "-=", 
                  RowBox[{"N", "-", "m"}]}], ";"}]}], "\[IndentingNewLine]", 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"j", "=", 
               RowBox[{"N", "+", "1", "-", "m"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"i", "=", 
               RowBox[{"l", "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"j", "-", "1"}], ")"}], 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"j", "-", "2"}], ")"}], "/", "2"}]}]}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AmatNew", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Amat", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", "1"}], ",", 
                 "2"}], "]"}]}], ";", 
              RowBox[{
               RowBox[{"AmatNew", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", 
               RowBox[{"AmatNew", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"deltaE", "=", 
               RowBox[{
                RowBox[{"hamiltonian", "[", 
                 RowBox[{"AmatNew", ",", "hparams"}], "]"}], "-", 
                RowBox[{"hamiltonian", "[", 
                 RowBox[{"Amat", ",", "hparams"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"expBetaDE", "=", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "beta"}], "*", "deltaE"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"deltaE", ">", "0"}], "&"}], "expBetaDE"}], ">", 
                 "1"}], ",", 
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Error! deltaE = \>\"", ",", "deltaE", ",", 
                  "\"\< expBetaDE = \>\"", ",", "expBetaDE"}], "]"}]}], " ", 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"accept", "=", "False"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"deltaE", "<=", "0"}], ",", 
                RowBox[{"accept", "=", "True"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"RandomReal", "[", "]"}], "<", "expBetaDE"}], ",", 
                  
                  RowBox[{"accept", "=", "True"}]}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{"accept", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Amat", " ", "=", " ", "AmatNew"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<after \>\"", ",", 
                 RowBox[{"Amat", "//", "MatrixForm"}]}], "]"}], ";"}], "*)"}],
              "\[IndentingNewLine]", "edgeMax"}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"numsweeps", "=", "0"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Reap", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"sweep", "[", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"numsweeps", "++"}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{"numsweeps", ",", "1"}], "]"}], "\[Equal]", "0"}], 
                ",", 
                RowBox[{"ParallelSow", "[", 
                 RowBox[{"AdjacencyGraph", "[", 
                  RowBox[{"Amat", ",", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"140", ",", "140"}], "}"}]}]}], "]"}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{"numsweeps", ",", "1"}], "]"}], "\[Equal]", "0"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Sow", "[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"{", 
                  RowBox[{"numsweeps", ",", 
                   RowBox[{"hamiltonian", "[", 
                    RowBox[{"Amat", ",", "hparams"}], "]"}], ",", 
                   RowBox[{"Through", "[", 
                    RowBox[{"observables", " ", "[", "Amat", "]"}], "]"}]}], 
                  "}"}], "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}]}], ",", "\[IndentingNewLine]", "maxSweep"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AdjacencyGraph", "[", 
          RowBox[{"Amat", ",", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"240", ",", "240"}], "}"}]}]}], "]"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"GraphPlot3D", "[", 
          RowBox[{"AdjacencyGraph", "[", 
           RowBox[{"Amat", ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"240", ",", "240"}], "}"}]}]}], "]"}], "]"}], "*)"}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.729011911924306*^9, 3.729011989177074*^9}, {
   3.729012137727057*^9, 3.729012206439478*^9}, {3.7290163687409897`*^9, 
   3.7290164245971603`*^9}, {3.7290210483041162`*^9, 3.729021054667951*^9}, 
   3.729021332583931*^9, {3.730299086117556*^9, 3.730299109912243*^9}, {
   3.7302995982335863`*^9, 3.730299599911676*^9}, {3.730299646878902*^9, 
   3.7302996683919153`*^9}, {3.730299851105*^9, 3.730299863972591*^9}, {
   3.730300135919992*^9, 3.730300192043455*^9}, {3.730305943063089*^9, 
   3.730306025830887*^9}, 3.730306181541602*^9, {3.730306222618163*^9, 
   3.730306263034152*^9}, {3.7303063883570023`*^9, 3.730306410916122*^9}, {
   3.730306455434614*^9, 3.7303064579336033`*^9}, {3.73030649386791*^9, 
   3.73030650912265*^9}, {3.730306543880773*^9, 3.7303065961639767`*^9}, 
   3.730306669149777*^9, {3.7303135698239937`*^9, 3.730313761552574*^9}, {
   3.7303138065569763`*^9, 3.7303139597372704`*^9}, {3.730314016294269*^9, 
   3.730314041118734*^9}, {3.730314097184043*^9, 3.7303141958648567`*^9}, {
   3.730314335825444*^9, 3.730314399043655*^9}, {3.7303144306143627`*^9, 
   3.730314442818921*^9}, 3.730314473015115*^9, 3.730314707037998*^9, {
   3.730314923365057*^9, 3.730314938823072*^9}, {3.730315044946463*^9, 
   3.7303150583965178`*^9}, {3.730315096366252*^9, 3.730315169453223*^9}, {
   3.730315291163644*^9, 3.730315351423997*^9}, {3.730315544433013*^9, 
   3.730315548398731*^9}, 3.7303184407938128`*^9, {3.730318506917809*^9, 
   3.730318549642191*^9}, {3.7303186182833157`*^9, 3.730318679316226*^9}, 
   3.730319014494937*^9, {3.730319242889605*^9, 3.7303195969483624`*^9}, {
   3.730319648053155*^9, 3.730319700527194*^9}, {3.730319771951812*^9, 
   3.7303198100165567`*^9}, {3.730319874912179*^9, 3.730319882827012*^9}, {
   3.7303199192333403`*^9, 3.7303199409973507`*^9}, {3.7303200207904587`*^9, 
   3.730320111053123*^9}, {3.730320153382773*^9, 3.7303201828403063`*^9}, 
   3.730320232447527*^9, {3.730320263865484*^9, 3.730320266843093*^9}, {
   3.730320318846039*^9, 3.730320377379895*^9}, {3.730320458508409*^9, 
   3.730320521892085*^9}, 3.730320554160087*^9, {3.730320588855823*^9, 
   3.730320679754162*^9}, {3.730320724328446*^9, 3.730320767907226*^9}, {
   3.730320866391848*^9, 3.7303209427846403`*^9}, {3.730321011727592*^9, 
   3.730321143736785*^9}, {3.730321178206218*^9, 3.7303211813699493`*^9}, 
   3.730321261211862*^9, {3.730321296749846*^9, 3.730321367391459*^9}, 
   3.730322059736294*^9, {3.730322104837722*^9, 3.73032229404395*^9}, {
   3.7303223855092573`*^9, 3.730322397519309*^9}, {3.730322472093444*^9, 
   3.730322480427155*^9}, {3.73032253577601*^9, 3.730322556390129*^9}, 
   3.730322732761827*^9, {3.730322766376878*^9, 3.7303227679073677`*^9}, {
   3.730323610266073*^9, 3.730323614229232*^9}, {3.73032372512111*^9, 
   3.730323726482191*^9}, {3.7303240680301943`*^9, 3.730324119632022*^9}, {
   3.730324171322345*^9, 3.730324199136318*^9}, {3.730324249159369*^9, 
   3.730324251700872*^9}, {3.730324391384632*^9, 3.730324396064788*^9}, {
   3.730324427427404*^9, 3.730324430098201*^9}, {3.73032462236369*^9, 
   3.73032466169154*^9}, {3.730324694929693*^9, 3.7303248119179573`*^9}, 
   3.730324863758884*^9, {3.730324931719548*^9, 3.7303249321298532`*^9}, {
   3.730325008901594*^9, 3.730325137501645*^9}, {3.7303251982519073`*^9, 
   3.730325232743041*^9}, {3.7303252870201263`*^9, 3.730325289751696*^9}, {
   3.730325473599038*^9, 3.730325486483841*^9}, {3.730325531395349*^9, 
   3.730325562391786*^9}, {3.730325608400971*^9, 3.7303256094383087`*^9}, {
   3.730325647661625*^9, 3.73032577440798*^9}, {3.730325915407393*^9, 
   3.730325927949666*^9}, {3.730326069247168*^9, 3.730326095011765*^9}, {
   3.730326130718094*^9, 3.730326132980336*^9}, {3.7303261716986637`*^9, 
   3.7303261735896473`*^9}, {3.730326441002973*^9, 3.730326452842361*^9}, {
   3.730326568741004*^9, 3.730326571197798*^9}, {3.730326636882267*^9, 
   3.730326636977557*^9}, {3.730326675815651*^9, 3.730326698166408*^9}, {
   3.730326881550909*^9, 3.730326884141448*^9}, {3.730326942474622*^9, 
   3.730326945649371*^9}, {3.730327053709442*^9, 3.730327057160557*^9}, {
   3.7303279719472437`*^9, 3.730327990129211*^9}, {3.7303281400768967`*^9, 
   3.730328145260223*^9}, {3.730328347581406*^9, 3.7303284937900963`*^9}, {
   3.730328631162141*^9, 3.730328635488266*^9}, {3.730328884450657*^9, 
   3.7303288871590776`*^9}, {3.730328992747814*^9, 3.730329005579015*^9}, {
   3.730329296112672*^9, 3.730329299479349*^9}, {3.7320232951190367`*^9, 
   3.7320233121258183`*^9}, {3.732023383396587*^9, 3.7320233907468433`*^9}, {
   3.732023472449823*^9, 3.732023501926648*^9}, {3.7320236333556347`*^9, 
   3.7320237341512833`*^9}, {3.732023776238242*^9, 3.732023856657288*^9}, {
   3.732023958422565*^9, 3.732023962829967*^9}, {3.732024037709085*^9, 
   3.732024066881219*^9}, 3.732024282891927*^9, 3.732024321379846*^9, {
   3.732024605695753*^9, 3.732024675972597*^9}, {3.732024757017671*^9, 
   3.732024764520379*^9}, {3.732024971161847*^9, 3.732024972512414*^9}, {
   3.732025712174036*^9, 3.732025713339842*^9}, {3.732026094840007*^9, 
   3.732026103085347*^9}, {3.734891732896882*^9, 3.734891756398288*^9}, {
   3.73489186096422*^9, 3.734891927793746*^9}, {3.73489206875622*^9, 
   3.734892070043355*^9}, {3.7348921039153147`*^9, 3.7348921055822897`*^9}, {
   3.734892259117428*^9, 3.734892279257039*^9}, {3.734892457269067*^9, 
   3.734892466730979*^9}, {3.734892514202486*^9, 3.734892515764659*^9}, {
   3.734892607047364*^9, 3.734892609775292*^9}, {3.7348926883831043`*^9, 
   3.7348927423847523`*^9}, {3.7348932377474422`*^9, 3.734893262114711*^9}, {
   3.734893348027276*^9, 3.734893355596705*^9}, {3.734893604207674*^9, 
   3.734893628504739*^9}, {3.734893659583809*^9, 3.734893771224225*^9}, {
   3.734893810805444*^9, 3.734893833872559*^9}, {3.7348940247079973`*^9, 
   3.7348940726204033`*^9}, {3.734895691754023*^9, 3.734895699664608*^9}, {
   3.734895744354218*^9, 3.734895884576221*^9}, {3.734895950217443*^9, 
   3.7348959673336267`*^9}, 3.734904883033383*^9, {3.73496323675753*^9, 
   3.734963256118678*^9}, {3.73498345448796*^9, 3.734983483482648*^9}, 
   3.7349930410399303`*^9, {3.7354103491054688`*^9, 3.735410391172291*^9}, {
   3.735410574663447*^9, 3.7354105982836742`*^9}, {3.735502662419923*^9, 
   3.7355026625647173`*^9}, {3.73550280070041*^9, 3.7355028170398808`*^9}, {
   3.735502854134365*^9, 
   3.735502855984765*^9}},ExpressionUUID->"0d9c0e81-41a2-45f3-a0b4-\
9f6a74d7e2b8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "MultiFlipMetropolis", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MultiFlipMetropolis", "[", 
     RowBox[{"N_", ",", "beta_", ",", " ", 
      RowBox[{"hamiltonian_", "[", "hparams__", "]"}], ",", "observables_", 
      ",", "maxSweep_", ",", "seedAmat_", ",", "maxNumFlips_"}], "]"}], "/;", 
    
    RowBox[{
     RowBox[{"ArrayDepth", "[", "observables", "]"}], "==", "1"}]}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "edgeMax", ",", "getiAndj", ",", "graphMax", ",", "expDEVals", ",", 
       "numObservables", ",", "sweep", ",", "numsweeps", ",", "Amat", ",", 
       "AmatNew", ",", "x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"edgeMax", "=", 
       RowBox[{"N", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"N", "-", "1"}], ")"}], "/", "2"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"graphMax", "=", 
       RowBox[{"2", "^", "edgeMax"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"numObservables", "=", 
       RowBox[{"Length", "[", "observables", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Amat", " ", "=", " ", "seedAmat"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AmatNew", " ", "=", " ", "Amat"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Print", "[", 
       RowBox[{"\"\<seed graph\>\"", ",", 
        RowBox[{"AdjacencyGraph", "[", "Amat", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"getiAndj", "[", "l_", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lp", ",", "m", ",", "i", ",", "j"}], "}"}], ",", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "converts", " ", "a", " ", "position", " ", "l", " ", "in", " ", 
            "the", " ", "range", " ", "between", " ", "1", " ", "and", " ", 
            "N", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"N", "-", "1"}], ")"}], "/", "2"}], " ", "to", " ", 
            "corresponding", " ", "row", " ", "and", " ", "column", " ", 
            "numbers", " ", "in", " ", "the", " ", "adjacency", " ", 
            "matrix"}], ",", " ", 
           RowBox[{"i", ".", "e", "."}], ",", " ", 
           RowBox[{
           "the", " ", "nodes", " ", "i", " ", "and", " ", "j", " ", 
            "connected", " ", "by", " ", "the", " ", "edge", " ", 
            RowBox[{"l", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"lp", "=", 
           RowBox[{"edgeMax", "+", "1", "-", "l"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"m", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"lp", ">", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"m", "++"}], ";", "\[IndentingNewLine]", 
             RowBox[{"lp", "-=", 
              RowBox[{"N", "-", "m"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"j", "=", 
           RowBox[{"N", "+", "1", "-", "m"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"i", "=", 
           RowBox[{"l", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "1"}], ")"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"j", "-", "2"}], ")"}], "/", "2"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sweep", "[", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "lvec", ",", "ijmat", ",", "deltaE", ",", "expBetaDE", ",", 
           "accept", ",", "totFlips", ",", "numEdgesToBeFlipped"}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"totFlips", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"totFlips", "<=", "edgeMax"}], ",", "\[IndentingNewLine]",
             "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AmatNew", " ", "=", " ", "Amat"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"numEdgesToBeFlipped", "=", 
              RowBox[{"RandomInteger", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "maxNumFlips"}], "}"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"totFlips", "+=", "numEdgesToBeFlipped"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"lvec", "=", 
              RowBox[{"RandomSample", "[", 
               RowBox[{
                RowBox[{"Range", "[", "edgeMax", "]"}], ",", 
                "numEdgesToBeFlipped"}], "]"}]}], ";", "\[IndentingNewLine]", 
             
             RowBox[{"ijmat", "=", 
              RowBox[{"Map", "[", 
               RowBox[{"getiAndj", ",", "lvec"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<totFlips \>\"", ",", "totFlips", ",", 
                 "\"\< numEdgesToBeFlipped \>\"", ",", 
                 "numEdgesToBeFlipped"}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"Print", "[", 
                RowBox[{"\"\<lvec \>\"", ",", "lvec"}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Print", "[", 
                RowBox[{"\"\<ijmat \>\"", ",", "ijmat"}], "]"}], ";"}], 
              "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"AmatNew", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"ijmat", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"ijmat", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "]"}], 
                 "=", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Amat", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"ijmat", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"ijmat", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "]"}], 
                    "+", "1"}], ",", "2"}], "]"}]}], ";", 
                RowBox[{
                 RowBox[{"AmatNew", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"ijmat", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"ijmat", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "]"}], 
                 "=", 
                 RowBox[{"AmatNew", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"ijmat", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"ijmat", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "]"}]}]}],
                "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "numEdgesToBeFlipped"}], "}"}]}], "]"}], 
             ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<AmatNew\>\"", ",", 
                 RowBox[{"AdjacencyGraph", "[", "AmatNew", "]"}]}], "]"}], 
               ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"deltaE", "=", 
              RowBox[{
               RowBox[{"hamiltonian", "[", 
                RowBox[{"AmatNew", ",", "hparams"}], "]"}], "-", 
               RowBox[{"hamiltonian", "[", 
                RowBox[{"Amat", ",", "hparams"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"expBetaDE", "=", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "beta"}], "*", "deltaE"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<deltaE \>\"", ",", "deltaE"}], "]"}], ";"}], 
              "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"deltaE", ">", "0"}], "&"}], "expBetaDE"}], ">", 
                "1"}], ",", 
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<Error! deltaE = \>\"", ",", "deltaE", ",", 
                 "\"\< expBetaDE = \>\"", ",", "expBetaDE"}], "]"}]}], " ", 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"accept", "=", "False"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"deltaE", "<=", "0"}], ",", 
               RowBox[{"accept", "=", "True"}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"RandomReal", "[", "]"}], "<", "expBetaDE"}], ",", 
                 RowBox[{"accept", "=", "True"}]}], "]"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"accept", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"IsomorphicGraphQ", "[", 
                   RowBox[{
                    RowBox[{"AdjacencyGraph", "[", "Amat", "]"}], ",", 
                    RowBox[{"AdjacencyGraph", "[", "AmatNew", "]"}]}], "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"totFlips", "-=", "numEdgesToBeFlipped"}], ";"}]}],
                  "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Amat", " ", "=", " ", "AmatNew"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], " ", ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"numsweeps", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Reap", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sweep", "[", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"numsweeps", "++"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{"numsweeps", ",", "1"}], "]"}], "\[Equal]", "0"}], 
               ",", 
               RowBox[{"ParallelSow", "[", 
                RowBox[{"AdjacencyGraph", "[", 
                 RowBox[{"Amat", ",", 
                  RowBox[{"ImageSize", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"140", ",", "140"}], "}"}]}]}], "]"}], "]"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"numsweeps", ",", "1"}], "]"}], "\[Equal]", "0"}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Sow", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"numsweeps", ",", 
                   RowBox[{"hamiltonian", "[", 
                    RowBox[{"Amat", ",", "hparams"}], "]"}]}], "}"}], ",", 
                 "1"}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"Sow", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"numsweeps", ",", 
                   RowBox[{"Through", "[", 
                    RowBox[{"observables", " ", "[", "Amat", "]"}], "]"}]}], 
                  "}"}], ",", "2"}], "]"}], ";"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Sow", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"numsweeps", ",", 
                  RowBox[{"hamiltonian", "[", 
                   RowBox[{"Amat", ",", "hparams"}], "]"}], ",", 
                  RowBox[{"Through", "[", 
                   RowBox[{"observables", " ", "[", "Amat", "]"}], "]"}]}], 
                 "}"}], "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
           ",", "\[IndentingNewLine]", "maxSweep"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AdjacencyGraph", "[", 
         RowBox[{"Amat", ",", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"240", ",", "240"}], "}"}]}]}], "]"}]}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"GraphPlot3D", "[", 
         RowBox[{"AdjacencyGraph", "[", 
          RowBox[{"Amat", ",", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"240", ",", "240"}], "}"}]}]}], "]"}], "]"}], "*)"}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.729011911924306*^9, 3.729011989177074*^9}, {
   3.729012137727057*^9, 3.729012206439478*^9}, {3.7290163687409897`*^9, 
   3.7290164245971603`*^9}, {3.7290210483041162`*^9, 3.729021054667951*^9}, 
   3.729021332583931*^9, {3.730299086117556*^9, 3.730299109912243*^9}, {
   3.7302995982335863`*^9, 3.730299599911676*^9}, {3.730299646878902*^9, 
   3.7302996683919153`*^9}, {3.730299851105*^9, 3.730299863972591*^9}, {
   3.730300135919992*^9, 3.730300192043455*^9}, {3.730305943063089*^9, 
   3.730306025830887*^9}, 3.730306181541602*^9, {3.730306222618163*^9, 
   3.730306263034152*^9}, {3.7303063883570023`*^9, 3.730306410916122*^9}, {
   3.730306455434614*^9, 3.7303064579336033`*^9}, {3.73030649386791*^9, 
   3.73030650912265*^9}, {3.730306543880773*^9, 3.7303065961639767`*^9}, 
   3.730306669149777*^9, {3.7303135698239937`*^9, 3.730313761552574*^9}, {
   3.7303138065569763`*^9, 3.7303139597372704`*^9}, {3.730314016294269*^9, 
   3.730314041118734*^9}, {3.730314097184043*^9, 3.7303141958648567`*^9}, {
   3.730314335825444*^9, 3.730314399043655*^9}, {3.7303144306143627`*^9, 
   3.730314442818921*^9}, 3.730314473015115*^9, 3.730314707037998*^9, {
   3.730314923365057*^9, 3.730314938823072*^9}, {3.730315044946463*^9, 
   3.7303150583965178`*^9}, {3.730315096366252*^9, 3.730315169453223*^9}, {
   3.730315291163644*^9, 3.730315351423997*^9}, {3.730315544433013*^9, 
   3.730315548398731*^9}, 3.7303184407938128`*^9, {3.730318506917809*^9, 
   3.730318549642191*^9}, {3.7303186182833157`*^9, 3.730318679316226*^9}, 
   3.730319014494937*^9, {3.730319242889605*^9, 3.7303195969483624`*^9}, {
   3.730319648053155*^9, 3.730319700527194*^9}, {3.730319771951812*^9, 
   3.7303198100165567`*^9}, {3.730319874912179*^9, 3.730319882827012*^9}, {
   3.7303199192333403`*^9, 3.7303199409973507`*^9}, {3.7303200207904587`*^9, 
   3.730320111053123*^9}, {3.730320153382773*^9, 3.7303201828403063`*^9}, 
   3.730320232447527*^9, {3.730320263865484*^9, 3.730320266843093*^9}, {
   3.730320318846039*^9, 3.730320377379895*^9}, {3.730320458508409*^9, 
   3.730320521892085*^9}, 3.730320554160087*^9, {3.730320588855823*^9, 
   3.730320679754162*^9}, {3.730320724328446*^9, 3.730320767907226*^9}, {
   3.730320866391848*^9, 3.7303209427846403`*^9}, {3.730321011727592*^9, 
   3.730321143736785*^9}, {3.730321178206218*^9, 3.7303211813699493`*^9}, 
   3.730321261211862*^9, {3.730321296749846*^9, 3.730321367391459*^9}, 
   3.730322059736294*^9, {3.730322104837722*^9, 3.73032229404395*^9}, {
   3.7303223855092573`*^9, 3.730322397519309*^9}, {3.730322472093444*^9, 
   3.730322480427155*^9}, {3.73032253577601*^9, 3.730322556390129*^9}, 
   3.730322732761827*^9, {3.730322766376878*^9, 3.7303227679073677`*^9}, {
   3.730323610266073*^9, 3.730323614229232*^9}, {3.73032372512111*^9, 
   3.730323726482191*^9}, {3.7303240680301943`*^9, 3.730324119632022*^9}, {
   3.730324171322345*^9, 3.730324199136318*^9}, {3.730324249159369*^9, 
   3.730324251700872*^9}, {3.730324391384632*^9, 3.730324396064788*^9}, {
   3.730324427427404*^9, 3.730324430098201*^9}, {3.73032462236369*^9, 
   3.73032466169154*^9}, {3.730324694929693*^9, 3.7303248119179573`*^9}, 
   3.730324863758884*^9, {3.730324931719548*^9, 3.7303249321298532`*^9}, {
   3.730325008901594*^9, 3.730325137501645*^9}, {3.7303251982519073`*^9, 
   3.730325232743041*^9}, {3.7303252870201263`*^9, 3.730325289751696*^9}, {
   3.730325473599038*^9, 3.730325486483841*^9}, {3.730325531395349*^9, 
   3.730325562391786*^9}, {3.730325608400971*^9, 3.7303256094383087`*^9}, {
   3.730325647661625*^9, 3.73032577440798*^9}, {3.730325915407393*^9, 
   3.730325927949666*^9}, {3.730326069247168*^9, 3.730326095011765*^9}, {
   3.730326130718094*^9, 3.730326132980336*^9}, {3.7303261716986637`*^9, 
   3.7303261735896473`*^9}, {3.730326441002973*^9, 3.730326452842361*^9}, {
   3.730326568741004*^9, 3.730326571197798*^9}, {3.730326636882267*^9, 
   3.730326636977557*^9}, {3.730326675815651*^9, 3.730326698166408*^9}, {
   3.730326881550909*^9, 3.730326884141448*^9}, {3.730326942474622*^9, 
   3.730326945649371*^9}, {3.730327053709442*^9, 3.730327057160557*^9}, {
   3.7303279719472437`*^9, 3.730327990129211*^9}, {3.7303281400768967`*^9, 
   3.730328145260223*^9}, {3.730328347581406*^9, 3.7303284937900963`*^9}, {
   3.730328631162141*^9, 3.730328635488266*^9}, {3.730328884450657*^9, 
   3.7303288871590776`*^9}, {3.730328992747814*^9, 3.730329005579015*^9}, {
   3.730329296112672*^9, 3.730329299479349*^9}, {3.7320232951190367`*^9, 
   3.7320233121258183`*^9}, {3.732023383396587*^9, 3.7320233907468433`*^9}, {
   3.732023472449823*^9, 3.732023501926648*^9}, {3.7320236333556347`*^9, 
   3.7320237341512833`*^9}, {3.732023776238242*^9, 3.732023856657288*^9}, {
   3.732023958422565*^9, 3.732023962829967*^9}, {3.732024037709085*^9, 
   3.732024066881219*^9}, 3.732024282891927*^9, 3.732024321379846*^9, {
   3.732024605695753*^9, 3.732024675972597*^9}, {3.732024757017671*^9, 
   3.732024764520379*^9}, {3.732024971161847*^9, 3.732024972512414*^9}, {
   3.732025712174036*^9, 3.732025713339842*^9}, {3.732026094840007*^9, 
   3.732026103085347*^9}, {3.734891732896882*^9, 3.734891756398288*^9}, {
   3.73489186096422*^9, 3.734891927793746*^9}, {3.73489206875622*^9, 
   3.734892070043355*^9}, {3.7348921039153147`*^9, 3.7348921055822897`*^9}, {
   3.734892259117428*^9, 3.734892279257039*^9}, {3.734892457269067*^9, 
   3.734892466730979*^9}, {3.734892514202486*^9, 3.734892515764659*^9}, {
   3.734892607047364*^9, 3.734892609775292*^9}, {3.7348926883831043`*^9, 
   3.7348927423847523`*^9}, {3.7348932377474422`*^9, 3.734893262114711*^9}, {
   3.734893348027276*^9, 3.734893355596705*^9}, {3.734893604207674*^9, 
   3.734893628504739*^9}, {3.734893659583809*^9, 3.734893771224225*^9}, {
   3.734893810805444*^9, 3.734893833872559*^9}, {3.7348940247079973`*^9, 
   3.7348940726204033`*^9}, {3.734895691754023*^9, 3.734895699664608*^9}, {
   3.734895744354218*^9, 3.734895884576221*^9}, {3.734895950217443*^9, 
   3.7348959673336267`*^9}, 3.734904883033383*^9, {3.73496323675753*^9, 
   3.734963256118678*^9}, {3.734980495615745*^9, 3.734980520459396*^9}, {
   3.734980560402547*^9, 3.73498057978997*^9}, {3.7349806254631042`*^9, 
   3.7349806622784767`*^9}, {3.73498075423433*^9, 3.734980871111971*^9}, {
   3.734981125852097*^9, 3.734981126097746*^9}, {3.734981157780014*^9, 
   3.73498133411655*^9}, {3.734981374060317*^9, 3.7349815118789062`*^9}, {
   3.734981578856019*^9, 3.734981642703595*^9}, {3.7349818650604057`*^9, 
   3.7349818919105177`*^9}, {3.7349820899047327`*^9, 3.734982141820409*^9}, {
   3.734982595360632*^9, 3.7349827779596567`*^9}, {3.7349829076930523`*^9, 
   3.734982918312491*^9}, {3.734982948370531*^9, 3.7349829486932592`*^9}, {
   3.734982982329533*^9, 3.734982999540967*^9}, {3.7349830539652853`*^9, 
   3.734983055127289*^9}, 3.734983179280189*^9, {3.734983387282772*^9, 
   3.734983388646832*^9}, {3.7349834263331413`*^9, 3.7349834386612387`*^9}, {
   3.73498397743647*^9, 3.734984084422999*^9}, {3.73498431117766*^9, 
   3.734984334256633*^9}, {3.7349847551187553`*^9, 3.7349848010511303`*^9}, {
   3.734984917958727*^9, 3.734984950784644*^9}, {3.734984998891118*^9, 
   3.734985033961584*^9}, {3.734986084024548*^9, 3.7349860988367662`*^9}, {
   3.7349862338224373`*^9, 3.73498627449056*^9}, {3.734986478009432*^9, 
   3.734986502793825*^9}, {3.734986597288295*^9, 3.73498661260256*^9}, {
   3.734986792605328*^9, 3.734986808211564*^9}, {3.7349873854156923`*^9, 
   3.734987434207219*^9}, {3.734987465298853*^9, 3.734987492999205*^9}, {
   3.734987527093425*^9, 3.734987534961112*^9}, {3.734987594364152*^9, 
   3.7349876350861673`*^9}, 3.734990100980124*^9, {3.7349918932347918`*^9, 
   3.73499195018894*^9}, {3.73499302510145*^9, 3.7349930305461473`*^9}, {
   3.735410399477241*^9, 3.7354104396592484`*^9}, {3.735410604446952*^9, 
   3.735410634155573*^9}, {3.735498279560121*^9, 3.735498307385586*^9}, {
   3.7355013909915447`*^9, 3.7355013914129*^9}, {3.7355014328699007`*^9, 
   3.735501490605908*^9}, 3.735501558689371*^9, {3.735501619740575*^9, 
   3.7355016390705957`*^9}, {3.73550170952845*^9, 3.7355017208047667`*^9}, {
   3.735501756738288*^9, 3.735501837087165*^9}, 3.735501890890914*^9, {
   3.7355020200298986`*^9, 3.735502067300687*^9}, 3.73550227428624*^9, 
   3.735502307890973*^9, {3.7355023449124317`*^9, 3.735502371884197*^9}, {
   3.735502418122076*^9, 3.735502457663412*^9}, {3.7355025074368057`*^9, 
   3.735502520692481*^9}, {3.7355026483760033`*^9, 3.735502650203125*^9}, {
   3.735502689218924*^9, 3.735502690903607*^9}, {3.735502769148843*^9, 
   3.735502773220481*^9}},ExpressionUUID->"66938c15-7d39-47a1-8d1e-\
12a777786708"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.735498639709178*^9, {3.735498695608396*^9, 3.73549875202705*^9}, {
   3.7354988064723997`*^9, 3.7354988101888866`*^9}, {3.735499041024084*^9, 
   3.735499060358952*^9}, {3.7354992138723297`*^9, 3.735499215356781*^9}, {
   3.7354992508001547`*^9, 3.7354993112207613`*^9}, {3.735500093347299*^9, 
   3.735500106545197*^9}, {3.735500137624094*^9, 3.735500176763838*^9}, {
   3.735500237499296*^9, 3.735500264075862*^9}, {3.735500483019212*^9, 
   3.73550048340779*^9}, {3.735500516283023*^9, 3.735500528260311*^9}, {
   3.735500585060276*^9, 3.735500593835197*^9}, {3.735500671800035*^9, 
   3.735500677725069*^9}, {3.735500780031456*^9, 3.7355008152622643`*^9}, {
   3.735500980449566*^9, 3.735501079947302*^9}, {3.735501134469578*^9, 
   3.735501148544121*^9}, {3.735501179277047*^9, 3.73550122102032*^9}, {
   3.7355012979174557`*^9, 3.7355012992386627`*^9}, 3.73550138703924*^9, {
   3.73550243598438*^9, 
   3.735502453976183*^9}},ExpressionUUID->"d7ae19b5-7d7e-44ca-896d-\
a781b8edaca8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CorrelationTime", "[", 
   RowBox[{"t_", ",", "tbl_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tmax", ",", "s1", ",", "s2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tmax", "=", 
      RowBox[{"Length", "[", "tbl", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"s1", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"tmax", "-", "t"}], ")"}]}], ")"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"tbl", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
          RowBox[{"tbl", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "+", "t"}], ",", "2"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"tmax", "-", "t"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"s2", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"tmax", "-", "t"}], ")"}], "^", "2"}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"tbl", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"tmax", "-", "t"}]}], "}"}]}], "]"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"tbl", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "+", "t"}], ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"tmax", "-", "t"}]}], "}"}]}], "]"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<tmax \>\"", ",", "tmax"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<s1 \>\"", ",", "s1", ",", "\"\< s2 \>\"", ",", "s2"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<s1-s2 \>\"", ",", 
         RowBox[{"s1", "-", "s2"}]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"s1", "-", "s2"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7348994312203417`*^9, 3.734899506722447*^9}, {
  3.734899619308557*^9, 3.73489972060463*^9}, {3.734899755023416*^9, 
  3.734899843340845*^9}, {3.734900001545824*^9, 3.734900063850141*^9}, {
  3.734900139301218*^9, 3.734900221184222*^9}, {3.7349003768889647`*^9, 
  3.7349003870009117`*^9}},ExpressionUUID->"e87ad06f-4ef5-4689-9232-\
807b02bbcd60"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{697, 801},
WindowMargins->{{37, Automatic}, {Automatic, 2}},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 190, 2, 77, "Section",ExpressionUUID->"159c10df-fc85-46f8-83bc-1bfca6b22089"],
Cell[CellGroupData[{
Cell[637, 21, 207, 4, 54, "Subsection",ExpressionUUID->"e5dde970-3b8a-43e7-a5e3-ebbce7dc28c9"],
Cell[CellGroupData[{
Cell[869, 29, 164, 3, 45, "Subsubsection",ExpressionUUID->"01c5076b-40f1-4693-be79-b41bfc2631c5"],
Cell[1036, 34, 258, 7, 30, "Input",ExpressionUUID->"05028e29-817b-4e97-8b4b-e44bea895668"],
Cell[1297, 43, 1178, 31, 115, "Input",ExpressionUUID->"2ec8307b-080a-4096-8dc7-d0412061072e"],
Cell[2478, 76, 1812, 41, 178, "Input",ExpressionUUID->"81406234-7eba-4c14-a8e9-20af7ba49549"],
Cell[4293, 119, 909, 28, 73, "Input",ExpressionUUID->"0889bbe7-dcff-48d9-a2fd-7956980bccaf"],
Cell[5205, 149, 883, 24, 136, "Input",ExpressionUUID->"5d08dbc8-50a8-4cef-8539-c1a9b954d143"],
Cell[6091, 175, 3036, 64, 430, "Input",ExpressionUUID->"53c03b6e-a56f-457b-984a-83f27e05b991"],
Cell[9130, 241, 526, 15, 30, "Input",ExpressionUUID->"f63240b3-1cc0-4366-b67c-3e8a63a77830"],
Cell[9659, 258, 1753, 44, 241, "Input",ExpressionUUID->"880ad033-edd3-460c-bcb5-2ebe45be0345"],
Cell[11415, 304, 1278, 32, 220, "Input",ExpressionUUID->"ba44c2b5-a698-40b2-9785-3b4b32470178"],
Cell[12696, 338, 315, 7, 30, "Input",ExpressionUUID->"33515d46-10d3-42e5-a5a3-df4df12e799e"],
Cell[13014, 347, 2685, 58, 304, "Input",ExpressionUUID->"135ec32e-71ff-4435-bcf6-d448c16665af"],
Cell[15702, 407, 535, 15, 30, "Input",ExpressionUUID->"c1e99c53-e5c3-4711-a85d-e5bcfb6555ed"],
Cell[16240, 424, 2049, 48, 283, "Input",ExpressionUUID->"17beb5c4-fa57-4a4f-b8f6-4413bd1cc12b"],
Cell[18292, 474, 618, 14, 30, "Input",ExpressionUUID->"cdc55d18-df1d-497b-9e4a-2debd215eb6f"],
Cell[18913, 490, 2000, 47, 262, "Input",ExpressionUUID->"595a32ae-69a0-404d-89e9-c7046980cbcd"],
Cell[20916, 539, 815, 23, 30, "Input",ExpressionUUID->"0424bcc1-695f-45b3-a1a6-480556b0f4f7"],
Cell[21734, 564, 1735, 41, 283, "Input",ExpressionUUID->"03749a6e-d8c5-4e5c-9367-979940729bd3"],
Cell[23472, 607, 10789, 209, 724, "Input",ExpressionUUID->"2907c46e-34cd-4fc8-a066-5445c0549fb3"],
Cell[34264, 818, 3821, 88, 409, "Input",ExpressionUUID->"581d7c3a-4b29-436b-988c-9e71a25e0245"],
Cell[38088, 908, 3187, 76, 388, "Input",ExpressionUUID->"51e89640-6b4c-4b18-86e8-db9945b4bf3e"],
Cell[41278, 986, 4054, 90, 430, "Input",ExpressionUUID->"09fefbc8-a350-4ea4-9ce0-c2bad07e1023"],
Cell[45335, 1078, 3816, 82, 430, "Input",ExpressionUUID->"7989d326-37c7-43c0-ac49-63226e78aa14"],
Cell[49154, 1162, 3150, 72, 388, "Input",ExpressionUUID->"b50de41a-470b-479a-b34e-ecdd884a9db1"],
Cell[52307, 1236, 2952, 68, 388, "Input",ExpressionUUID->"136f5e9f-18c1-483d-8f2e-17f2f4e0f251"],
Cell[55262, 1306, 1692, 36, 178, "Input",ExpressionUUID->"a255089e-3fd5-431a-96cc-bada65230788"],
Cell[56957, 1344, 2819, 73, 304, "Input",ExpressionUUID->"3b9ddefc-e042-48bf-8d08-22e3cef829a4"],
Cell[59779, 1419, 1048, 25, 94, "Input",ExpressionUUID->"7f5a87a1-cb11-4c34-a5f9-587597330ac0"],
Cell[60830, 1446, 1412, 33, 157, "Input",ExpressionUUID->"477b1ec7-015d-44f7-926c-a031f351157b"],
Cell[62245, 1481, 17580, 400, 1333, "Input",ExpressionUUID->"51d82818-d262-43f0-8d54-66ec597bf17f"],
Cell[79828, 1883, 568, 15, 52, "Input",ExpressionUUID->"e4c1557f-2c5f-45ea-a66e-a7e37c118c15"],
Cell[80399, 1900, 4089, 109, 472, "Input",ExpressionUUID->"3ec46f38-2590-448f-8e82-dae74470a182"],
Cell[84491, 2011, 4523, 122, 514, "Input",ExpressionUUID->"a9959c56-54dd-463e-907c-c7337e80dc4f"]
}, Closed]],
Cell[CellGroupData[{
Cell[89051, 2138, 161, 3, 37, "Subsubsection",ExpressionUUID->"1d028dbe-41d0-4c25-b85b-a9c8712aa047"],
Cell[89215, 2143, 1281, 34, 94, "Input",ExpressionUUID->"2f52ec85-6f3a-4309-af63-c20728aa6d05"],
Cell[90499, 2179, 471, 12, 30, "Input",ExpressionUUID->"52305492-8e3c-4ba9-9607-76662545ffc5"],
Cell[90973, 2193, 643, 15, 30, "Input",ExpressionUUID->"de0345fb-f4c1-407c-b955-a3cd1dd6f2a5"],
Cell[91619, 2210, 290, 8, 30, "Input",ExpressionUUID->"1f7c3a02-a356-4e35-b15c-93a0a67de5ce"],
Cell[91912, 2220, 1321, 34, 157, "Input",ExpressionUUID->"79499bad-9059-46a9-afbf-e3f9656fb36a"],
Cell[93236, 2256, 506, 13, 30, "Input",ExpressionUUID->"5a957d28-5230-474f-9993-9750e9cc5358"],
Cell[93745, 2271, 4281, 100, 493, "Input",ExpressionUUID->"701a4e23-0d2f-4a70-aaa7-69846e2e96f0"],
Cell[98029, 2373, 3366, 73, 304, "Input",ExpressionUUID->"421d7d02-c51e-4075-ad4b-b12d7d68e19c"],
Cell[101398, 2448, 2889, 67, 346, "Input",ExpressionUUID->"0555a679-4012-4385-ab92-04f71cd59588"],
Cell[104290, 2517, 4864, 100, 577, "Input",ExpressionUUID->"bbc54fc8-5ea1-454f-bd6b-edc6b936a716"],
Cell[109157, 2619, 4978, 106, 632, "Input",ExpressionUUID->"c1cf9ca0-ca17-4c5b-a7ee-7fa9908efd51"],
Cell[114138, 2727, 784, 24, 52, "Input",ExpressionUUID->"9b1a3835-81a9-4ef4-9599-944b792c6e7a"],
Cell[114925, 2753, 4521, 104, 346, "Input",ExpressionUUID->"9d17c6e1-da76-4bde-874d-3a89f0b6a7f5"],
Cell[119449, 2859, 3294, 85, 388, "Input",ExpressionUUID->"1e386301-87b8-49cf-ba6e-684e5b3a69d0"],
Cell[122746, 2946, 3636, 92, 388, "Input",ExpressionUUID->"0268c160-0229-42c5-a901-fd3b6775c550"],
Cell[126385, 3040, 423, 11, 52, "Input",ExpressionUUID->"76bc2ecf-fe42-43c4-8080-7189f70d1978"],
Cell[126811, 3053, 2601, 57, 283, "Input",ExpressionUUID->"9fd10063-6e64-4619-b82b-b48bf6d38f04"],
Cell[129415, 3112, 1083, 25, 94, "Input",ExpressionUUID->"8b725def-baa6-49eb-995b-941fedcc16cc"],
Cell[130501, 3139, 3212, 78, 430, "Input",ExpressionUUID->"d41c273f-58dd-4b3b-a1e3-e75ec27e0412"],
Cell[133716, 3219, 880, 25, 52, "Input",ExpressionUUID->"315a5bc5-fcab-46f4-957b-fcf79df3768d"],
Cell[134599, 3246, 1173, 31, 73, "Input",ExpressionUUID->"09405d3e-6fca-435e-8c7f-c8b92c15f1a4"],
Cell[135775, 3279, 2672, 71, 178, "Input",ExpressionUUID->"be64badc-c39d-487e-a61b-a6fc33fe06ed"],
Cell[138450, 3352, 2620, 61, 199, "Input",ExpressionUUID->"a371f5b9-0c5e-4e4f-b0ca-510b50b62d93"],
Cell[141073, 3415, 1320, 29, 94, "Input",ExpressionUUID->"0eced2c4-145e-40e3-aa6e-5cb3d74edf30"],
Cell[142396, 3446, 389, 8, 30, "Input",ExpressionUUID->"f5558d8f-a7ac-4e2e-a65a-5e0d6764d5b5"],
Cell[142788, 3456, 30611, 613, 2551, "Input",ExpressionUUID->"e8a8b94c-9f48-4904-8771-ba0484882c15"]
}, Open  ]],
Cell[CellGroupData[{
Cell[173436, 4074, 165, 3, 45, "Subsubsection",ExpressionUUID->"41fd9711-353a-4ea2-9d91-38daaa159a97"],
Cell[173604, 4079, 269, 7, 30, "Input",ExpressionUUID->"f87175b2-9c24-4214-8e16-e00adb79d789"],
Cell[173876, 4088, 1218, 34, 136, "Input",ExpressionUUID->"2be8caa7-4c7e-4b4c-b6bb-dd84ecdc6fcb"],
Cell[175097, 4124, 1536, 42, 157, "Input",ExpressionUUID->"0707e08d-ba95-4ac4-b163-3ffb31f87bdd"],
Cell[176636, 4168, 1823, 45, 157, "Input",ExpressionUUID->"e56be043-7125-4431-8a6f-ce020ddac8fc"],
Cell[178462, 4215, 1669, 45, 199, "Input",ExpressionUUID->"8dc346ff-ce0e-4612-8f86-584e34bf0b6e"],
Cell[180134, 4262, 178, 4, 30, "Input",ExpressionUUID->"d759f49e-39a3-4612-98c2-cf739179b169"],
Cell[180315, 4268, 13691, 339, 1396, "Input",ExpressionUUID->"2ae8c5de-c577-4e55-a005-e9be6e8515a3"],
Cell[194009, 4609, 489, 11, 30, "Input",ExpressionUUID->"f6ba3170-4d26-4fff-bef3-9d42e2c1f05b"],
Cell[194501, 4622, 609, 15, 52, "Input",ExpressionUUID->"25c2f357-1a32-4544-a390-27351e2ce094"],
Cell[195113, 4639, 491, 13, 30, "Input",ExpressionUUID->"fc2898e9-a10f-4e3c-94ef-0460b82ddc14"],
Cell[195607, 4654, 540, 14, 30, "Input",ExpressionUUID->"f20cfcb0-85ff-42ad-ba7f-06d7f88c1b81"],
Cell[196150, 4670, 607, 14, 30, "Input",ExpressionUUID->"2c8aac58-6cbd-4232-bdc0-373480b5c1d3"],
Cell[196760, 4686, 521, 14, 52, "Input",ExpressionUUID->"52b9a144-4141-41e6-836b-8314cb078e37"],
Cell[197284, 4702, 291, 5, 30, "Input",ExpressionUUID->"a3ae2e98-5573-42d9-a467-335561484a41"],
Cell[197578, 4709, 475, 14, 30, "Input",ExpressionUUID->"223eda35-b9d8-4d5c-bfe8-ad3e8896538c"],
Cell[198056, 4725, 874, 24, 52, "Input",ExpressionUUID->"a284701a-f31b-4371-8c58-81179e7eac2a"],
Cell[198933, 4751, 923, 25, 52, "Input",ExpressionUUID->"5c2f7298-7001-4c6d-9443-aabdc91b0547"],
Cell[199859, 4778, 1489, 41, 157, "Input",ExpressionUUID->"b546d5bf-9b3a-435c-a775-3af639d3ca96"]
}, Closed]],
Cell[CellGroupData[{
Cell[201385, 4824, 162, 3, 37, "Subsubsection",ExpressionUUID->"acdb2777-bd6f-40b2-8823-98a21f4ed377"],
Cell[201550, 4829, 3809, 92, 472, "Input",ExpressionUUID->"fcf5cc14-0767-4946-85ce-40c4736dafce"],
Cell[205362, 4923, 2646, 69, 304, "Input",ExpressionUUID->"6dcbd734-9b33-4181-93ed-06e0a1552ab0"],
Cell[208011, 4994, 5727, 133, 640, "Input",ExpressionUUID->"839d3bfa-143e-4dac-b546-a919ae5e3df2"],
Cell[213741, 5129, 10207, 227, 1123, "Input",ExpressionUUID->"6664b3d6-ad4a-4d38-bca6-69b0b6f64ae3"],
Cell[223951, 5358, 608, 17, 73, "Input",ExpressionUUID->"431b355d-1b94-4828-a06f-57cd1ccb09e1"],
Cell[224562, 5377, 8674, 158, 556, "Input",ExpressionUUID->"54879f64-9868-4012-afb7-675695554ffa"],
Cell[233239, 5537, 1423, 35, 220, "Input",ExpressionUUID->"6f659476-7832-40a6-9df9-6dbcd98f1525"],
Cell[234665, 5574, 23023, 448, 2026, "Input",ExpressionUUID->"72e89b13-3bde-48b0-b263-120f9f7f3bf0"],
Cell[257691, 6024, 3900, 81, 472, "Input",ExpressionUUID->"5bc0ad13-027a-44b0-98fd-8ccc61e18801"],
Cell[261594, 6107, 11845, 269, 1270, "Input",ExpressionUUID->"5cde0346-4b7e-4b62-8f31-a080b8bf9178"],
Cell[273442, 6378, 9897, 212, 934, "Input",ExpressionUUID->"abbd1477-4177-4726-91d5-afbdbfff524b"],
Cell[283342, 6592, 9433, 205, 934, "Input",ExpressionUUID->"91526297-7bf9-4ece-a67d-f15e435896d9"]
}, Closed]],
Cell[CellGroupData[{
Cell[292812, 6802, 169, 3, 37, "Subsubsection",ExpressionUUID->"03aecaaf-6bef-4364-bb06-3b604533f9fd"],
Cell[292984, 6807, 3390, 79, 409, "Input",ExpressionUUID->"430d88c7-7236-4358-8a65-db6b159b4a33"],
Cell[296377, 6888, 9113, 201, 892, "Input",ExpressionUUID->"a5d6153e-be17-482b-8700-f8bef05e35f3"]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[305551, 7096, 156, 3, 67, "Section",ExpressionUUID->"b05cac38-e026-49bd-a9c8-974f07c8efd7"],
Cell[CellGroupData[{
Cell[305732, 7103, 160, 3, 54, "Subsection",ExpressionUUID->"b4e7ac58-7238-4817-9518-f9533fd990c3"],
Cell[305895, 7108, 17774, 373, 1522, "Input",ExpressionUUID->"f4c1335f-9d55-4849-afbd-ad10b9ccb939"],
Cell[323672, 7483, 15804, 304, 1430, "Input",ExpressionUUID->"0d9c0e81-41a2-45f3-a0b4-9f6a74d7e2b8"],
Cell[339479, 7789, 22960, 444, 1963, "Input",ExpressionUUID->"66938c15-7d39-47a1-8d1e-12a777786708"],
Cell[362442, 8235, 1060, 16, 52, "Input",ExpressionUUID->"d7ae19b5-7d7e-44ca-896d-a781b8edaca8"],
Cell[363505, 8253, 2832, 77, 220, "Input",ExpressionUUID->"e87ad06f-4ef5-4689-9232-807b02bbcd60"]
}, Open  ]]
}, Open  ]]
}
]
*)

